
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Fuzzing with Constraints &#8212; The Fuzzing Book</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css?v=6644e6bb" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="_static/custom.css?v=42e1b1a5" />
    <link rel="stylesheet" type="text/css" href="_static/mastodon-timeline.css?v=f82c2b23" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'FuzzingWithConstraints';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Mining Input Grammars" href="GrammarMiner.html" />
    <link rel="prev" title="Reducing Failure-Inducing Inputs" href="Reducer.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>
<aside class="bd-header-announcement" aria-label="Announcement">
  <div class="bd-header-announcement__content"><p>This is a beta version of fuzzingbook.org, currently in development. See the <a href="https://fuzzingbook.org/classic/"  style="color:white!important;">classic site</a> for the 2024 version.</p></div>
</aside>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/fuzzingbook.png" class="logo__image only-light" alt="The Fuzzing Book - Home"/>
    <script>document.write(`<img src="_static/fuzzingbook.png" class="logo__image only-dark" alt="The Fuzzing Book - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="index.html">
                    The Fuzzing Book
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Introduction</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="Tours.html">Sitemap</a></li>
<li class="toctree-l1"><a class="reference internal" href="Intro_Testing.html">Introduction to Software Testing</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Lexical Fuzzing</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="Fuzzer.html">Fuzzing: Breaking Things with Random Inputs</a></li>
<li class="toctree-l1"><a class="reference internal" href="Coverage.html">Code Coverage</a></li>
<li class="toctree-l1"><a class="reference internal" href="MutationFuzzer.html">Mutation-Based Fuzzing</a></li>
<li class="toctree-l1"><a class="reference internal" href="GreyboxFuzzer.html">Greybox Fuzzing</a></li>
<li class="toctree-l1"><a class="reference internal" href="SearchBasedFuzzer.html">Search-Based Fuzzing</a></li>
<li class="toctree-l1"><a class="reference internal" href="MutationAnalysis.html">Mutation Analysis</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Syntactical Fuzzing</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="Grammars.html">Fuzzing with Grammars</a></li>
<li class="toctree-l1"><a class="reference internal" href="GrammarFuzzer.html">Efficient Grammar Fuzzing</a></li>
<li class="toctree-l1"><a class="reference internal" href="GrammarCoverageFuzzer.html">Grammar Coverage</a></li>
<li class="toctree-l1"><a class="reference internal" href="Parser.html">Parsing Inputs</a></li>
<li class="toctree-l1"><a class="reference internal" href="ProbabilisticGrammarFuzzer.html">Probabilistic Grammar Fuzzing</a></li>
<li class="toctree-l1"><a class="reference internal" href="GeneratorGrammarFuzzer.html">Fuzzing with Generators</a></li>

<li class="toctree-l1"><a class="reference internal" href="GreyboxGrammarFuzzer.html">Greybox Fuzzing with Grammars</a></li>
<li class="toctree-l1"><a class="reference internal" href="Reducer.html">Reducing Failure-Inducing Inputs</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Semantical Fuzzing</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Fuzzing with Constraints</a></li>
<li class="toctree-l1"><a class="reference internal" href="GrammarMiner.html">Mining Input Grammars</a></li>
<li class="toctree-l1"><a class="reference internal" href="InformationFlow.html">Tracking Information Flow</a></li>
<li class="toctree-l1"><a class="reference internal" href="ConcolicFuzzer.html">Concolic Fuzzing</a></li>
<li class="toctree-l1"><a class="reference internal" href="SymbolicFuzzer.html">Symbolic Fuzzing</a></li>
<li class="toctree-l1"><a class="reference internal" href="DynamicInvariants.html">Mining Function Specifications</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Domain-Specific Fuzzing</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="ConfigurationFuzzer.html">Testing Configurations</a></li>
<li class="toctree-l1"><a class="reference internal" href="APIFuzzer.html">Fuzzing APIs</a></li>
<li class="toctree-l1"><a class="reference internal" href="Carver.html">Carving Unit Tests</a></li>
<li class="toctree-l1"><a class="reference internal" href="PythonFuzzer.html">Testing Compilers</a></li>
<li class="toctree-l1"><a class="reference internal" href="WebFuzzer.html">Testing Web Applications</a></li>
<li class="toctree-l1"><a class="reference internal" href="GUIFuzzer.html">Testing Graphical User Interfaces</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Managing Fuzzing</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="FuzzingInTheLarge.html">Fuzzing in the Large</a></li>
<li class="toctree-l1"><a class="reference internal" href="WhenToStopFuzzing.html">When To Stop Fuzzing</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Essays</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="AcademicPrototyping.html">Academic Prototyping</a></li>
<li class="toctree-l1"><a class="reference internal" href="PrototypingWithPython.html">Prototyping with Python</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Appendices</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="ExpectError.html">Error Handling</a></li>
<li class="toctree-l1"><a class="reference internal" href="Timer.html">Timer</a></li>
<li class="toctree-l1"><a class="reference internal" href="Timeout.html">Timeout</a></li>
<li class="toctree-l1"><a class="reference internal" href="ClassDiagram.html">Class Diagrams</a></li>
<li class="toctree-l1"><a class="reference internal" href="RailroadDiagrams.html">Railroad Diagrams</a></li>
<li class="toctree-l1"><a class="reference internal" href="ControlFlow.html">Control Flow Graph</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">About This Book</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="ReleaseNotes.html">Fuzzingbook Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="Importing.html">Downloads and Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="Copyright.html">Copyright</a></li>
<li class="toctree-l1"><a class="reference internal" href="Guide_for_Authors.html">Guide for Authors</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://mybinder.org/v2/gh/uds-se/fuzzingbook/master?urlpath=tree/docs/notebooks/FuzzingWithConstraints.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch on Binder"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img alt="Binder logo" src="_static/images/logo_binder.svg">
  </span>
<span class="btn__text-container">Binder</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/uds-se/fuzzingbook" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/uds-se/fuzzingbook/issues/new?title=Issue%20on%20page%20%2FFuzzingWithConstraints.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
    <li><a href="../code/FuzzingWithConstraints.py" target="_blank"
       class="btn btn-sm btn-download-source-button dropdown-item"
       title="Download Python code"
       data-bs-placement="left" data-bs-toggle="tooltip"
    >
  

    <span class="btn__icon-container">
      <i class="fas fa-file"></i>
      </span>
    <span class="btn__text-container">.py</span>
    </a>
    </li>
    
      
      
      
      <li><a href="_sources/FuzzingWithConstraints.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download notebook"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  
    <li><a href="Importing.html" target="_blank"
       class="btn btn-sm btn-download-source-button dropdown-item"
       title="All downloads"
       data-bs-placement="left" data-bs-toggle="tooltip"
    >
  

    <span class="btn__icon-container">
      <i class="fas fa-file"></i>
      </span>
    <span class="btn__text-container">All downloads</span>
    </a>
    </li>
    </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Fuzzing with Constraints</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#synopsis">Synopsis</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#semantic-input-properties">Semantic Input Properties</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#excursion-unrestricted-grammars">Excursion: Unrestricted Grammars</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#end-of-excursion">End of Excursion</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#specifying-constraints">Specifying Constraints</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#excursion-derivation-trees">Excursion: Derivation Trees</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">End of Excursion</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#excursion-using-smt-lib-syntax">Excursion: Using SMT-LIB Syntax</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">End of Excursion</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#isla-on-the-command-line">ISLa on the Command Line</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#accessing-elements">Accessing Elements</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quantifiers">Quantifiers</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#picking-expansions">Picking Expansions</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#matching-expansion-elements">Matching Expansion Elements</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#checking-strings">Checking Strings</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#case-studies">Case Studies</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#matching-identifiers-in-xml">Matching Identifiers in XML</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#excursion-solver-configuration-parameters">Excursion: Solver Configuration Parameters</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">End of Excursion</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#definitions-and-usages-in-programming-languages">Definitions and Usages in Programming Languages</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#lessons-learned">Lessons Learned</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#next-steps">Next Steps</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#background">Background</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercises">Exercises</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-1-string-encodings">Exercise 1: String Encodings</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#part-1-syntax">Part 1: Syntax</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#part-2-semantics">Part 2: Semantics</a></li>
</ul>
</li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="fuzzing-with-constraints">
<h1>Fuzzing with Constraints<a class="headerlink" href="#fuzzing-with-constraints" title="Link to this heading">#</a></h1>
<p>In previous chapters, we have seen how <a class="reference internal" href="GrammarFuzzer.html"><span class="std std-doc">Grammar-Based Fuzzing</span></a> allows us to efficiently generate myriads of syntactically valid inputs.
However, there are <em>semantic</em> input features that cannot be expressed in a context-free grammar, such as</p>
<ul class="simple">
<li><p>“<span class="math notranslate nohighlight">\(X\)</span> is the length of <span class="math notranslate nohighlight">\(Y\)</span>”;</p></li>
<li><p>“<span class="math notranslate nohighlight">\(X\)</span> is an identifier previously declared”; or</p></li>
<li><p>“<span class="math notranslate nohighlight">\(X\)</span> should be longer than 4,096 bytes”.</p></li>
</ul>
<p>In this chapter, we show how the <a class="reference external" href="https://rindphi.github.io/isla/">ISLa</a> framework allows us to express such features as <em>constraints</em> added to a grammar.
By having ISLa solve these constraints automatically, we produce inputs that are not only <em>syntactically</em> valid, but actually <em>semantically</em> valid.
Furthermore, such constraints allow us to very precisely <em>shape</em> the inputs we want for testing.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">bookutils</span><span class="w"> </span><span class="kn">import</span> <span class="n">YouTubeVideo</span>
<span class="n">YouTubeVideo</span><span class="p">(</span><span class="s2">&quot;dgaGuwn-1OU&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
        <iframe
            width="640"
            height="360"
            src="https://www.youtube-nocookie.com/embed/dgaGuwn-1OU"
            frameborder="0"
            allowfullscreen
            
        ></iframe>
        </div></div>
</div>
<p><strong>Prerequisites</strong></p>
<ul class="simple">
<li><p>You should have read the <a class="reference internal" href="Grammars.html"><span class="std std-doc">chapter on grammars</span></a>.</p></li>
<li><p>The chapter on <a class="reference internal" href="GeneratorGrammarFuzzer.html"><span class="std std-doc">generators and filters</span></a> addresses a similar problem, but with program code instead of constraints.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">bookutils.setup</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_remove-input docutils container">
</div>
<div class="cell tag_remove-input docutils container">
</div>
<section id="synopsis">
<h2>Synopsis<a class="headerlink" href="#synopsis" title="Link to this heading">#</a></h2>
<p>To <a class="reference internal" href="Importing.html"><span class="std std-doc">use the code provided in this chapter</span></a>, write</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">fuzzingbook.FuzzingWithConstraints</span><span class="w"> </span><span class="kn">import</span> <span class="o">&lt;</span><span class="n">identifier</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>and then make use of the following features.</p>
<p><strong>Note</strong>: The examples in this section only work after the rest of the cells have been executed.</p>
<p>This chapter introduces the <a class="reference external" href="https://rindphi.github.io/isla/">ISLa</a> framework, consisting of</p>
<ul class="simple">
<li><p>the <em>ISLa specification language</em>, allowing to add <em>constraints</em> to a grammar</p></li>
<li><p>the <em>ISLa solver</em>, solving these constraints to produce semantically (and syntactically) valid inputs</p></li>
<li><p>the <em>ISLa checker</em>, checking given inputs for whether they satisfy these constraints.</p></li>
</ul>
<p>A typical usage of the ISLa solver is as follows.
First, install ISLa, using</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>pip<span class="w"> </span>install<span class="w"> </span>isla-solver
</pre></div>
</div>
<p>Then, you can import the solver as</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">isla.solver</span><span class="w"> </span><span class="kn">import</span> <span class="n">ISLaSolver</span>  <span class="c1"># type: ignore</span>
</pre></div>
</div>
</div>
</div>
<p>The ISLa solver needs two things. First, a <em>grammar</em> - say, US phone numbers.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">Grammars</span><span class="w"> </span><span class="kn">import</span> <span class="n">US_PHONE_GRAMMAR</span>
</pre></div>
</div>
</div>
</div>
<p>Second, you need <em>constraints</em> – a string expressing a condition over one or more grammar elements.
Common functions include</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">str.len()</span></code>, returning the length of a string</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">str.to.int()</span></code>, converting a string to an integer</p></li>
</ul>
<p>Here, we instantiate the ISLa solver with a constraint stating that the area code should be above 900:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">solver</span> <span class="o">=</span> <span class="n">ISLaSolver</span><span class="p">(</span><span class="n">US_PHONE_GRAMMAR</span><span class="p">,</span> 
<span class="w">            </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            str.to.int(&lt;area&gt;) &gt; 900</span>
<span class="sd">            &quot;&quot;&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>With that, invoking <code class="docutils literal notranslate"><span class="pre">solver.solve()</span></code> returns a <em>solution</em> for the constraints.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">str</span><span class="p">(</span><span class="n">solver</span><span class="o">.</span><span class="n">solve</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;(905)850-6948&#39;
</pre></div>
</div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">solve()</span></code> returns a derivation tree, which typically is converted into a string using <code class="docutils literal notranslate"><span class="pre">str()</span></code> as above. The <code class="docutils literal notranslate"><span class="pre">print()</span></code> function does this implicitly.</p>
<p>Subsequent calls of <code class="docutils literal notranslate"><span class="pre">solve()</span></code> return more solutions:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">solver</span><span class="o">.</span><span class="n">solve</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(905)317-2734
(905)729-3500
(905)408-8044
(905)937-2584
(905)602-6728
(905)249-7959
(905)579-4209
(905)510-7560
(905)900-4775
(906)565-2710
</pre></div>
</div>
</div>
</div>
<p>We see that the solver produces a number of inputs that all satisfy the constraint - the area code is always more than 900.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">ISLaSolver()</span></code> constructor provides several additional parameters to configure the solver, as documented below.
Additional <code class="docutils literal notranslate"><span class="pre">ISLaSolver</span></code> methods allow checking inputs against constraints, and provide additional functionality.</p>
<div class="cell tag_remove-input docutils container">
</div>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<div class="output text_html"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 13.1.2 (20250808.2320)
 -->
<!-- Pages: 1 -->
<svg width="226pt" height="94pt"
 viewBox="0.00 0.00 226.00 94.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 90)">
<g id="a_graph0"><a xlink:title="ISLaSolver class hierarchy">
<polygon fill="white" stroke="none" points="-4,4 -4,-90 222.25,-90 222.25,4 -4,4"/>
</a>
</g>
<!-- ISLaSolver -->
<g id="node1" class="node">
<title>ISLaSolver</title>
<g id="a_node1"><a xlink:href="isla.solver.ipynb" xlink:title="class ISLaSolver:&#10;The solver class for ISLa formulas/constraints. Its top&#45;level methods are&#10;&#10;:meth:`~isla.solver.ISLaSolver.solve`&#10;Use to generate solutions for an ISLa constraint.&#10;&#10;:meth:`~isla.solver.ISLaSolver.check`&#10;Use to check if an ISLa constraint is satisfied for a given input.&#10;&#10;:meth:`~isla.solver.ISLaSolver.parse`&#10;Use to parse and validate an input.&#10;&#10;:meth:`~isla.solver.ISLaSolver.repair`&#10;Use to repair an input such that it satisfies a constraint.&#10;&#10;:meth:`~isla.solver.ISLaSolver.mutate`&#10;Use to mutate an input such that the result satisfies a constraint.">
<polygon fill="none" stroke="black" points="0,-0.5 0,-85.5 81.25,-85.5 81.25,-0.5 0,-0.5"/>
<text xml:space="preserve" text-anchor="start" x="8" y="-69.2" font-family="Patua One, Helvetica, sans-serif" font-weight="bold" font-size="14.00" fill="#b03a2e">ISLaSolver</text>
<polyline fill="none" stroke="black" points="0,-59.5 81.25,-59.5"/>
<g id="a_node1_0"><a xlink:href="#" xlink:title="ISLaSolver">
<g id="a_node1_1"><a xlink:href="isla.solver.ipynb" xlink:title="__init__(self, grammar: Union[Mapping[str, Sequence[str]], str], formula: Union[isla.language.Formula, str, NoneType] = None, structural_predicates: Set[isla.language.StructuralPredicate] = frozenset({StructuralPredicate(name=&#39;different_position&#39;, arity=2, eval_fun=&lt;function is_different_position at 0x10fb42480&gt;), StructuralPredicate(name=&#39;consecutive&#39;, arity=2, eval_fun=&lt;function consecutive at 0x10fb42660&gt;), StructuralPredicate(name=&#39;after&#39;, arity=2, eval_fun=&lt;function is_after at 0x10fb418a0&gt;), StructuralPredicate(name=&#39;level&#39;, arity=4, eval_fun=&lt;function level_check at 0x10fb42700&gt;), StructuralPredicate(name=&#39;before&#39;, arity=2, eval_fun=&lt;function is_before at 0x10f7f1580&gt;), StructuralPredicate(name=&#39;nth&#39;, arity=3, eval_fun=&lt;function is_nth at 0x10fb42520&gt;), StructuralPredicate(name=&#39;direct_child&#39;, arity=2, eval_fun=&lt;function is_direct_child at 0x10fb43740&gt;), StructuralPredicate(name=&#39;inside&#39;, arity=2, eval_fun=&lt;function in_tree at 0x10fb425c0&gt;), StructuralPredicate(name=&#39;same_position&#39;, arity=2, eval_fun=&lt;function is_same_position at 0x10fb422a0&gt;)}), semantic_predicates: Set[isla.language.SemanticPredicate] = frozenset({SemanticPredicate(count, 3)}), max_number_free_instantiations: int = 10, max_number_smt_instantiations: int = 10, max_number_tree_insertion_results: int = 5, enforce_unique_trees_in_queue: bool = False, debug: bool = False, cost_computer: Optional[ForwardRef(&#39;CostComputer&#39;)] = None, timeout_seconds: Optional[int] = None, global_fuzzer: bool = False, predicates_unique_in_int_arg: Tuple[isla.language.SemanticPredicate, ...] = (SemanticPredicate(count, 3),), fuzzer_factory: Callable[[Mapping[str, Sequence[str]]], isla.fuzzer.GrammarFuzzer] = &lt;function SolverDefaults.&lt;lambda&gt; at 0x10fb4b600&gt;, tree_insertion_methods: Optional[int] = None, activate_unsat_support: bool = False, grammar_unwinding_threshold: int = 4, initial_tree: returns.maybe.Maybe[isla.derivation_tree.DerivationTree] = &lt;Nothing&gt;, enable_optimized_z3_queries: bool = True, start_symbol: Optional[str] = None):&#10;The constructor of :class:`~isla.solver.ISLaSolver` accepts a large number of&#10;parameters. However, all but the first one, :code:`grammar`, are *optional.*&#10;&#10;The simplest way to construct an ISLa solver is by only providing it with a&#10;grammar only; it then works like a grammar fuzzer.&#10;&#10;&gt;&gt;&gt; import random&#10;&gt;&gt;&gt; random.seed(1)&#10;&#10;&gt;&gt;&gt; import string&#10;&gt;&gt;&gt; LANG_GRAMMAR = {&#10;... &#160;&#160;&#160;&#160;&quot;&lt;start&gt;&quot;:&#10;... &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;[&quot;&lt;stmt&gt;&quot;],&#10;... &#160;&#160;&#160;&#160;&quot;&lt;stmt&gt;&quot;:&#10;... &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;[&quot;&lt;assgn&gt; ; &lt;stmt&gt;&quot;, &quot;&lt;assgn&gt;&quot;],&#10;... &#160;&#160;&#160;&#160;&quot;&lt;assgn&gt;&quot;:&#10;... &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;[&quot;&lt;var&gt; := &lt;rhs&gt;&quot;],&#10;... &#160;&#160;&#160;&#160;&quot;&lt;rhs&gt;&quot;:&#10;... &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;[&quot;&lt;var&gt;&quot;, &quot;&lt;digit&gt;&quot;],&#10;... &#160;&#160;&#160;&#160;&quot;&lt;var&gt;&quot;: list(string.ascii_lowercase),&#10;... &#160;&#160;&#160;&#160;&quot;&lt;digit&gt;&quot;: list(string.digits)&#10;... }&#10;&gt;&gt;&gt;&#10;&gt;&gt;&gt; from isla.solver import ISLaSolver&#10;&gt;&gt;&gt; solver = ISLaSolver(LANG_GRAMMAR)&#10;&gt;&gt;&gt;&#10;&gt;&gt;&gt; str(solver.solve())&#10;&#39;d := 9&#39;&#10;&gt;&gt;&gt; str(solver.solve())&#10;&#39;v := n ; s := r&#39;&#10;&#10;:param grammar: The underlying grammar; either, as a &quot;Fuzzing Book&quot; dictionary&#10;or in BNF syntax.&#10;:param formula: The formula to solve; either a string or a readily parsed&#10;formula. If no formula is given, a default `true` constraint is assumed, and&#10;the solver falls back to a grammar fuzzer. The number of produced solutions&#10;will then be bound by `max_number_free_instantiations`.&#10;:param structural_predicates: Structural predicates to use when parsing a&#10;formula.&#10;:param semantic_predicates: Semantic predicates to use when parsing a formula.&#10;:param max_number_free_instantiations: Number of times that nonterminals that&#10;are not bound by any formula should be expanded by a coverage&#45;based fuzzer.&#10;:param max_number_smt_instantiations: Number of solutions of SMT formulas that&#10;should be produced.&#10;:param max_number_tree_insertion_results: The maximum number of results when&#10;solving existential quantifiers by tree insertion.&#10;:param enforce_unique_trees_in_queue: If true, states with the same tree as an&#10;already existing tree in the queue are discarded, irrespectively of the&#10;constraint.&#10;:param debug: If true, debug information about the evolution of states is&#10;collected, notably in the field state_tree. The root of the tree is in the&#10;field state_tree_root. The field costs stores the computed cost values for&#10;all new nodes.&#10;:param cost_computer: The `CostComputer` class for computing the cost relevant&#10;to placing states in ISLa&#39;s queue.&#10;:param timeout_seconds: Number of seconds after which the solver will terminate.&#10;:param global_fuzzer: If set to True, only one coverage&#45;guided grammar fuzzer&#10;object is used to finish off unconstrained open derivation trees throughout&#10;the whole generation time. This may be beneficial for some targets; e.g., we&#10;experienced that CSV works significantly faster. However, the achieved k&#45;path&#10;coverage can be lower with that setting.&#10;:param predicates_unique_in_int_arg: This is needed in certain cases for&#10;instantiating universal integer quantifiers. The supplied predicates should&#10;have exactly one integer argument, and hold for exactly one integer value&#10;once all other parameters are fixed.&#10;:param fuzzer_factory: Constructor of the fuzzer to use for instantiating&#10;&quot;free&quot; nonterminals.&#10;:param tree_insertion_methods: Combination of methods to use for existential&#10;quantifier elimination by tree insertion. Full selection: `DIRECT_EMBEDDING &amp;&#10;SELF_EMBEDDING &amp; CONTEXT_ADDITION`.&#10;:param activate_unsat_support: Set to True if you assume that a formula might&#10;be unsatisfiable. This triggers additional tests for unsatisfiability that&#10;reduce input generation performance, but might ensure termination (with a&#10;negative solver result) for unsatisfiable problems for which the solver could&#10;otherwise diverge.&#10;:param grammar_unwinding_threshold: When querying the SMT solver, ISLa passes a&#10;regular expression for the syntax of the involved nonterminals. If this&#10;syntax is not regular, we unwind the respective part in the reference grammar&#10;up to a depth of `grammar_unwinding_threshold`. If this is too shallow, it can&#10;happen that an equation etc. cannot be solved; if it is too deep, it can&#10;negatively impact performance (and quite tremendously so).&#10;:param initial_tree: An initial input tree for the queue, if the solver shall&#10;not start from the tree `(&lt;start&gt;, None)`.&#10;:param enable_optimized_z3_queries: Enables preprocessing of Z3 queries (mainly&#10;numeric problems concerning things like length). This can improve performance&#10;significantly; however, it might happen that certain problems cannot be solved&#10;anymore. In that case, this option can/should be deactivated.&#10;:param start_symbol: This is an alternative to `initial_tree` for starting with&#10;a start symbol different form `&lt;start&gt;`. If `start_symbol` is provided, a tree&#10;consisting of a single root node with the value of `start_symbol` is chosen as&#10;initial tree.">
<text xml:space="preserve" text-anchor="start" x="10.62" y="-47" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-weight="bold" font-size="10.00">__init__()</text>
</a>
</g>
<g id="a_node1_2"><a xlink:href="isla.solver.ipynb" xlink:title="check(self, inp: isla.derivation_tree.DerivationTree | str) &#45;&gt; bool:&#10;Evaluates whether the given derivation tree satisfies the constraint passed to&#10;the solver. Raises an `UnknownResultError` if this could not be evaluated&#10;(e.g., because of a solver timeout or a semantic predicate that cannot be&#10;evaluated).&#10;&#10;:param inp: The input to evaluate, either readily parsed or as a string.&#10;:return: A truth value.">
<text xml:space="preserve" text-anchor="start" x="10.62" y="-34.25" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-weight="bold" font-size="10.00">check()</text>
</a>
</g>
<g id="a_node1_3"><a xlink:href="isla.solver.ipynb" xlink:title="parse(self, inp: str, nonterminal: str = &#39;&lt;start&gt;&#39;, skip_check: bool = False, silent: bool = False) &#45;&gt; isla.derivation_tree.DerivationTree:&#10;Parses the given input `inp`. Raises a `SyntaxError` if the input does not&#10;satisfy the grammar, a `SemanticError` if it does not satisfy the constraint&#10;(this is only checked if `nonterminal` is &quot;&lt;start&gt;&quot;), and returns the parsed&#10;`DerivationTree` otherwise.&#10;&#10;:param inp: The input to parse.&#10;:param nonterminal: The nonterminal to start parsing with, if a string&#10;corresponding to a sub&#45;grammar shall be parsed. We don&#39;t check semantic&#10;correctness in that case.&#10;:param skip_check: If True, the semantic check is left out.&#10;:param silent: If True, no error is sent to the log stream in case of a&#10;failed parse.&#10;:return: A parsed `DerivationTree`.">
<text xml:space="preserve" text-anchor="start" x="10.62" y="-21.5" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-weight="bold" font-size="10.00">parse()</text>
</a>
</g>
<g id="a_node1_4"><a xlink:href="isla.solver.ipynb" xlink:title="solve(self) &#45;&gt; isla.derivation_tree.DerivationTree:&#10;Attempts to compute a solution to the given ISLa formula. Returns that solution,&#10;if any. This function can be called repeatedly to obtain more solutions until&#10;one of two exception types is raised: A :class:`StopIteration` indicates that&#10;no more solution can be found; a :class:`TimeoutError` is raised if a timeout&#10;occurred. After that, an exception will be raised every time.&#10;&#10;The timeout can be controlled by the :code:`timeout_seconds`&#10;:meth:`constructor &lt;isla.solver.ISLaSolver.__init__&gt;` parameter.&#10;&#10;:return: A solution for the ISLa formula passed to the&#10;:class:`isla.solver.ISLaSolver`.">
<text xml:space="preserve" text-anchor="start" x="10.62" y="-8.75" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-weight="bold" font-size="10.00">solve()</text>
</a>
</g>
</a>
</g>
</a>
</g>
</g>
<!-- Legend -->
<g id="node2" class="node">
<title>Legend</title>
<text xml:space="preserve" text-anchor="start" x="99" y="-59" font-family="Patua One, Helvetica, sans-serif" font-weight="bold" font-size="10.00" fill="#b03a2e">Legend</text>
<text xml:space="preserve" text-anchor="start" x="99" y="-49" font-family="Patua One, Helvetica, sans-serif" font-size="10.00">• </text>
<text xml:space="preserve" text-anchor="start" x="105" y="-49" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-weight="bold" font-size="8.00">public_method()</text>
<text xml:space="preserve" text-anchor="start" x="99" y="-39" font-family="Patua One, Helvetica, sans-serif" font-size="10.00">• </text>
<text xml:space="preserve" text-anchor="start" x="105" y="-39" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="8.00">private_method()</text>
<text xml:space="preserve" text-anchor="start" x="99" y="-29" font-family="Patua One, Helvetica, sans-serif" font-size="10.00">• </text>
<text xml:space="preserve" text-anchor="start" x="105" y="-29" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-style="italic" font-size="8.00">overloaded_method()</text>
<text xml:space="preserve" text-anchor="start" x="99" y="-19.95" font-family="Helvetica,sans-Serif" font-size="9.00">Hover over names to see doc</text>
</g>
</g>
</svg>
</div></div>
</div>
<p>The ISLa functionality is also available on the command line:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>isla<span class="w"> </span>--help
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/Users/zeller/.virtualenvs/python3.13/lib/python3.13/site-packages/z3/z3core.py:5: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools&lt;81.
  import pkg_resources
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>usage: isla [-h] [-v]
            {solve,fuzz,check,find,parse,repair,mutate,create,config} ...

The ISLa command line interface.

options:
  -h, --help            show this help message and exit
  -v, --version         Print the ISLa version number

Commands:
  {solve,fuzz,check,find,parse,repair,mutate,create,config}
    solve               create solutions to ISLa constraints or check their
                        unsatisfiability
    fuzz                pass solutions to an ISLa constraint to a test subject
    check               check whether an input satisfies an ISLa constraint
    find                filter files satisfying syntactic &amp; semantic
                        constraints
    parse               parse an input into a derivation tree if it satisfies
                        an ISLa constraint
    repair              try to repair an existing input such that it satisfies
                        an ISLa constraint
    mutate              mutate an input such that the result s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>atisfies an ISLa
                        constraint
    create              create grammar and constraint stubs
    config              dumps the default configuration file
</pre></div>
</div>
</div>
</div>
</section>
<section id="semantic-input-properties">
<h2>Semantic Input Properties<a class="headerlink" href="#semantic-input-properties" title="Link to this heading">#</a></h2>
<p>In this book, we have frequently used <a class="reference internal" href="Grammars.html"><span class="std std-doc">grammars</span></a> to <a class="reference internal" href="GrammarFuzzer.html"><span class="std std-doc">systematically generate inputs</span></a> that <a class="reference internal" href="GrammarCoverageFuzzer.html"><span class="std std-doc">cover input structure</span></a> and more.
But while it is relatively easy to express the <em>syntax</em> of an input using a grammar, there are input properties that <em>cannot</em> be expressed using a grammar.
Such input properties are called <em>semantic</em> properties.</p>
<p>Let us illustrate semantic properties using a simple example.
We want to test some system that is configured by two settings, a <em>page size</em> and a <em>buffer size</em>.
Both these come as integer numbers as part of a human-readable configuration file.
The <em>syntax</em> of this file is given by the following grammar:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">Grammars</span><span class="w"> </span><span class="kn">import</span> <span class="n">Grammar</span><span class="p">,</span> <span class="n">is_valid_grammar</span><span class="p">,</span> <span class="n">syntax_diagram</span><span class="p">,</span> <span class="n">crange</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">string</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">CONFIG_GRAMMAR</span><span class="p">:</span> <span class="n">Grammar</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;&lt;start&gt;&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;&lt;config&gt;&quot;</span><span class="p">],</span>
    <span class="s2">&quot;&lt;config&gt;&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="s2">&quot;pagesize=&lt;pagesize&gt;</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="s2">&quot;bufsize=&lt;bufsize&gt;&quot;</span>
    <span class="p">],</span>
    <span class="s2">&quot;&lt;pagesize&gt;&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;&lt;int&gt;&quot;</span><span class="p">],</span>
    <span class="s2">&quot;&lt;bufsize&gt;&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;&lt;int&gt;&quot;</span><span class="p">],</span>
    <span class="s2">&quot;&lt;int&gt;&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;&lt;leaddigit&gt;&lt;digits&gt;&quot;</span><span class="p">],</span>
    <span class="s2">&quot;&lt;digits&gt;&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;&lt;digit&gt;&lt;digits&gt;&quot;</span><span class="p">],</span>
    <span class="s2">&quot;&lt;digit&gt;&quot;</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="s2">&quot;0123456789&quot;</span><span class="p">),</span>
    <span class="s2">&quot;&lt;leaddigit&gt;&quot;</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="s2">&quot;123456789&quot;</span><span class="p">)</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">assert</span> <span class="n">is_valid_grammar</span><span class="p">(</span><span class="n">CONFIG_GRAMMAR</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Here’s a visualization of this grammar as a railroad diagram, showing its structure:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>start
</pre></div>
</div>
<img alt="_images/1929236c5af670c9b90a1b97a5a179a172df44ac289c5d72975edb0358ddb8ff.svg" src="_images/1929236c5af670c9b90a1b97a5a179a172df44ac289c5d72975edb0358ddb8ff.svg" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>config
</pre></div>
</div>
<img alt="_images/6e8b401461a1e74fc881f94f09375e0727e5d9e98ee16d27d2df20b962b1a3f5.svg" src="_images/6e8b401461a1e74fc881f94f09375e0727e5d9e98ee16d27d2df20b962b1a3f5.svg" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>pagesize
</pre></div>
</div>
<img alt="_images/63de2432efbfdcc4d3fef9d975330bf6d01c1e0cf92f6490c1b272175241e26e.svg" src="_images/63de2432efbfdcc4d3fef9d975330bf6d01c1e0cf92f6490c1b272175241e26e.svg" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>bufsize
</pre></div>
</div>
<img alt="_images/63de2432efbfdcc4d3fef9d975330bf6d01c1e0cf92f6490c1b272175241e26e.svg" src="_images/63de2432efbfdcc4d3fef9d975330bf6d01c1e0cf92f6490c1b272175241e26e.svg" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>int
</pre></div>
</div>
<img alt="_images/b87a786d3d67046cc62893e0d5e9fe024786806bfbece4363c90d3b2693ba556.svg" src="_images/b87a786d3d67046cc62893e0d5e9fe024786806bfbece4363c90d3b2693ba556.svg" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>digits
</pre></div>
</div>
<img alt="_images/838d72f683f752239ebc9170aeebd5b4d52a05bcd66f02f68ed347ab019a0b08.svg" src="_images/838d72f683f752239ebc9170aeebd5b4d52a05bcd66f02f68ed347ab019a0b08.svg" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>digit
</pre></div>
</div>
<img alt="_images/831527e2b2231b00574fb7a68ba1dce71a738444df89dc5f1c870b2354eef828.svg" src="_images/831527e2b2231b00574fb7a68ba1dce71a738444df89dc5f1c870b2354eef828.svg" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>leaddigit
</pre></div>
</div>
<img alt="_images/6567a6620fb90eaf29f0a0c6c3360f5a94846206271b668abd55a6bc99312d74.svg" src="_images/6567a6620fb90eaf29f0a0c6c3360f5a94846206271b668abd55a6bc99312d74.svg" />
</div>
</div>
<p>Using this grammar, we can now use any of our grammar-based fuzzers to generate valid inputs.
For instance:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">GrammarFuzzer</span><span class="w"> </span><span class="kn">import</span> <span class="n">GrammarFuzzer</span><span class="p">,</span> <span class="n">DerivationTree</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fuzzer</span> <span class="o">=</span> <span class="n">GrammarFuzzer</span><span class="p">(</span><span class="n">CONFIG_GRAMMAR</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">fuzzer</span><span class="o">.</span><span class="n">fuzz</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0
pagesize=4057
bufsize=817
1
pagesize=9
bufsize=8
2
pagesize=5
bufsize=25
3
pagesize=1
bufsize=2
4
pagesize=62
bufsize=57
5
pagesize=2
bufsize=893
6
pagesize=1
bufsize=33
7
pagesize=7537
bufsize=3
8
pagesize=97
bufsize=983
9
pagesize=2
bufsize=2
</pre></div>
</div>
</div>
</div>
<p>So far, so good - and indeed, these random values will help us test our (hypothetical) system.
But what if we want to <em>control</em> these values further, putting our system to the test?</p>
<p>A grammar gives us <em>some</em> control. If we want to ensure a page size of at least 100,000, for instance, a rule like</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;&lt;bufsize&gt;&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;&lt;leaddigit&gt;&lt;digit&gt;&lt;digit&gt;&lt;digit&gt;&lt;digit&gt;&lt;digit&gt;&quot;</span><span class="p">]</span>
</pre></div>
</div>
<p>would do the job.
We could also express that the page size should be an odd number, by having it end in an odd digit.
But if we want to state that the page size should be, say, a multiple of 8, or larger or less than the buffer size, we are out of luck.</p>
<p>In the <a class="reference internal" href="GeneratorGrammarFuzzer.html"><span class="std std-doc">chapter on fuzzing with generators</span></a>, we have seen how to attach <em>program code</em> to individual rules - program code that would either <em>generate</em> individual elements right away or <em>filter</em> only these that satisfy specific conditions.</p>
<p>Attaching code makes things very flexible, but also has several disadvantages:</p>
<ul class="simple">
<li><p>First, it is pretty hard to generate inputs that satisfy multiple constraints at once.
In essence, you have to code your own <em>strategy</em> for generating inputs, which at some point negates the advantage of having an abstract representation such as a grammar.</p></li>
<li><p>Second, your code is not portable. While a grammar can be easily adapted to <em>any</em> grammar-based fuzzer, adding, say, Python code, ties you to the Python environment forever.</p></li>
<li><p>Third, program code can only be used for <em>producing</em> inputs or <em>checking</em> inputs, but not both. This, again, is a downside compared to a pure grammar representation.</p></li>
</ul>
<p>Hence, we are looking to a more <em>general</em> way to express semantic properties - and also a more <em>declarative</em> way to express semantic properties.</p>
<section id="excursion-unrestricted-grammars">
<h3>Excursion: Unrestricted Grammars<a class="headerlink" href="#excursion-unrestricted-grammars" title="Link to this heading">#</a></h3>
<p>One very general solution to this problem would be to use <em>unrestricted</em> grammars rather than the <em>context-free</em> grammars we have used so far.
In an unrestricted grammar, one can have multiple symbols also on the left-hand side of an expansion rule, making them very flexible.
In fact, unrestricted grammars are <em>Turing-universal</em>, meaning that they can express any feature that could also be expressed in program code; and they could thus check and produce arbitrary strings with arbitrary features. (If they finish, that is – unrestricted grammars also suffer from the halting problem.)
The downside is that there is literally no programming support for unrestricted grammars – we’d have to implement all arithmetic, strings, and other functionality from scratch in a grammar, which is - well - not fun.</p>
</section>
<section id="end-of-excursion">
<h3>End of Excursion<a class="headerlink" href="#end-of-excursion" title="Link to this heading">#</a></h3>
</section>
</section>
<section id="specifying-constraints">
<h2>Specifying Constraints<a class="headerlink" href="#specifying-constraints" title="Link to this heading">#</a></h2>
<p>In recent work, <em>Dominic Steinhöfel</em> and <em>Andreas Zeller</em> (one of the authors of this book) have presented an infrastructure that allows producing inputs with <em>arbitrary properties</em>, but without having to go through the trouble of implementing producers or checkers.
Instead, they suggest a dedicated <em>language</em> for specifying inputs, named <a class="reference external" href="https://rindphi.github.io/isla/">ISLa</a> (for input specification language).
<em>ISLa</em> combines a standard context-free <em>grammar</em> with <em>constraints</em> that express <em>semantic</em> properties of the inputs and their elements.
ISLa can be used as a <em>fuzzer</em> (producing inputs that satisfy the constraints) as well as a <em>checker</em> (checking inputs whether they satisfy the given constraints).</p>
<p>Let us illustrate ISLa by example. ISLa comes as a Python package named <code class="docutils literal notranslate"><span class="pre">isla-solver</span></code> that can be easily installed using <code class="docutils literal notranslate"><span class="pre">pip</span></code>:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>pip<span class="w"> </span>install<span class="w"> </span>isla-solver
</pre></div>
</div>
<p>This also installs all dependent packages.</p>
<p>The core of ISLa is the <em>ISLa Solver</em> – the component that actually <em>solves</em> constraints to produce satisfying inputs.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">isla</span>  <span class="c1"># type: ignore</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">isla.solver</span><span class="w"> </span><span class="kn">import</span> <span class="n">ISLaSolver</span>  <span class="c1"># type: ignore</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/Users/zeller/.virtualenvs/python3.13/lib/python3.13/site-packages/isla/solver.py:45: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools&lt;81.
  import pkg_resources
</pre></div>
</div>
</div>
</div>
<p>The constructor of an <code class="docutils literal notranslate"><span class="pre">ISLaSolver</span></code> takes two mandatory arguments.</p>
<ul class="simple">
<li><p>The <em>grammar</em> is the grammar the solver should produce inputs from.</p></li>
<li><p>The <em>constraint</em> is the constraint the produced inputs should satisfy.</p></li>
</ul>
<p>To express a constraint, we have a variety of <em>functions</em> and <em>predicates</em> at our disposition.
These can be applied to individual elements of the grammar, notably their nonterminals.
The function <code class="docutils literal notranslate"><span class="pre">str.len()</span></code>, for instance, returns the length of a string.
If we want to have inputs in which the page size has at least 6 digits, we can write:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">solver</span> <span class="o">=</span> <span class="n">ISLaSolver</span><span class="p">(</span><span class="n">CONFIG_GRAMMAR</span><span class="p">,</span> <span class="s1">&#39;str.len(&lt;pagesize&gt;) &gt;= 6&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>The method <code class="docutils literal notranslate"><span class="pre">solve()</span></code> returns the next produced string from the ISLa solver, as a <em>derivation tree</em> (seen in the <a class="reference internal" href="GrammarFuzzer.html"><span class="std std-doc">Chapter on fuzzing with grammars</span></a>).
To convert these into a string, we can use the <code class="docutils literal notranslate"><span class="pre">str()</span></code> converter:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">str</span><span class="p">(</span><span class="n">solver</span><span class="o">.</span><span class="n">solve</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;pagesize=84056595974\nbufsize=3&#39;
</pre></div>
</div>
</div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">print()</span></code> method converts its arguments to strings implicitly.
To get, say, the next 10 solutions, we can thus write</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">solver</span><span class="o">.</span><span class="n">solve</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>pagesize=84056595974
bufsize=402493567181
pagesize=84056595974
bufsize=1
pagesize=84056595974
bufsize=96
pagesize=84056595974
bufsize=81
pagesize=84056595974
bufsize=514
pagesize=84056595974
bufsize=2
pagesize=84056595974
bufsize=635
pagesize=84056595974
bufsize=7
pagesize=84056595974
bufsize=3
pagesize=614590983583
bufsize=44
</pre></div>
</div>
</div>
</div>
<p>… and we see that, indeed, each page size has exactly six digits.</p>
<section id="excursion-derivation-trees">
<h3>Excursion: Derivation Trees<a class="headerlink" href="#excursion-derivation-trees" title="Link to this heading">#</a></h3>
<p>If you inspect a derivation tree as returned from <code class="docutils literal notranslate"><span class="pre">solve()</span></code> directly, you will get quite a structure:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">solution</span> <span class="o">=</span> <span class="n">solver</span><span class="o">.</span><span class="n">solve</span><span class="p">()</span>
<span class="n">solution</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>DerivationTree(&#39;&lt;start&gt;&#39;, (DerivationTree(&#39;&lt;config&gt;&#39;, (DerivationTree(&#39;pagesize=&#39;, (), id=2), DerivationTree(&#39;&lt;pagesize&gt;&#39;, (DerivationTree(&#39;&lt;int&gt;&#39;, (DerivationTree(&#39;&lt;leaddigit&gt;&#39;, (DerivationTree(&#39;6&#39;, (), id=562),), id=563), DerivationTree(&#39;&lt;digits&gt;&#39;, (DerivationTree(&#39;&lt;digit&gt;&#39;, (DerivationTree(&#39;1&#39;, (), id=572),), id=573), DerivationTree(&#39;&lt;digits&gt;&#39;, (DerivationTree(&#39;&lt;digit&gt;&#39;, (DerivationTree(&#39;4&#39;, (), id=582),), id=583), DerivationTree(&#39;&lt;digits&gt;&#39;, (DerivationTree(&#39;&lt;digit&gt;&#39;, (DerivationTree(&#39;5&#39;, (), id=592),), id=593), DerivationTree(&#39;&lt;digits&gt;&#39;, (DerivationTree(&#39;&lt;digit&gt;&#39;, (DerivationTree(&#39;9&#39;, (), id=602),), id=603), DerivationTree(&#39;&lt;digits&gt;&#39;, (DerivationTree(&#39;&lt;digit&gt;&#39;, (DerivationTree(&#39;0&#39;, (), id=612),), id=613), DerivationTree(&#39;&lt;digits&gt;&#39;, (DerivationTree(&#39;&lt;digit&gt;&#39;, (DerivationTree(&#39;9&#39;, (), id=622),), id=623), DerivationTree(&#39;&lt;digits&gt;&#39;, (DerivationTree(&#39;&lt;digit&gt;&#39;, (DerivationTree(&#39;8&#39;, (), id=632),), id=633), DerivationTree(&#39;&lt;digits&gt;&#39;, (DerivationTree(&#39;&lt;digit&gt;&#39;, (DerivationTree(&#39;3&#39;, (), id=642),), id=643), DerivationTree(&#39;&lt;digits&gt;&#39;, (DerivationTree(&#39;&lt;digit&gt;&#39;, (DerivationTree(&#39;5&#39;, (), id=652),), id=653), DerivationTree(&#39;&lt;digits&gt;&#39;, (DerivationTree(&#39;&lt;digit&gt;&#39;, (DerivationTree(&#39;8&#39;, (), id=662),), id=663), DerivationTree(&#39;&lt;digits&gt;&#39;, (DerivationTree(&#39;&lt;digit&gt;&#39;, (DerivationTree(&#39;3&#39;, (), id=672),), id=673), DerivationTree(&#39;&lt;digits&gt;&#39;, (), id=677)), id=666)), id=656)), id=646)), id=636)), id=626)), id=616)), id=606)), id=596)), id=586)), id=576)), id=566)), id=557),), id=554), DerivationTree(&#39;\nbufsize=&#39;, (), id=4), DerivationTree(&#39;&lt;bufsize&gt;&#39;, (DerivationTree(&#39;&lt;int&gt;&#39;, (DerivationTree(&#39;&lt;leaddigit&gt;&#39;, (DerivationTree(&#39;3&#39;, (), id=1614),), id=1621), DerivationTree(&#39;&lt;digits&gt;&#39;, (DerivationTree(&#39;&lt;digit&gt;&#39;, (DerivationTree(&#39;0&#39;, (), id=1630),), id=1640), DerivationTree(&#39;&lt;digits&gt;&#39;, (DerivationTree(&#39;&lt;digit&gt;&#39;, (DerivationTree(&#39;1&#39;, (), id=1646),), id=1655), DerivationTree(&#39;&lt;digits&gt;&#39;, (DerivationTree(&#39;&#39;, (), id=1641),), id=1644)), id=1629)), id=1625)), id=1611),), id=1608)), id=1),), id=0)
</pre></div>
</div>
</div>
</div>
<p>We can easily visualize the tree, revealing its structure:</p>
<div class="cell tag_remove-input docutils container">
</div>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="_images/6a18c25160c144828938d2c2c6ac837d14251b28bd436f26e3cd9d9102a381c3.svg" src="_images/6a18c25160c144828938d2c2c6ac837d14251b28bd436f26e3cd9d9102a381c3.svg" />
</div>
</div>
<p>By converting the derivation tree into a string, we get the represented string:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">str</span><span class="p">(</span><span class="n">solution</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;pagesize=614590983583\nbufsize=301&#39;
</pre></div>
</div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">print()</span></code> does this implicitly, so <code class="docutils literal notranslate"><span class="pre">print</span></code>ing the solution gives us the string:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">solution</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>pagesize=614590983583
bufsize=301
</pre></div>
</div>
</div>
</div>
<p>Unless you want to inspect the derivation tree or access its elements, converting it into a string makes it more manageable.</p>
</section>
<section id="id1">
<h3>End of Excursion<a class="headerlink" href="#id1" title="Link to this heading">#</a></h3>
<p>To express a minimum numeric value, we can use a more elegant way.
The function <code class="docutils literal notranslate"><span class="pre">str.to.int()</span></code>, for instance, converts a string into an integer.
To obtain a page size that of at least 100000, we can thus also write</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">solver</span> <span class="o">=</span> <span class="n">ISLaSolver</span><span class="p">(</span><span class="n">CONFIG_GRAMMAR</span><span class="p">,</span>
                    <span class="s1">&#39;str.to.int(&lt;pagesize&gt;) &gt;= 100000&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">solver</span><span class="o">.</span><span class="n">solve</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>pagesize=100000
bufsize=25
</pre></div>
</div>
</div>
</div>
<p>If we want the page size to be in the range of 100 to 200, we can state this as a logical conjunction (using <code class="docutils literal notranslate"><span class="pre">and</span></code>)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">solver</span> <span class="o">=</span> <span class="n">ISLaSolver</span><span class="p">(</span><span class="n">CONFIG_GRAMMAR</span><span class="p">,</span> 
<span class="w">                    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">                    str.to.int(&lt;pagesize&gt;) &gt;= 100 and </span>
<span class="sd">                    str.to.int(&lt;pagesize&gt;) &lt;= 200</span>
<span class="sd">                    &#39;&#39;&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">solver</span><span class="o">.</span><span class="n">solve</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>pagesize=116
bufsize=9
</pre></div>
</div>
</div>
</div>
<p>And if we want the page size to be a multiple of seven, we can write</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">solver</span> <span class="o">=</span> <span class="n">ISLaSolver</span><span class="p">(</span><span class="n">CONFIG_GRAMMAR</span><span class="p">,</span> 
<span class="w">                    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">                    str.to.int(&lt;pagesize&gt;) mod 7 = 0</span>
<span class="sd">                    &#39;&#39;&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">solver</span><span class="o">.</span><span class="n">solve</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>pagesize=21
bufsize=7
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">bookutils</span><span class="w"> </span><span class="kn">import</span> <span class="n">quiz</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<div class="output text_html">
    
    <script>
    var bad_answers = new Map();

    function answer(quiz_id) {
        ans = 0;
        for (i = 1;; i++) {
            checkbox = document.getElementById(quiz_id + "-" + i.toString());
            if (!checkbox)
                break;
            if (checkbox.checked)
                ans |= (1 << i);
        }
        return ans;
    }
    function check_selection(quiz_id, correct_answer, multiple_choice, hint) {
        given_answer = answer(quiz_id);
        if (given_answer == correct_answer)
        {
            document.getElementById(quiz_id + "-submit").value = "Correct!";
            document.getElementById(quiz_id + "-hint").innerHTML = "";

            for (i = 1;; i++) {
                checkbox = document.getElementById(quiz_id + "-" + i.toString());
                label = document.getElementById(quiz_id + "-" + i.toString() + "-label")
                if (!checkbox)
                    break;

                if (checkbox.checked) {
                    label.style.fontWeight = "bold";
                }
                else {
                    label.style.textDecoration = "line-through";
                }
            }
        }
        else 
        {
            document.getElementById(quiz_id + "-submit").value = "Try again";

            if (!bad_answers.has(quiz_id)) {
                bad_answers.set(quiz_id, 1);
            }
            else {
                bad_answers.set(quiz_id, bad_answers.get(quiz_id) + 1);
            }

            if (bad_answers.get(quiz_id) >= 2 && hint.length > 0) {
                document.getElementById(quiz_id + "-hint").innerHTML = 
                    "&nbsp;&nbsp;(Hint: <code>" + hint + "</code>)";
            }

            if (!multiple_choice) {
                for (i = 1;; i++) {
                    checkbox = document.getElementById(quiz_id + "-" + i.toString());
                    label = document.getElementById(quiz_id + "-" + i.toString() + "-label")

                    if (!checkbox)
                        break;
                    if (checkbox.checked) {
                        label.style.textDecoration = "line-through";
                    }
                }
            }
        }
    }
    function clear_selection(quiz_id) {
        document.getElementById(quiz_id + "-submit").value = "Submit";
        document.getElementById(quiz_id + "-hint").innerHTML = "";
    }
    </script>
    
    <div class="quiz">
    <h3 class="quiz_title">Quiz</h3>
    <p>
    <div class="quiz_question">Which of the following constraints expresses that the page size and the buffer size have to be equal? Try it out!</div>
    </p>
    <p>
    <div class="quiz_options" title="Check all that apply.">
    
        <input type="checkbox" name="d453882c-b26f-11f0-af47-6298cf1a5790" id="d453882c-b26f-11f0-af47-6298cf1a5790-1" onclick="clear_selection('d453882c-b26f-11f0-af47-6298cf1a5790')">
        <label id="d453882c-b26f-11f0-af47-6298cf1a5790-1-label" for="d453882c-b26f-11f0-af47-6298cf1a5790-1"><code>&lt;pagesize&gt; is &lt;bufsize&gt;</code></label><br>
    
        <input type="checkbox" name="d453882c-b26f-11f0-af47-6298cf1a5790" id="d453882c-b26f-11f0-af47-6298cf1a5790-2" onclick="clear_selection('d453882c-b26f-11f0-af47-6298cf1a5790')">
        <label id="d453882c-b26f-11f0-af47-6298cf1a5790-2-label" for="d453882c-b26f-11f0-af47-6298cf1a5790-2"><code>str.to.int(&lt;pagesize&gt;) = str.to.int(&lt;bufsize&gt;)</code></label><br>
    
        <input type="checkbox" name="d453882c-b26f-11f0-af47-6298cf1a5790" id="d453882c-b26f-11f0-af47-6298cf1a5790-3" onclick="clear_selection('d453882c-b26f-11f0-af47-6298cf1a5790')">
        <label id="d453882c-b26f-11f0-af47-6298cf1a5790-3-label" for="d453882c-b26f-11f0-af47-6298cf1a5790-3"><code>&lt;pagesize&gt; = &lt;bufsize&gt;</code></label><br>
    
        <input type="checkbox" name="d453882c-b26f-11f0-af47-6298cf1a5790" id="d453882c-b26f-11f0-af47-6298cf1a5790-4" onclick="clear_selection('d453882c-b26f-11f0-af47-6298cf1a5790')">
        <label id="d453882c-b26f-11f0-af47-6298cf1a5790-4-label" for="d453882c-b26f-11f0-af47-6298cf1a5790-4"><code>atoi(&lt;pagesize&gt;) == atoi(&lt;bufsize&gt;)</code></label><br>
    
    </div>
    </p>
    <input id="d453882c-b26f-11f0-af47-6298cf1a5790-submit" type="submit" value="Submit" onclick="check_selection('d453882c-b26f-11f0-af47-6298cf1a5790', 12, 1, '[4 ** 0.5, 9 ** 0.5]')">
    <span class="quiz_hint" id="d453882c-b26f-11f0-af47-6298cf1a5790-hint"></span>
    </div>
    </div></div>
</div>
<p>Indeed, ISLa constraints can also involve multiple elements. Expressing equality between two elements is easy, and uses a single equal sign. (There’s no assignment in ISLa the <code class="docutils literal notranslate"><span class="pre">=</span></code> could be confused with.)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">solver</span> <span class="o">=</span> <span class="n">ISLaSolver</span><span class="p">(</span><span class="n">CONFIG_GRAMMAR</span><span class="p">,</span> 
<span class="w">                    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">                    &lt;pagesize&gt; = &lt;bufsize&gt;</span>
<span class="sd">                    &#39;&#39;&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">solver</span><span class="o">.</span><span class="n">solve</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>pagesize=8
bufsize=8
</pre></div>
</div>
</div>
</div>
<p>We can also use numerical constraints, stating that the buffer size should always be exactly one more than the page size:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">solver</span> <span class="o">=</span> <span class="n">ISLaSolver</span><span class="p">(</span><span class="n">CONFIG_GRAMMAR</span><span class="p">,</span> 
<span class="w">                    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">                    str.to.int(&lt;pagesize&gt;) &gt; 1024 and</span>
<span class="sd">                    str.to.int(&lt;bufsize&gt;) = str.to.int(&lt;pagesize&gt;) + 1</span>
<span class="sd">                    &#39;&#39;&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">solver</span><span class="o">.</span><span class="n">solve</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>pagesize=1025
bufsize=1026
</pre></div>
</div>
</div>
</div>
<p>All the above functions (like <code class="docutils literal notranslate"><span class="pre">str.to.int()</span></code>) actually stem from the <em>SMT-LIB</em> library for <em>satisfiability modulo theories</em> (SMT), a standard for expressing constraints for constraint solvers (like ISLa).
The <a class="reference external" href="https://smtlib.cs.uiowa.edu/theories.shtml">list of all theories defined in SMT-LIB</a> lists dozens of functions and predicates that can be used in ISLa constraints.</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<div class="output text_html">
    
    <script>
    var bad_answers = new Map();

    function answer(quiz_id) {
        ans = 0;
        for (i = 1;; i++) {
            checkbox = document.getElementById(quiz_id + "-" + i.toString());
            if (!checkbox)
                break;
            if (checkbox.checked)
                ans |= (1 << i);
        }
        return ans;
    }
    function check_selection(quiz_id, correct_answer, multiple_choice, hint) {
        given_answer = answer(quiz_id);
        if (given_answer == correct_answer)
        {
            document.getElementById(quiz_id + "-submit").value = "Correct!";
            document.getElementById(quiz_id + "-hint").innerHTML = "";

            for (i = 1;; i++) {
                checkbox = document.getElementById(quiz_id + "-" + i.toString());
                label = document.getElementById(quiz_id + "-" + i.toString() + "-label")
                if (!checkbox)
                    break;

                if (checkbox.checked) {
                    label.style.fontWeight = "bold";
                }
                else {
                    label.style.textDecoration = "line-through";
                }
            }
        }
        else 
        {
            document.getElementById(quiz_id + "-submit").value = "Try again";

            if (!bad_answers.has(quiz_id)) {
                bad_answers.set(quiz_id, 1);
            }
            else {
                bad_answers.set(quiz_id, bad_answers.get(quiz_id) + 1);
            }

            if (bad_answers.get(quiz_id) >= 2 && hint.length > 0) {
                document.getElementById(quiz_id + "-hint").innerHTML = 
                    "&nbsp;&nbsp;(Hint: <code>" + hint + "</code>)";
            }

            if (!multiple_choice) {
                for (i = 1;; i++) {
                    checkbox = document.getElementById(quiz_id + "-" + i.toString());
                    label = document.getElementById(quiz_id + "-" + i.toString() + "-label")

                    if (!checkbox)
                        break;
                    if (checkbox.checked) {
                        label.style.textDecoration = "line-through";
                    }
                }
            }
        }
    }
    function clear_selection(quiz_id) {
        document.getElementById(quiz_id + "-submit").value = "Submit";
        document.getElementById(quiz_id + "-hint").innerHTML = "";
    }
    </script>
    
    <div class="quiz">
    <h3 class="quiz_title">Quiz</h3>
    <p>
    <div class="quiz_question">Which constraints are necessary to ensure that all digits are between 1 and 3?</div>
    </p>
    <p>
    <div class="quiz_options" title="Check all that apply.">
    
        <input type="checkbox" name="d5f33dbc-b26f-11f0-af47-6298cf1a5790" id="d5f33dbc-b26f-11f0-af47-6298cf1a5790-1" onclick="clear_selection('d5f33dbc-b26f-11f0-af47-6298cf1a5790')">
        <label id="d5f33dbc-b26f-11f0-af47-6298cf1a5790-1-label" for="d5f33dbc-b26f-11f0-af47-6298cf1a5790-1"><code>str.to.int(&lt;digit&gt;) &gt;= 1</code></label><br>
    
        <input type="checkbox" name="d5f33dbc-b26f-11f0-af47-6298cf1a5790" id="d5f33dbc-b26f-11f0-af47-6298cf1a5790-2" onclick="clear_selection('d5f33dbc-b26f-11f0-af47-6298cf1a5790')">
        <label id="d5f33dbc-b26f-11f0-af47-6298cf1a5790-2-label" for="d5f33dbc-b26f-11f0-af47-6298cf1a5790-2"><code>str.to.int(&lt;digit&gt;) &lt;= 3</code></label><br>
    
        <input type="checkbox" name="d5f33dbc-b26f-11f0-af47-6298cf1a5790" id="d5f33dbc-b26f-11f0-af47-6298cf1a5790-3" onclick="clear_selection('d5f33dbc-b26f-11f0-af47-6298cf1a5790')">
        <label id="d5f33dbc-b26f-11f0-af47-6298cf1a5790-3-label" for="d5f33dbc-b26f-11f0-af47-6298cf1a5790-3"><code>str.to.int(&lt;leaddigit&gt;) &gt;= 1</code></label><br>
    
        <input type="checkbox" name="d5f33dbc-b26f-11f0-af47-6298cf1a5790" id="d5f33dbc-b26f-11f0-af47-6298cf1a5790-4" onclick="clear_selection('d5f33dbc-b26f-11f0-af47-6298cf1a5790')">
        <label id="d5f33dbc-b26f-11f0-af47-6298cf1a5790-4-label" for="d5f33dbc-b26f-11f0-af47-6298cf1a5790-4"><code>str.to.int(&lt;leaddigit&gt;) &lt;= 3</code></label><br>
    
    </div>
    </p>
    <input id="d5f33dbc-b26f-11f0-af47-6298cf1a5790-submit" type="submit" value="Submit" onclick="check_selection('d5f33dbc-b26f-11f0-af47-6298cf1a5790', 22, 1, '[1 ** 0, 4 ** 0.5, 16 ** 0.5]')">
    <span class="quiz_hint" id="d5f33dbc-b26f-11f0-af47-6298cf1a5790-hint"></span>
    </div>
    </div></div>
</div>
</section>
<section id="excursion-using-smt-lib-syntax">
<h3>Excursion: Using SMT-LIB Syntax<a class="headerlink" href="#excursion-using-smt-lib-syntax" title="Link to this heading">#</a></h3>
<p>Instead of the above “infix” syntax which is familiar to programmers, ISLa also supports full SMT-LIB syntax.
Instead of writing <span class="math notranslate nohighlight">\(f(x_1, x_2, x_3, \dots)\)</span> for a function <span class="math notranslate nohighlight">\(f\)</span> and its arguments <span class="math notranslate nohighlight">\(x_1 \dots x_n\)</span>, SMT-LIB uses a “prefix” LISP-like syntax in which all functions and operators are written as <span class="math notranslate nohighlight">\((f x_1 x_2 x_3 \dots)\)</span>.
The above predicate would thus be written as</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">solver</span> <span class="o">=</span> <span class="n">ISLaSolver</span><span class="p">(</span><span class="n">CONFIG_GRAMMAR</span><span class="p">,</span> 
<span class="w">                </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">                (and</span>
<span class="sd">                  (&gt; (str.to.int &lt;pagesize&gt;) 1024)</span>
<span class="sd">                  (= (str.to.int &lt;bufsize&gt;)</span>
<span class="sd">                     (+ (str.to.int &lt;pagesize&gt;) 1)))</span>
<span class="sd">                &#39;&#39;&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">solver</span><span class="o">.</span><span class="n">solve</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>pagesize=1025
bufsize=1026
</pre></div>
</div>
</div>
</div>
<p>Note that for boolean operators such as <code class="docutils literal notranslate"><span class="pre">and</span></code>, we still use the ISLa infix syntax; having ISLa handle these operators is more efficient than passing them on to the constraint solver.</p>
</section>
<section id="id2">
<h3>End of Excursion<a class="headerlink" href="#id2" title="Link to this heading">#</a></h3>
</section>
</section>
<section id="isla-on-the-command-line">
<h2>ISLa on the Command Line<a class="headerlink" href="#isla-on-the-command-line" title="Link to this heading">#</a></h2>
<p>When you install <code class="docutils literal notranslate"><span class="pre">isla-solver</span></code>, you also get an <code class="docutils literal notranslate"><span class="pre">isla</span></code> command-line tool.
This allows you to create inputs from the command line or shell scripts.</p>
<p>Let us first create a <em>grammar file</em> suitable for <code class="docutils literal notranslate"><span class="pre">isla</span></code>. <code class="docutils literal notranslate"><span class="pre">isla</span></code> accepts grammars in Fuzzingbook format; they need to define a variable named <code class="docutils literal notranslate"><span class="pre">grammar</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;grammar.py&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;grammar = &#39;</span><span class="p">)</span>
    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">CONFIG_GRAMMAR</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">bookutils</span><span class="w"> </span><span class="kn">import</span> <span class="n">print_file</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">print_file</span><span class="p">(</span><span class="s1">&#39;grammar.py&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>grammar = {<span class=" -Color -Color-Yellow">&#39;&lt;start&gt;&#39;</span>: [<span class=" -Color -Color-Yellow">&#39;&lt;config&gt;&#39;</span>], <span class=" -Color -Color-Yellow">&#39;&lt;config&gt;&#39;</span>: [<span class=" -Color -Color-Yellow">&#39;pagesize=&lt;pagesize&gt;\nbufsize=&lt;bufsize&gt;&#39;</span>], <span class=" -Color -Color-Yellow">&#39;&lt;pagesize&gt;&#39;</span>: [<span class=" -Color -Color-Yellow">&#39;&lt;int&gt;&#39;</span>], <span class=" -Color -Color-Yellow">&#39;&lt;bufsize&gt;&#39;</span>: [<span class=" -Color -Color-Yellow">&#39;&lt;int&gt;&#39;</span>], <span class=" -Color -Color-Yellow">&#39;&lt;int&gt;&#39;</span>: [<span class=" -Color -Color-Yellow">&#39;&lt;leaddigit&gt;&lt;digits&gt;&#39;</span>], <span class=" -Color -Color-Yellow">&#39;&lt;digits&gt;&#39;</span>: [<span class=" -Color -Color-Yellow">&#39;&#39;</span>, <span class=" -Color -Color-Yellow">&#39;&lt;digit&gt;&lt;digits&gt;&#39;</span>], <span class=" -Color -Color-Yellow">&#39;&lt;digit&gt;&#39;</span>: [<span class=" -Color -Color-Yellow">&#39;0&#39;</span>, <span class=" -Color -Color-Yellow">&#39;1&#39;</span>, <span class=" -Color -Color-Yellow">&#39;2&#39;</span>, <span class=" -Color -Color-Yellow">&#39;3&#39;</span>, <span class=" -Color -Color-Yellow">&#39;4&#39;</span>, <span class=" -Color -Color-Yellow">&#39;5&#39;</span>, <span class=" -Color -Color-Yellow">&#39;6&#39;</span>, <span class=" -Color -Color-Yellow">&#39;7&#39;</span>, <span class=" -Color -Color-Yellow">&#39;8&#39;</span>, <span class=" -Color -Color-Yellow">&#39;9&#39;</span>], <span class=" -Color -Color-Yellow">&#39;&lt;leaddigit&gt;&#39;</span>: [<span class=" -Color -Color-Yellow">&#39;1&#39;</span>, <span class=" -Color -Color-Yellow">&#39;2&#39;</span>, <span class=" -Color -Color-Yellow">&#39;3&#39;</span>, <span class=" -Color -Color-Yellow">&#39;4&#39;</span>, <span class=" -Color -Color-Yellow">&#39;5&#39;</span>, <span class=" -Color -Color-Yellow">&#39;6&#39;</span>, <span class=" -Color -Color-Yellow">&#39;7&#39;</span>, <span class=" -Color -Color-Yellow">&#39;8&#39;</span>, <span class=" -Color -Color-Yellow">&#39;9&#39;</span>]}
</pre></div>
</div>
</div>
</div>
<p>With this, we can use <code class="docutils literal notranslate"><span class="pre">isla</span></code> as a grammar fuzzer, plain and simple
By default, <code class="docutils literal notranslate"><span class="pre">isla</span> <span class="pre">solve</span></code> produces one single matching output:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>isla<span class="w"> </span>solve<span class="w"> </span>grammar.py
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/Users/zeller/.virtualenvs/python3.13/lib/python3.13/site-packages/z3/z3core.py:5: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools&lt;81.
  import pkg_resources
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>pagesize=9
bufsize=617380254960
</pre></div>
</div>
</div>
</div>
<p>The true power of <code class="docutils literal notranslate"><span class="pre">isla</span></code>, however, comes to be as we (again) add <em>constraints</em> to be solved - either in separate <em>constraint files</em> or (easier) directly on the command line:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>isla<span class="w"> </span>solve<span class="w"> </span>grammar.py<span class="w"> </span>--constraint<span class="w"> </span><span class="s1">&#39;&lt;pagesize&gt; = &lt;bufsize&gt;&#39;</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/Users/zeller/.virtualenvs/python3.13/lib/python3.13/site-packages/z3/z3core.py:5: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools&lt;81.
  import pkg_resources
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>pagesize=8
bufsize=8
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>isla<span class="w"> </span>solve<span class="w"> </span>grammar.py<span class="w"> </span><span class="err">\</span>
    <span class="o">--</span><span class="n">constraint</span> <span class="s1">&#39;&lt;pagesize&gt; = &lt;bufsize&gt; and str.to.int(&lt;pagesize&gt;) &gt; 10000&#39;</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/Users/zeller/.virtualenvs/python3.13/lib/python3.13/site-packages/z3/z3core.py:5: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools&lt;81.
  import pkg_resources
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>pagesize=99290248
bufsize=99290248
</pre></div>
</div>
</div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">isla</span></code> executable provides several options and commands, and is a great alternative on the command line.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>isla<span class="w"> </span>--help
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/Users/zeller/.virtualenvs/python3.13/lib/python3.13/site-packages/z3/z3core.py:5: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools&lt;81.
  import pkg_resources
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>usage: isla [-h] [-v]
            {solve,fuzz,check,find,parse,repair,mutate,create,config} ...

The ISLa command line interface.

options:
  -h, --help            show this help message and exit
  -v, --version         Print the ISLa version number

Commands:
  {solve,fuzz,check,find,parse,repair,mutate,create,config}
    solve               create solutions to ISLa constraints or check their
                        unsatisfiability
    fuzz                pass solutions to an ISLa constraint to a test subject
    check               check whether an input satisfies an ISLa constraint
    find                filter files satisfying syntactic &amp; semantic
                        constraints
    parse               parse an input into a derivation tree if it satisfies
                        an ISLa constraint
    repair              try to repair an existing input such that it satisfies
                        an ISLa constraint
    mutate              mutate an input such that the result satisfies an ISLa
                        constraint
    create              create grammar and constraint stubs
    config              dumps the default configuration file
</pre></div>
</div>
</div>
</div>
</section>
<section id="accessing-elements">
<h2>Accessing Elements<a class="headerlink" href="#accessing-elements" title="Link to this heading">#</a></h2>
<p>So far, we have accessed nonterminals simply by referencing their name, as in <code class="docutils literal notranslate"><span class="pre">&lt;bufsize&gt;</span></code> or <code class="docutils literal notranslate"><span class="pre">&lt;pagesize&gt;</span></code>.
However, in some cases, this simple method is not sufficient.
In our configuration grammar, for instance, we may want to access (or constrain) <code class="docutils literal notranslate"><span class="pre">&lt;int&gt;</span></code> elements.
However, we do not want to constrain <em>all</em> integers at once, but only those in a particular <em>context</em> – say, those that occur as a part of a <code class="docutils literal notranslate"><span class="pre">&lt;pagesize&gt;</span></code> element, or only those that occur as part of a <code class="docutils literal notranslate"><span class="pre">&lt;config&gt;</span></code> element.</p>
<p>To this end, ISLa allows referencing <em>parts</em> of a given element, using two special operators.</p>
<p>The expression <code class="docutils literal notranslate"><span class="pre">&lt;a&gt;.&lt;b&gt;</span></code> refers to the <em>immediate</em> subpart <code class="docutils literal notranslate"><span class="pre">&lt;b&gt;</span></code> of some element <code class="docutils literal notranslate"><span class="pre">&lt;a&gt;</span></code>.
That is, <code class="docutils literal notranslate"><span class="pre">&lt;b&gt;</span></code> has to appear in one of the expansion rules of <code class="docutils literal notranslate"><span class="pre">&lt;a&gt;</span></code>.
For instance, <code class="docutils literal notranslate"><span class="pre">&lt;pagesize&gt;.&lt;int&gt;</span></code> refers to the <code class="docutils literal notranslate"><span class="pre">&lt;int&gt;</span></code> element of a page size.
Here is an example using the dot operator:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">solver</span> <span class="o">=</span> <span class="n">ISLaSolver</span><span class="p">(</span><span class="n">CONFIG_GRAMMAR</span><span class="p">,</span> 
<span class="w">                </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">                &lt;pagesize&gt;.&lt;int&gt; = &lt;bufsize&gt;.&lt;int&gt;</span>
<span class="sd">                &#39;&#39;&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">solver</span><span class="o">.</span><span class="n">solve</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>pagesize=8
bufsize=8
</pre></div>
</div>
</div>
</div>
<p>The expression <code class="docutils literal notranslate"><span class="pre">&lt;a&gt;..&lt;b&gt;</span></code>, however, refers to <em>any</em> subpart <code class="docutils literal notranslate"><span class="pre">&lt;b&gt;</span></code> of some element <code class="docutils literal notranslate"><span class="pre">&lt;a&gt;</span></code>. That is, <code class="docutils literal notranslate"><span class="pre">&lt;b&gt;</span></code> can appear in the expansion of <code class="docutils literal notranslate"><span class="pre">&lt;a&gt;</span></code>, but also in the expansion of any subelement (and any subelement thereof).
Here is an example using the double dot operator, enforcing <em>every</em> digit in a <code class="docutils literal notranslate"><span class="pre">&lt;config&gt;</span></code> element to be <code class="docutils literal notranslate"><span class="pre">7</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">ExpectError</span><span class="w"> </span><span class="kn">import</span> <span class="n">ExpectError</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">solver</span> <span class="o">=</span> <span class="n">ISLaSolver</span><span class="p">(</span><span class="n">CONFIG_GRAMMAR</span><span class="p">,</span> 
<span class="w">            </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">            &lt;config&gt;..&lt;digit&gt; = &quot;7&quot; and &lt;config&gt;..&lt;leaddigit&gt; = &quot;7&quot;</span>
<span class="sd">            &#39;&#39;&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">solver</span><span class="o">.</span><span class="n">solve</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>pagesize=7
bufsize=77
</pre></div>
</div>
</div>
</div>
<p>To reason about dots and double dots, it helps to visualize the string in question as a <em>derivation tree</em> discussed in the <a class="reference internal" href="GrammarFuzzer.html"><span class="std std-doc">chapter on grammar-based fuzzing</span></a>.
The derivation tree of the input</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pagesize</span><span class="o">=</span><span class="mi">12</span>
<span class="n">bufsize</span><span class="o">=</span><span class="mi">34</span>
</pre></div>
</div>
<p>for instance, looks like this:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="_images/63d839866b89869160c9d1494da95980fb6a0b2543f3a6dddc904e437bfd1238.svg" src="_images/63d839866b89869160c9d1494da95980fb6a0b2543f3a6dddc904e437bfd1238.svg" />
</div>
</div>
<p>In this tree, the <code class="docutils literal notranslate"><span class="pre">.</span></code> syntax refers to <em>immediate</em> children. <code class="docutils literal notranslate"><span class="pre">&lt;bufsize&gt;.&lt;int&gt;</span></code> is the one <code class="docutils literal notranslate"><span class="pre">&lt;int&gt;</span></code> node that is the immediate descendant of <code class="docutils literal notranslate"><span class="pre">&lt;bufsize&gt;</span></code> (but not any other <code class="docutils literal notranslate"><span class="pre">&lt;int&gt;</span></code> node).
In contrast, <code class="docutils literal notranslate"><span class="pre">&lt;config&gt;..&lt;digit&gt;</span></code> refers to <em>all</em> <code class="docutils literal notranslate"><span class="pre">&lt;digit&gt;</span></code> descendants of the <code class="docutils literal notranslate"><span class="pre">&lt;config&gt;</span></code> node.</p>
<p>If an element has multiple <em>immediate</em> children of the same type, one can use the special <code class="docutils literal notranslate"><span class="pre">&lt;a&gt;[$n$]</span></code> syntax to access the <span class="math notranslate nohighlight">\(n\)</span>-th child of type <code class="docutils literal notranslate"><span class="pre">&lt;a&gt;</span></code>. To access the first child, <span class="math notranslate nohighlight">\(n\)</span> is equal to one, not zero, as in the <a class="reference external" href="https://www.w3.org/TR/1999/REC-xpath-19991116/#path-abbrev">XPath abbreviated syntax</a>. In our configuration grammar, there is no expansion including the same nonterminal more than once, so we do not need this feature.</p>
<p>For a demonstration of indexed dots, consider the following grammar, which produces lines of three “a” or “b” characters:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">LINES_OF_THREE_AS_OR_BS_GRAMMAR</span><span class="p">:</span> <span class="n">Grammar</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;&lt;start&gt;&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;&lt;A&gt;&#39;</span><span class="p">],</span>
    <span class="s1">&#39;&lt;A&gt;&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;&lt;B&gt;&lt;B&gt;&lt;B&gt;&#39;</span><span class="p">,</span> <span class="s1">&#39;&lt;B&gt;&lt;B&gt;&lt;B&gt;</span><span class="se">\n</span><span class="s1">&lt;A&gt;&#39;</span><span class="p">],</span>
    <span class="s1">&#39;&lt;B&gt;&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fuzzer</span> <span class="o">=</span> <span class="n">GrammarFuzzer</span><span class="p">(</span><span class="n">LINES_OF_THREE_AS_OR_BS_GRAMMAR</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">fuzzer</span><span class="o">.</span><span class="n">fuzz</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0
aab
bab
1
aaa
aba
2
aba
baa
bba
3
bbb
abb
4
baa
</pre></div>
</div>
</div>
</div>
<p>We can force, say, the second character in a line to always be a “b:”</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">solver</span> <span class="o">=</span> <span class="n">ISLaSolver</span><span class="p">(</span><span class="n">LINES_OF_THREE_AS_OR_BS_GRAMMAR</span><span class="p">,</span> 
<span class="w">            </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">            &lt;A&gt;.&lt;B&gt;[2] = &quot;b&quot;</span>
<span class="sd">            &#39;&#39;&#39;</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">solver</span><span class="o">.</span><span class="n">solve</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>abb
1
bbb
2
abb
3
bbb
4
abb
</pre></div>
</div>
</div>
</div>
</section>
<section id="quantifiers">
<h2>Quantifiers<a class="headerlink" href="#quantifiers" title="Link to this heading">#</a></h2>
<p>By default, all nonterminals in ISLa constraints are <em>universally</em> quantified - that is, any constraint applying to, say, some <code class="docutils literal notranslate"><span class="pre">&lt;int&gt;</span></code> element applies to <em>all</em> <code class="docutils literal notranslate"><span class="pre">&lt;int&gt;</span></code> elements in the resulting string.
If you only want to constrain <em>one</em> element, though, you have to (and can) specify this in ISLa, using an <em>existential quantifier</em>.</p>
<p>To use an existential quantifier in ISLa, use the construct</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">exists</span> <span class="n">TYPE</span> <span class="n">VARIABLE</span> <span class="ow">in</span> <span class="n">CONTEXT</span><span class="p">:</span>
    <span class="p">(</span><span class="n">CONSTRAINT</span><span class="p">)</span>
</pre></div>
</div>
<p>where <code class="docutils literal notranslate"><span class="pre">VARIABLE</span></code> is some identifier, <code class="docutils literal notranslate"><span class="pre">TYPE</span></code> is its type (as a nonterminal), and <code class="docutils literal notranslate"><span class="pre">CONTEXT</span></code> is the context (again a nonterminal) in which the constraint should hold.
<code class="docutils literal notranslate"><span class="pre">CONSTRAINT</span></code> is again a constraint expression, in which you now can make use of <code class="docutils literal notranslate"><span class="pre">VARIABLE</span></code> as the element whose existence you assume.</p>
<p>Let us illustrate existential quantification again using a simple example.
We want to make sure that at least one integer in our generated string has a value of more than 1000.
So we write</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">solver</span> <span class="o">=</span> <span class="n">ISLaSolver</span><span class="p">(</span><span class="n">CONFIG_GRAMMAR</span><span class="p">,</span> 
<span class="w">            </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">            exists &lt;int&gt; i in &lt;start&gt;:</span>
<span class="sd">                str.to.int(i) &gt; 1000</span>
<span class="sd">            &#39;&#39;&#39;</span><span class="p">)</span>

<span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">solver</span><span class="o">.</span><span class="n">solve</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>pagesize=1001
bufsize=5
pagesize=1001
bufsize=2280617349521
pagesize=1001
bufsize=8
pagesize=1001
bufsize=7
pagesize=1001
bufsize=3
pagesize=1001
bufsize=93
pagesize=1001
bufsize=630
pagesize=1001
bufsize=4
pagesize=1001
bufsize=14
pagesize=1001
bufsize=5
</pre></div>
</div>
</div>
</div>
<p>We note that all generated inputs satisfy the constraint of having at least one integer that satisfies the constraint.</p>
<p>Specifying a variable name is optional; if you omit it, you can use the quantified nonterminal instead.
The above constraint can thus also be expressed in a more compact fashion:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">solver</span> <span class="o">=</span> <span class="n">ISLaSolver</span><span class="p">(</span><span class="n">CONFIG_GRAMMAR</span><span class="p">,</span> 
<span class="w">            </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">            exists &lt;int&gt; in &lt;start&gt;:</span>
<span class="sd">                str.to.int(&lt;int&gt;) &gt; 1000</span>
<span class="sd">            &#39;&#39;&#39;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">solver</span><span class="o">.</span><span class="n">solve</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>pagesize=1008
bufsize=64
</pre></div>
</div>
</div>
</div>
<p>Besides existential quantification, there also is <em>universal</em> quantification, using the <code class="docutils literal notranslate"><span class="pre">forall</span></code> keyword instead of <code class="docutils literal notranslate"><span class="pre">exists</span></code>.
If we want <em>all</em> elements in some context to satisfy a constraint, this comes in handy.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">solver</span> <span class="o">=</span> <span class="n">ISLaSolver</span><span class="p">(</span><span class="n">CONFIG_GRAMMAR</span><span class="p">,</span> 
<span class="w">            </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">            forall &lt;int&gt; in &lt;start&gt;:</span>
<span class="sd">                str.to.int(&lt;int&gt;) &gt; 1000</span>
<span class="sd">            &#39;&#39;&#39;</span><span class="p">)</span>

<span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">solver</span><span class="o">.</span><span class="n">solve</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>pagesize=1001
bufsize=1001
pagesize=1001
bufsize=1002
pagesize=1001
bufsize=1003
pagesize=1001
bufsize=1004
pagesize=1002
bufsize=1001
pagesize=1002
bufsize=1002
pagesize=1002
bufsize=1003
pagesize=1002
bufsize=1004
pagesize=1003
bufsize=1001
pagesize=1003
bufsize=1002
</pre></div>
</div>
</div>
</div>
<p>We see that all <code class="docutils literal notranslate"><span class="pre">&lt;int&gt;</span></code> elements satisfy the constraint.</p>
<p>By default, all nonterminals that are re-used directly in constraints are universally quantified within the <code class="docutils literal notranslate"><span class="pre">&lt;start&gt;</span></code> symbol, so the above can actually be simplified to</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">solver</span> <span class="o">=</span> <span class="n">ISLaSolver</span><span class="p">(</span><span class="n">CONFIG_GRAMMAR</span><span class="p">,</span> 
<span class="w">            </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">            str.to.int(&lt;int&gt;) &gt; 1000</span>
<span class="sd">            &#39;&#39;&#39;</span><span class="p">)</span>

<span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">solver</span><span class="o">.</span><span class="n">solve</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>pagesize=1001
bufsize=1001
pagesize=1001
bufsize=1002
pagesize=1001
bufsize=1003
pagesize=1001
bufsize=1004
pagesize=1002
bufsize=1001
pagesize=1002
bufsize=1002
pagesize=1002
bufsize=1003
pagesize=1002
bufsize=1004
pagesize=1003
bufsize=1001
pagesize=1003
bufsize=1002
</pre></div>
</div>
</div>
</div>
<p>… and you realize that in all our initial constraints, we always had an implicit universal quantification.</p>
</section>
<section id="picking-expansions">
<h2>Picking Expansions<a class="headerlink" href="#picking-expansions" title="Link to this heading">#</a></h2>
<p>Sometimes, we’d like a quantifier to apply only for a specific expansion alternative of a nonterminal.
The form</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">forall</span> <span class="n">TYPE</span> <span class="n">VARIABLE</span><span class="o">=</span><span class="n">PATTERN</span> <span class="ow">in</span> <span class="n">CONTEXT</span><span class="p">:</span>
    <span class="p">(</span><span class="n">CONSTRAINT</span><span class="p">)</span>
</pre></div>
</div>
<p>means that the CONSTRAINT only applies to a VARIABLE that actually matches the expansion given in PATTERN.
(Again, we can replace <code class="docutils literal notranslate"><span class="pre">forall</span></code> with <code class="docutils literal notranslate"><span class="pre">exists</span></code>, and make this an existential quantification rather than a universal quantification.)</p>
<p>Here’s an example of using <code class="docutils literal notranslate"><span class="pre">forall</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">solver</span> <span class="o">=</span> <span class="n">ISLaSolver</span><span class="p">(</span><span class="n">CONFIG_GRAMMAR</span><span class="p">,</span> 
<span class="w">            </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">            forall &lt;int&gt;=&quot;&lt;leaddigit&gt;&lt;digits&gt;&quot; in &lt;start&gt;:</span>
<span class="sd">                (&lt;leaddigit&gt; = &quot;7&quot;)</span>
<span class="sd">            &#39;&#39;&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>This ensures that when <code class="docutils literal notranslate"><span class="pre">&lt;int&gt;</span></code> is expanded to a lead digit followed by more digits, the lead digit becomes <code class="docutils literal notranslate"><span class="pre">7</span></code>.
The effect is that all <code class="docutils literal notranslate"><span class="pre">&lt;int&gt;</span></code> values now start with a <code class="docutils literal notranslate"><span class="pre">7</span></code> digit:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">str</span><span class="p">(</span><span class="n">solver</span><span class="o">.</span><span class="n">solve</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;pagesize=71\nbufsize=770835426929713&#39;
</pre></div>
</div>
</div>
</div>
<p>Likewise, we can constrain <code class="docutils literal notranslate"><span class="pre">&lt;int&gt;</span></code> as a whole, and thus ensure that all numbers are greater than 100:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">solver</span> <span class="o">=</span> <span class="n">ISLaSolver</span><span class="p">(</span><span class="n">CONFIG_GRAMMAR</span><span class="p">,</span> 
<span class="w">            </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">            forall &lt;int&gt; in &lt;start&gt;:</span>
<span class="sd">                (str.to.int(&lt;int&gt;) &gt; 100)</span>
<span class="sd">            &#39;&#39;&#39;</span><span class="p">)</span>

<span class="nb">str</span><span class="p">(</span><span class="n">solver</span><span class="o">.</span><span class="n">solve</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;pagesize=101\nbufsize=101&#39;
</pre></div>
</div>
</div>
</div>
<p>By default, all variables are universally quantified in <code class="docutils literal notranslate"><span class="pre">&lt;start&gt;</span></code>, so the above can also be expressed as</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">solver</span> <span class="o">=</span> <span class="n">ISLaSolver</span><span class="p">(</span><span class="n">CONFIG_GRAMMAR</span><span class="p">,</span> 
<span class="w">            </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">            str.to.int(&lt;int&gt;) &gt; 100</span>
<span class="sd">            &#39;&#39;&#39;</span><span class="p">)</span>

<span class="nb">str</span><span class="p">(</span><span class="n">solver</span><span class="o">.</span><span class="n">solve</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;pagesize=101\nbufsize=101&#39;
</pre></div>
</div>
</div>
</div>
</section>
<section id="matching-expansion-elements">
<h2>Matching Expansion Elements<a class="headerlink" href="#matching-expansion-elements" title="Link to this heading">#</a></h2>
<p>In a quantification pattern, we can also <em>name</em> individual nonterminal elements and use them in our constraints.
This is done by replacing the nonterminal <code class="docutils literal notranslate"><span class="pre">&lt;ID&gt;</span></code> with the special form <code class="docutils literal notranslate"><span class="pre">{&lt;ID&gt;</span> <span class="pre">VARIABLE}</span></code> (in curly braces) which then makes the variable <code class="docutils literal notranslate"><span class="pre">VARIABLE</span></code> a placeholder for the value matched by <code class="docutils literal notranslate"><span class="pre">ID</span></code>; <code class="docutils literal notranslate"><span class="pre">VARIABLE</span></code> can then be used in constraints.</p>
<p>Here is an example. In the expansion <code class="docutils literal notranslate"><span class="pre">&lt;leaddigit&gt;&lt;int&gt;</span></code>, we want to ensure that the <code class="docutils literal notranslate"><span class="pre">&lt;leaddigit&gt;</span></code> is always <code class="docutils literal notranslate"><span class="pre">9</span></code>.
Using the special brace form, we make <code class="docutils literal notranslate"><span class="pre">lead</span></code> a variable holding the value of <code class="docutils literal notranslate"><span class="pre">&lt;leaddigit&gt;</span></code>, and can then use it in a constraint:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">solver</span> <span class="o">=</span> <span class="n">ISLaSolver</span><span class="p">(</span><span class="n">CONFIG_GRAMMAR</span><span class="p">,</span> 
<span class="w">            </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">            forall &lt;int&gt; i=&quot;{&lt;leaddigit&gt; lead}&lt;digits&gt;&quot; in &lt;start&gt;:</span>
<span class="sd">                (lead = &quot;9&quot;)</span>
<span class="sd">            &#39;&#39;&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>This (again) ensures that all lead digits should be <code class="docutils literal notranslate"><span class="pre">9</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">solver</span><span class="o">.</span><span class="n">solve</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>pagesize=92
bufsize=9168435097796
pagesize=9
bufsize=9188
pagesize=981
bufsize=999
pagesize=9
bufsize=9
pagesize=9
bufsize=9
pagesize=9
bufsize=9
pagesize=91
bufsize=9
pagesize=9
bufsize=9
pagesize=90
bufsize=9
pagesize=9
bufsize=9242
</pre></div>
</div>
</div>
</div>
<p>Could we express the above in a simpler fashion? Yes! For one, we can refer to <code class="docutils literal notranslate"><span class="pre">&lt;leaddigit&gt;</span></code> directly rather than introducing variables like <code class="docutils literal notranslate"><span class="pre">i</span></code> and <code class="docutils literal notranslate"><span class="pre">lead</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">solver</span> <span class="o">=</span> <span class="n">ISLaSolver</span><span class="p">(</span><span class="n">CONFIG_GRAMMAR</span><span class="p">,</span> 
<span class="w">            </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">            forall &lt;int&gt;=&quot;&lt;leaddigit&gt;&lt;digits&gt;&quot; in &lt;start&gt;:</span>
<span class="sd">                (&lt;leaddigit&gt; = &quot;9&quot;)</span>
<span class="sd">            &#39;&#39;&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">solver</span><span class="o">.</span><span class="n">solve</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>pagesize=9
bufsize=941890257631
</pre></div>
</div>
</div>
</div>
<p>Furthermore, using implicit universal quantification and the dot notation introduced earlier, we could write, for instance</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">solver</span> <span class="o">=</span> <span class="n">ISLaSolver</span><span class="p">(</span><span class="n">CONFIG_GRAMMAR</span><span class="p">,</span> 
<span class="w">            </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">            &lt;int&gt;.&lt;leaddigit&gt; = &quot;9&quot;</span>
<span class="sd">            &#39;&#39;&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">solver</span><span class="o">.</span><span class="n">solve</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>pagesize=99
bufsize=9501387624
</pre></div>
</div>
</div>
</div>
<p>or just</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">solver</span> <span class="o">=</span> <span class="n">ISLaSolver</span><span class="p">(</span><span class="n">CONFIG_GRAMMAR</span><span class="p">,</span> 
<span class="w">            </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">            &lt;leaddigit&gt; = &quot;9&quot;</span>
<span class="sd">            &#39;&#39;&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">solver</span><span class="o">.</span><span class="n">solve</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>pagesize=98
bufsize=93762401955
</pre></div>
</div>
</div>
</div>
<p>and obtain the same result (not necessarily the exact same values, though, due to randomness):</p>
<p>But while universal quantification and dot notation are sufficient for many cases, the pattern matching notation is more general and more flexible – even if it may be harder to read.</p>
</section>
<section id="checking-strings">
<h2>Checking Strings<a class="headerlink" href="#checking-strings" title="Link to this heading">#</a></h2>
<p>Using an <code class="docutils literal notranslate"><span class="pre">ISLaSolver</span></code>, we can also check if an string satisfies the constraints.
This can be applied to inputs, but also to <em>outputs</em>; ISLa constraints can thus server as <em>oracles</em> – that is, <em>predicates</em> that check a test result.</p>
<p>Let us check if in a given string, <code class="docutils literal notranslate"><span class="pre">&lt;pagesize&gt;</span></code> and <code class="docutils literal notranslate"><span class="pre">&lt;bufsize&gt;</span></code> are the same.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">constraint</span> <span class="o">=</span> <span class="s1">&#39;&lt;pagesize&gt; = &lt;bufsize&gt;&#39;</span>
<span class="n">solver</span> <span class="o">=</span> <span class="n">ISLaSolver</span><span class="p">(</span><span class="n">CONFIG_GRAMMAR</span><span class="p">,</span> <span class="n">constraint</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>To check the tree, we can pass it into the <code class="docutils literal notranslate"><span class="pre">evaluate()</span></code> method of the <code class="docutils literal notranslate"><span class="pre">solver</span></code> – and find that the given input does <em>not</em> satisfy our constraint.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">solver</span><span class="o">.</span><span class="n">check</span><span class="p">(</span><span class="s1">&#39;pagesize=12</span><span class="se">\n</span><span class="s1">bufsize=34&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>False
</pre></div>
</div>
</div>
</div>
<p>If we repeat the above, however, with an input that satisfies the constraint, we obtain a <code class="docutils literal notranslate"><span class="pre">True</span></code> result.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">solver</span><span class="o">.</span><span class="n">check</span><span class="p">(</span><span class="s1">&#39;pagesize=27</span><span class="se">\n</span><span class="s1">bufsize=27&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True
</pre></div>
</div>
</div>
</div>
<p>Checking constraints is much more efficient than solving them, as ISLa does not have to search for possible solutions.</p>
</section>
<section id="case-studies">
<h2>Case Studies<a class="headerlink" href="#case-studies" title="Link to this heading">#</a></h2>
<p>Let us further illustrate ISLa using a few case studies.</p>
<section id="matching-identifiers-in-xml">
<h3>Matching Identifiers in XML<a class="headerlink" href="#matching-identifiers-in-xml" title="Link to this heading">#</a></h3>
<p>The Extensible Markup Language (XML) is a typical example of an input language that cannot be fully expressed using a context-free grammar.
The problem is not so much expressing the <em>syntax</em> of XML – the basics are fairly easy:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">XML_GRAMMAR</span><span class="p">:</span> <span class="n">Grammar</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;&lt;start&gt;&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;&lt;xml-tree&gt;&quot;</span><span class="p">],</span>
    <span class="s2">&quot;&lt;xml-tree&gt;&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;&lt;open-tag&gt;&lt;xml-content&gt;&lt;close-tag&gt;&quot;</span><span class="p">],</span>
    <span class="s2">&quot;&lt;open-tag&gt;&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;&lt;&lt;id&gt;&gt;&quot;</span><span class="p">],</span>
    <span class="s2">&quot;&lt;close-tag&gt;&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;&lt;/&lt;id&gt;&gt;&quot;</span><span class="p">],</span>
    <span class="s2">&quot;&lt;xml-content&gt;&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Text&quot;</span><span class="p">,</span> <span class="s2">&quot;&lt;xml-tree&gt;&quot;</span><span class="p">],</span>
    <span class="s2">&quot;&lt;id&gt;&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;&lt;letter&gt;&quot;</span><span class="p">,</span> <span class="s2">&quot;&lt;id&gt;&lt;letter&gt;&quot;</span><span class="p">],</span>
    <span class="s2">&quot;&lt;letter&gt;&quot;</span><span class="p">:</span> <span class="n">crange</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;z&#39;</span><span class="p">)</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">assert</span> <span class="n">is_valid_grammar</span><span class="p">(</span><span class="n">XML_GRAMMAR</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>start
</pre></div>
</div>
<img alt="_images/5b7d759262c4437ff6d0161fa315b7c4d151dabf198ada47d091d0e6bc586630.svg" src="_images/5b7d759262c4437ff6d0161fa315b7c4d151dabf198ada47d091d0e6bc586630.svg" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>xml-tree
</pre></div>
</div>
<img alt="_images/a773a5d3e673627b4640f722edf07028e1bd25fe5e3cebddfd92fb052d3bc353.svg" src="_images/a773a5d3e673627b4640f722edf07028e1bd25fe5e3cebddfd92fb052d3bc353.svg" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>open-tag
</pre></div>
</div>
<img alt="_images/d40519ec9b6accbcf0dd7e3e3230bc0e83215eb707f6cc1c303f4bb2c65aeb41.svg" src="_images/d40519ec9b6accbcf0dd7e3e3230bc0e83215eb707f6cc1c303f4bb2c65aeb41.svg" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>close-tag
</pre></div>
</div>
<img alt="_images/cb066bf516e0090fca2f0459495fd11893cc0c367a4fdd84adc4fbe26adb5021.svg" src="_images/cb066bf516e0090fca2f0459495fd11893cc0c367a4fdd84adc4fbe26adb5021.svg" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>xml-content
</pre></div>
</div>
<img alt="_images/b31bb257d0cd91e858b8eae9b33e3b03ff2f999ac24715414a8a5926364072b9.svg" src="_images/b31bb257d0cd91e858b8eae9b33e3b03ff2f999ac24715414a8a5926364072b9.svg" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>id
</pre></div>
</div>
<img alt="_images/d4617b602632b9338458f00a7f91d72b893443cb0607439184f57d3f66cab7fd.svg" src="_images/d4617b602632b9338458f00a7f91d72b893443cb0607439184f57d3f66cab7fd.svg" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>letter
</pre></div>
</div>
<img alt="_images/4b1a56d3769c6506074b2c657289f0eadbb830f6117ad252a549d312c4a86b82.svg" src="_images/4b1a56d3769c6506074b2c657289f0eadbb830f6117ad252a549d312c4a86b82.svg" />
</div>
</div>
<p>The problem becomes evident when we produce inputs from the grammar: The <code class="docutils literal notranslate"><span class="pre">&lt;id&gt;</span></code> elements in <code class="docutils literal notranslate"><span class="pre">&lt;open-tag&gt;</span></code> and <code class="docutils literal notranslate"><span class="pre">&lt;close-tag&gt;</span></code> do not match.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fuzzer</span> <span class="o">=</span> <span class="n">GrammarFuzzer</span><span class="p">(</span><span class="n">XML_GRAMMAR</span><span class="p">)</span>
<span class="n">fuzzer</span><span class="o">.</span><span class="n">fuzz</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;&lt;xdps&gt;&lt;s&gt;&lt;x&gt;&lt;f&gt;Text&lt;/g&gt;&lt;/ka&gt;&lt;/k&gt;&lt;/hk&gt;&#39;
</pre></div>
</div>
</div>
</div>
<p>If we want the tag IDs to match, we need to come up with a <em>finite</em> set of tags (as in, say, HTML); then we can extend the grammar with one rule for each tag - <code class="docutils literal notranslate"><span class="pre">&lt;body&gt;...&lt;/body&gt;</span></code>, <code class="docutils literal notranslate"><span class="pre">&lt;p&gt;...&lt;/p&gt;</span></code>, <code class="docutils literal notranslate"><span class="pre">&lt;strong&gt;...&lt;/strong&gt;</span></code>, and so on.
For an <em>infinite</em> set of tags, though, as in our grammar, expressing that the two tag IDs must match is not possible in a context-free grammar.</p>
<p>With ISLa, however, constraining the grammar is easy.
All we need is the rule that constrains the <code class="docutils literal notranslate"><span class="pre">&lt;xml-tree&gt;</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">solver</span> <span class="o">=</span> <span class="n">ISLaSolver</span><span class="p">(</span><span class="n">XML_GRAMMAR</span><span class="p">,</span> 
<span class="w">            </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">            &lt;xml-tree&gt;.&lt;open-tag&gt;.&lt;id&gt; = &lt;xml-tree&gt;.&lt;close-tag&gt;.&lt;id&gt;</span>
<span class="sd">            &#39;&#39;&#39;</span><span class="p">,</span> <span class="n">max_number_smt_instantiations</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">solver</span><span class="o">.</span><span class="n">solve</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;p&gt;Text&lt;/p&gt;
&lt;p&gt;&lt;p&gt;Text&lt;/p&gt;&lt;/p&gt;
&lt;p&gt;&lt;p&gt;&lt;p&gt;Text&lt;/p&gt;&lt;/p&gt;&lt;/p&gt;
</pre></div>
</div>
</div>
</div>
<p>and we see that the <code class="docutils literal notranslate"><span class="pre">&lt;id&gt;</span></code> tags now indeed match each other.</p>
</section>
<section id="excursion-solver-configuration-parameters">
<h3>Excursion: Solver Configuration Parameters<a class="headerlink" href="#excursion-solver-configuration-parameters" title="Link to this heading">#</a></h3>
<p>The configuration parameter <code class="docutils literal notranslate"><span class="pre">max_number_smt_instantiations</span></code> we passed to the <code class="docutils literal notranslate"><span class="pre">ISLaSolver</span></code> object above limits the number of calls to ISLa’s underlying SMT solver. Generally, higher numbers lead to more inputs generated per time. Many of those will look structurally similar, though. If we aim for structurally diverse inputs and do not care about, e.g., the names of tags, it can make sense to choose a lower value for this parameter. This is what happens with <code class="docutils literal notranslate"><span class="pre">max_number_smt_instantiations=10</span></code>, which is the current default:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">solver</span> <span class="o">=</span> <span class="n">ISLaSolver</span><span class="p">(</span><span class="n">XML_GRAMMAR</span><span class="p">,</span> 
<span class="w">            </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">            &lt;xml-tree&gt;.&lt;open-tag&gt;.&lt;id&gt; = &lt;xml-tree&gt;.&lt;close-tag&gt;.&lt;id&gt;</span>
<span class="sd">            &#39;&#39;&#39;</span><span class="p">,</span> <span class="n">max_number_smt_instantiations</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

<span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">solver</span><span class="o">.</span><span class="n">solve</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;p&gt;Text&lt;/p&gt;
&lt;h&gt;Text&lt;/h&gt;
&lt;k&gt;Text&lt;/k&gt;
</pre></div>
</div>
</div>
</div>
<p>The parameter <code class="docutils literal notranslate"><span class="pre">max_number_free_instantiations</span></code> serves a similar purpose: ISla randomly instantiates nonterminal symbols whose values are not restricted by a constraint. It chooses—surprise!—at most <code class="docutils literal notranslate"><span class="pre">max_number_free_instantiations</span></code> such random instantiations.</p>
<p>Other configuration parameters of interest are <code class="docutils literal notranslate"><span class="pre">structural_predicates</span></code> and <code class="docutils literal notranslate"><span class="pre">semantic_predicates</span></code>, which let you extend the ISLa language by passing custom structural and semantic predicates to the solver. You can use all the predicates in these sets inside the ISLa constraint to solve. Per default, the semantic predicate <code class="docutils literal notranslate"><span class="pre">count(in_tree,</span> <span class="pre">NEEDLE,</span> <span class="pre">NUM)</span></code> and the following structural predicates are available:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">after(node_1,</span> <span class="pre">node_2)</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">before(node_1,</span> <span class="pre">node_2)</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">consecutive(node_1,</span> <span class="pre">node_2)</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">count(in_tree,</span> <span class="pre">NEEDLE,</span> <span class="pre">NUM)</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">different_position(node_1,</span> <span class="pre">node_2)</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">direct_child(node_1,</span> <span class="pre">node_2)</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">inside(node_1,</span> <span class="pre">node_2)</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">level(PRED,</span> <span class="pre">NONTERMINAL,</span> <span class="pre">node_1,</span> <span class="pre">node_2)</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">nth(N,</span> <span class="pre">node_1,</span> <span class="pre">node_2)</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">same_position(node_1,</span> <span class="pre">node_2)</span></code></p></li>
</ul>
</section>
<section id="id3">
<h3>End of Excursion<a class="headerlink" href="#id3" title="Link to this heading">#</a></h3>
<p>In contrast to the “input generator” solution in the <a class="reference internal" href="GeneratorGrammarFuzzer.html"><span class="doc std std-doc">chapter on generators</span></a>, our constraint-based solution is purely declarative - and can also be used to parse and check inputs.
Plus, of course, we can easily add more constraints:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">solver</span> <span class="o">=</span> <span class="n">ISLaSolver</span><span class="p">(</span><span class="n">XML_GRAMMAR</span><span class="p">,</span> 
<span class="w">            </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">            &lt;xml-tree&gt;.&lt;open-tag&gt;.&lt;id&gt; = &lt;xml-tree&gt;.&lt;close-tag&gt;.&lt;id&gt;</span>
<span class="sd">            and</span>
<span class="sd">            str.len(&lt;id&gt;) &gt; 10</span>
<span class="sd">            &#39;&#39;&#39;</span><span class="p">,</span> <span class="n">max_number_smt_instantiations</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">solver</span><span class="o">.</span><span class="n">solve</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;ppnxhklftkp&gt;Text&lt;/ppnxhklftkp&gt;
&lt;ppnxhklftkp&gt;&lt;ppnpqcqktln&gt;Text&lt;/ppnpqcqktln&gt;&lt;/ppnxhklftkp&gt;
&lt;ppnxhklftkp&gt;&lt;ppnpqcqktln&gt;&lt;ppkxskxnyhk&gt;Text&lt;/ppkxskxnyhk&gt;&lt;/ppnpqcqktln&gt;&lt;/ppnxhklftkp&gt;
</pre></div>
</div>
</div>
</div>
</section>
<section id="definitions-and-usages-in-programming-languages">
<h3>Definitions and Usages in Programming Languages<a class="headerlink" href="#definitions-and-usages-in-programming-languages" title="Link to this heading">#</a></h3>
<p>When testing compilers with generated program code, one often encounters the problem that before <em>using</em> an identifier, one has to <em>declare</em> it first - specifying its type, some initial value, and more.</p>
<p>This problem is easily illustrated in the following grammar, which produces <em>sequences of assignments</em>.
Variable names consist of a single lowercase letter; values can only be digits; assignments are separated by semicolons.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">LANG_GRAMMAR</span><span class="p">:</span> <span class="n">Grammar</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;&lt;start&gt;&quot;</span><span class="p">:</span>
        <span class="p">[</span><span class="s2">&quot;&lt;stmt&gt;&quot;</span><span class="p">],</span>
    <span class="s2">&quot;&lt;stmt&gt;&quot;</span><span class="p">:</span>
        <span class="p">[</span><span class="s2">&quot;&lt;assgn&gt;&quot;</span><span class="p">,</span> <span class="s2">&quot;&lt;assgn&gt;; &lt;stmt&gt;&quot;</span><span class="p">],</span>
    <span class="s2">&quot;&lt;assgn&gt;&quot;</span><span class="p">:</span>
        <span class="p">[</span><span class="s2">&quot;&lt;lhs&gt; := &lt;rhs&gt;&quot;</span><span class="p">],</span>
    <span class="s2">&quot;&lt;lhs&gt;&quot;</span><span class="p">:</span>
        <span class="p">[</span><span class="s2">&quot;&lt;var&gt;&quot;</span><span class="p">],</span>
    <span class="s2">&quot;&lt;rhs&gt;&quot;</span><span class="p">:</span>
        <span class="p">[</span><span class="s2">&quot;&lt;var&gt;&quot;</span><span class="p">,</span> <span class="s2">&quot;&lt;digit&gt;&quot;</span><span class="p">],</span>
    <span class="s2">&quot;&lt;var&gt;&quot;</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="n">string</span><span class="o">.</span><span class="n">ascii_lowercase</span><span class="p">),</span>
    <span class="s2">&quot;&lt;digit&gt;&quot;</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="n">string</span><span class="o">.</span><span class="n">digits</span><span class="p">)</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">assert</span> <span class="n">is_valid_grammar</span><span class="p">(</span><span class="n">LANG_GRAMMAR</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">syntax_diagram</span><span class="p">(</span><span class="n">LANG_GRAMMAR</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>start
</pre></div>
</div>
<img alt="_images/275c050e7f5035620c0c10319a40c3bbd1b3ea481ea7514855750b65f9ae3035.svg" src="_images/275c050e7f5035620c0c10319a40c3bbd1b3ea481ea7514855750b65f9ae3035.svg" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>stmt
</pre></div>
</div>
<img alt="_images/dcd2226c6632cca1706527b6219afa071774a7758be7eed3d2fffe5f1fe9e03a.svg" src="_images/dcd2226c6632cca1706527b6219afa071774a7758be7eed3d2fffe5f1fe9e03a.svg" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>assgn
</pre></div>
</div>
<img alt="_images/7a3f1e08e4eb054e90c602c06ff19b72a444e9043fd48ff2666ee82d7dc8dbdd.svg" src="_images/7a3f1e08e4eb054e90c602c06ff19b72a444e9043fd48ff2666ee82d7dc8dbdd.svg" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>lhs
</pre></div>
</div>
<img alt="_images/188fff6953684058a46f3b035e01331a030cf311dba7ef26735c0f781e285f2d.svg" src="_images/188fff6953684058a46f3b035e01331a030cf311dba7ef26735c0f781e285f2d.svg" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>rhs
</pre></div>
</div>
<img alt="_images/4f7f31628b194b788afc3d867102e96bca8e7406032c68dd7378d3451c0d127c.svg" src="_images/4f7f31628b194b788afc3d867102e96bca8e7406032c68dd7378d3451c0d127c.svg" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>var
</pre></div>
</div>
<img alt="_images/4b1a56d3769c6506074b2c657289f0eadbb830f6117ad252a549d312c4a86b82.svg" src="_images/4b1a56d3769c6506074b2c657289f0eadbb830f6117ad252a549d312c4a86b82.svg" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>digit
</pre></div>
</div>
<img alt="_images/831527e2b2231b00574fb7a68ba1dce71a738444df89dc5f1c870b2354eef828.svg" src="_images/831527e2b2231b00574fb7a68ba1dce71a738444df89dc5f1c870b2354eef828.svg" />
</div>
</div>
<p>Here are some assignment sequences produced by the grammar:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fuzzer</span> <span class="o">=</span> <span class="n">GrammarFuzzer</span><span class="p">(</span><span class="n">LANG_GRAMMAR</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">fuzzer</span><span class="o">.</span><span class="n">fuzz</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>w := 7; g := 2
f := m; x := 3
p := 3
h := f; h := u
n := k; k := z; z := 6
m := x; g := h
d := 3
h := 6
s := m
k := q
</pre></div>
</div>
</div>
</div>
<p>We see that the assignment <em>syntax</em> is similar to what we have in common programming languages.
The <em>semantics</em>, however, are, well, questionable, as we commonly access variables whose values have not been previously defined.
Again, this is a <em>semantic</em> property that cannot be expressed in a context-free grammar alone.</p>
<p>What we need here is a constraint specifying that on the right-hand side of an assignment, we can only have variable names that occur on the left-hand side.
In ISLa, we achieve this through the following constraint:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">solver</span> <span class="o">=</span> <span class="n">ISLaSolver</span><span class="p">(</span><span class="n">LANG_GRAMMAR</span><span class="p">,</span> 
<span class="w">            </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">            forall &lt;rhs&gt; in &lt;assgn&gt;:</span>
<span class="sd">                exists &lt;assgn&gt; declaration:</span>
<span class="sd">                    &lt;rhs&gt;.&lt;var&gt; = declaration.&lt;lhs&gt;.&lt;var&gt;</span>
<span class="sd">            &#39;&#39;&#39;</span><span class="p">,</span>
            <span class="n">max_number_smt_instantiations</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
            <span class="n">max_number_free_instantiations</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">solver</span><span class="o">.</span><span class="n">solve</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>y := 1
a := 0; t := 5
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>p := p
u := 2; k := 4; o := 7
p := 3; r := 8; v := p
x := 9; b := 6; d := d
w := 4; h := 4; g := h
c := 5; p := p; m := 5
n := 8; s := p; p := 2
d := 0; j := d; l := 9
</pre></div>
</div>
</div>
</div>
<p>This is much better already, but not perfect yet - we might still have assignments like <code class="docutils literal notranslate"><span class="pre">a</span> <span class="pre">:=</span> <span class="pre">a</span></code> or <code class="docutils literal notranslate"><span class="pre">a</span> <span class="pre">:=</span> <span class="pre">b;</span> <span class="pre">b</span> <span class="pre">:=</span> <span class="pre">5</span></code>.
That is because our constraints do not yet take care of <em>ordering</em> – in a <code class="docutils literal notranslate"><span class="pre">&lt;rhs&gt;</span></code> element, we can only use variables that are defined earlier.</p>
<p>For this purpose, ISLa provides a <code class="docutils literal notranslate"><span class="pre">before()</span></code> predicate: <code class="docutils literal notranslate"><span class="pre">before(A,</span> <span class="pre">B)</span></code> expresses that the element <code class="docutils literal notranslate"><span class="pre">A</span></code> must occur before the element <code class="docutils literal notranslate"><span class="pre">B</span></code>.
With <code class="docutils literal notranslate"><span class="pre">before()</span></code>, we can rewrite our constraint as</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">solver</span> <span class="o">=</span> <span class="n">ISLaSolver</span><span class="p">(</span><span class="n">LANG_GRAMMAR</span><span class="p">,</span> 
<span class="w">            </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">            forall &lt;rhs&gt; in &lt;assgn&gt;:</span>
<span class="sd">                exists &lt;assgn&gt; declaration:</span>
<span class="sd">                    (before(declaration, &lt;assgn&gt;) and</span>
<span class="sd">                     &lt;rhs&gt;.&lt;var&gt; = declaration.&lt;lhs&gt;.&lt;var&gt;)</span>
<span class="sd">            &#39;&#39;&#39;</span><span class="p">,</span>
            <span class="n">max_number_free_instantiations</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
            <span class="n">max_number_smt_instantiations</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>… and thus ensure that on the right-hand-side of assignments, we only use identifiers defined earlier.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">solver</span><span class="o">.</span><span class="n">solve</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>p := 1
w := 4; o := 6
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>b := 3; p := b; d := p; f := d
b := 0; d := b; h := d; e := 8
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>p := 9; p := p; z := 2; a := p
p := 7; p := p; p := 5; g := p
b := 4; c := b; p := 9; y := p
b := 2; p := b; p := 0; s := p
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>b := 9; b := 5; p := b; d := p; k := d
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>b := 9; b := b; p := b; d := p; i := d
</pre></div>
</div>
</div>
</div>
<p>In case you find that the assignment sequences are too short, you can use the ISLa <code class="docutils literal notranslate"><span class="pre">count()</span></code> predicate.
<code class="docutils literal notranslate"><span class="pre">count(VARIABLE,</span> <span class="pre">NONTERMINAL,</span> <span class="pre">N)</span></code> ensures that the number of NONTERMINALs in VARIABLE is exactly N.
To have statements with exactly 5 assignments, write</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">solver</span> <span class="o">=</span> <span class="n">ISLaSolver</span><span class="p">(</span><span class="n">LANG_GRAMMAR</span><span class="p">,</span> 
<span class="w">            </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">            forall &lt;rhs&gt; in &lt;assgn&gt;:</span>
<span class="sd">                exists &lt;assgn&gt; declaration:</span>
<span class="sd">                    (before(declaration, &lt;assgn&gt;) and</span>
<span class="sd">                     &lt;rhs&gt;.&lt;var&gt; = declaration.&lt;lhs&gt;.&lt;var&gt;)</span>
<span class="sd">            and</span>
<span class="sd">            count(start, &quot;&lt;assgn&gt;&quot;, &quot;5&quot;)</span>
<span class="sd">            &#39;&#39;&#39;</span><span class="p">,</span> 
            <span class="n">max_number_smt_instantiations</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
            <span class="n">max_number_free_instantiations</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">solver</span><span class="o">.</span><span class="n">solve</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>d := 8; y := d; c := 3; f := 9; a := 0
h := 2; k := h; h := 4; g := 7; o := h
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>h := 1; r := h; n := 6; h := 5; u := h
h := 3; p := h; x := 5; w := 0; e := p
p := 2; s := p; m := 5; q := 0; v := p
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>p := 8; l := p; i := p; t := 3; b := 9
d := 9; p := d; z := p; j := 3; n := 2
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>p := 8; d := p; p := d; q := 2; i := p
a := 5; g := a; p := a; q := 1; b := p
p := 4; d := p; l := d; d := 5; v := d
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="lessons-learned">
<h2>Lessons Learned<a class="headerlink" href="#lessons-learned" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Using ISLa, we can add and solve <em>constraints</em> to grammars, allowing to express <em>semantic properties</em> of our test inputs</p></li>
<li><p>Declaring constraints (and have a solver solve them) is much more versatile than adding generator code, and language-independent, too</p></li>
<li><p>Using ISLa is fun :-)</p></li>
</ul>
</section>
<section id="next-steps">
<h2>Next Steps<a class="headerlink" href="#next-steps" title="Link to this heading">#</a></h2>
<p>In the next chapters, we will continue to focus on semantics.
Among others, we will learn how to</p>
<ul class="simple">
<li><p><a class="reference internal" href="GrammarMiner.html"><span class="std std-doc">mine grammars from existing inputs</span></a></p></li>
<li><p>use <a class="reference internal" href="SymbolicFuzzer.html"><span class="std std-doc">symbolic fuzzing</span></a> - that is, using constraint solvers to reach particular locations</p></li>
<li><p>use <a class="reference internal" href="ConcolicFuzzer.html"><span class="std std-doc">concolic fuzzing</span></a> - that is, combining symbolic fuzzing with concrete runs for higher efficiency</p></li>
</ul>
</section>
<section id="background">
<h2>Background<a class="headerlink" href="#background" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>ISLa is presented in the paper <a class="reference external" href="https://publications.cispa.saarland/3596/">“Input Invariants”</a> at ESEC/FSE 2022.</p></li>
<li><p>The <a class="reference external" href="https://github.com/rindPHI/isla">ISLa project</a> contains the full source code and a complete reference.</p></li>
</ul>
</section>
<section id="exercises">
<h2>Exercises<a class="headerlink" href="#exercises" title="Link to this heading">#</a></h2>
<section id="exercise-1-string-encodings">
<h3>Exercise 1: String Encodings<a class="headerlink" href="#exercise-1-string-encodings" title="Link to this heading">#</a></h3>
<p>A common way of representing strings is <em>length-prefixed strings</em>, a representation made popular by the <em>PASCAL</em> programming language.
A length-prefixed string starts with a few bytes that encode the length <span class="math notranslate nohighlight">\(L\)</span> of the string, followed by the <span class="math notranslate nohighlight">\(L\)</span> actual characters.
For instance, assuming that two bytes are used to encode the length, the string <code class="docutils literal notranslate"><span class="pre">&quot;Hello&quot;</span></code> could be represented as the sequence</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mh">0x00</span> <span class="mh">0x05</span> <span class="s1">&#39;H&#39;</span> <span class="s1">&#39;e&#39;</span> <span class="s1">&#39;l&#39;</span> <span class="s1">&#39;l&#39;</span> <span class="s1">&#39;o&#39;</span>
</pre></div>
</div>
<section id="part-1-syntax">
<h4>Part 1: Syntax<a class="headerlink" href="#part-1-syntax" title="Link to this heading">#</a></h4>
<p>Write a grammar that defines the syntax of length-prefixed strings.</p>
<p><strong>Solution.</strong> This is actually pretty easy:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">string</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">PASCAL_STRING_GRAMMAR</span><span class="p">:</span> <span class="n">Grammar</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;&lt;start&gt;&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;&lt;string&gt;&quot;</span><span class="p">],</span>
    <span class="s2">&quot;&lt;string&gt;&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;&lt;length&gt;&lt;chars&gt;&quot;</span><span class="p">],</span>
    <span class="s2">&quot;&lt;length&gt;&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;&lt;byte&gt;&quot;</span><span class="p">],</span>
    <span class="s2">&quot;&lt;byte&gt;&quot;</span><span class="p">:</span> <span class="n">crange</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\x00</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\xff</span><span class="s1">&#39;</span><span class="p">),</span>
    <span class="s2">&quot;&lt;chars&gt;&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;&lt;char&gt;&lt;chars&gt;&quot;</span><span class="p">],</span>
    <span class="s2">&quot;&lt;char&gt;&quot;</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="n">string</span><span class="o">.</span><span class="n">printable</span><span class="p">),</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">assert</span> <span class="n">is_valid_grammar</span><span class="p">(</span><span class="n">PASCAL_STRING_GRAMMAR</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fuzzer</span> <span class="o">=</span> <span class="n">GrammarFuzzer</span><span class="p">(</span><span class="n">PASCAL_STRING_GRAMMAR</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">fuzzer</span><span class="o">.</span><span class="n">fuzz</span><span class="p">()))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;ö&#39;
&#39;\x9b&#39;
&#39;Ë&#39;
&#39;J&#39;
&#39;hE&#39;
&#39;è&#39;
&#39;È&#39;
&#39;ÝW&#39;
&#39;Õ]&#39;
&#39;\x1aI&#39;
</pre></div>
</div>
</div>
</div>
</section>
<section id="part-2-semantics">
<h4>Part 2: Semantics<a class="headerlink" href="#part-2-semantics" title="Link to this heading">#</a></h4>
<p>Use ISLa to produce valid length-prefixed strings.
Make use of the <a class="reference external" href="https://smtlib.cs.uiowa.edu/theories-UnicodeStrings.shtml">SMT-LIB string library</a> to find appropriate conversion functions.</p>
<p><strong>Solution.</strong>
The function we need is <code class="docutils literal notranslate"><span class="pre">str.to_code(c)</span></code> to convert a single character to its ordinal value (e.g. <code class="docutils literal notranslate"><span class="pre">str.to_code('0x03')</span> <span class="pre">=</span> <span class="pre">3</span></code>).
With this, we can formulate an appropriate constraint:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">solver</span> <span class="o">=</span> <span class="n">ISLaSolver</span><span class="p">(</span><span class="n">PASCAL_STRING_GRAMMAR</span><span class="p">,</span> 
<span class="w">            </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">            str.to_code(&lt;string&gt;.&lt;length&gt;.&lt;byte&gt;) =</span>
<span class="sd">            str.len(&lt;string&gt;.&lt;chars&gt;)</span>
<span class="sd">            &#39;&#39;&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
    <span class="c1"># Get the solution</span>
    <span class="n">solution</span> <span class="o">=</span> <span class="n">solver</span><span class="o">.</span><span class="n">solve</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Solution: </span><span class="si">{</span><span class="nb">repr</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">solution</span><span class="p">))</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span>

    <span class="c1"># Print statistics</span>
    <span class="n">low_byte</span> <span class="o">=</span> <span class="n">solution</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">n</span><span class="p">:</span> <span class="n">n</span><span class="o">.</span><span class="n">value</span> <span class="o">==</span> <span class="s2">&quot;&lt;length&gt;&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">chars</span> <span class="o">=</span> <span class="n">solution</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">n</span><span class="p">:</span> <span class="n">n</span><span class="o">.</span><span class="n">value</span> <span class="o">==</span> <span class="s2">&quot;&lt;chars&gt;&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;(&lt;length&gt; = </span><span class="si">{</span><span class="nb">ord</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">low_byte</span><span class="p">))</span><span class="si">}</span><span class="s1">, len(&lt;chars&gt;) = </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">chars</span><span class="p">))</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Solution: &#39;\x01H&#39; (&lt;length&gt; = 1, len(&lt;chars&gt;) = 1)

Solution: &#39;\x01#&#39; (&lt;length&gt; = 1, len(&lt;chars&gt;) = 1)

Solution: &#39;\x01D&#39; (&lt;length&gt; = 1, len(&lt;chars&gt;) = 1)

Solution: &#39;\x01A&#39; (&lt;length&gt; = 1, len(&lt;chars&gt;) = 1)

Solution: &#39;\x01@&#39; (&lt;length&gt; = 1, len(&lt;chars&gt;) = 1)

Solution: &#39;\x01O&#39; (&lt;length&gt; = 1, len(&lt;chars&gt;) = 1)

Solution: &#39;\x01I&#39; (&lt;length&gt; = 1, len(&lt;chars&gt;) = 1)

Solution: &#39;\x01C&#39; (&lt;length&gt; = 1, len(&lt;chars&gt;) = 1)

Solution: &#39;\x01E&#39; (&lt;length&gt; = 1, len(&lt;chars&gt;) = 1)

Solution: &#39;\x01L&#39; (&lt;length&gt; = 1, len(&lt;chars&gt;) = 1)
</pre></div>
</div>
</div>
</div>
<div class="cell tag_remove-input docutils container">
</div>
</section>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="Reducer.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Reducing Failure-Inducing Inputs</p>
      </div>
    </a>
    <a class="right-next"
       href="GrammarMiner.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Mining Input Grammars</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#synopsis">Synopsis</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#semantic-input-properties">Semantic Input Properties</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#excursion-unrestricted-grammars">Excursion: Unrestricted Grammars</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#end-of-excursion">End of Excursion</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#specifying-constraints">Specifying Constraints</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#excursion-derivation-trees">Excursion: Derivation Trees</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">End of Excursion</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#excursion-using-smt-lib-syntax">Excursion: Using SMT-LIB Syntax</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">End of Excursion</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#isla-on-the-command-line">ISLa on the Command Line</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#accessing-elements">Accessing Elements</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quantifiers">Quantifiers</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#picking-expansions">Picking Expansions</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#matching-expansion-elements">Matching Expansion Elements</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#checking-strings">Checking Strings</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#case-studies">Case Studies</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#matching-identifiers-in-xml">Matching Identifiers in XML</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#excursion-solver-configuration-parameters">Excursion: Solver Configuration Parameters</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">End of Excursion</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#definitions-and-usages-in-programming-languages">Definitions and Usages in Programming Languages</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#lessons-learned">Lessons Learned</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#next-steps">Next Steps</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#background">Background</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercises">Exercises</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-1-string-encodings">Exercise 1: String Encodings</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#part-1-syntax">Part 1: Syntax</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#part-2-semantics">Part 2: Semantics</a></li>
</ul>
</li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Andreas Zeller, Rahul Gopinath, Marcel Böhme, Gordon Fraser, and Christian Holler
</p>

  </div>
  
  <div class="footer-item">
    

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
<div class="extra_footer">
  <div>
  Copyright &copy; 2021–2025 <a href="https://www.cispa.de/">CISPA Helmholtz Center for Information Security</a>. Copyright &copy; 2018-2020 <a href="https://www.uni-saarland.de/">Saarland University</a>. Copyright &copy; 2018-2025 external contributors.
  The <strong>content</strong> of this project is licensed under the <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/">Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International License</a>.
  The <strong>source code</strong> that is part of the content, as well as the source code used to format and display that content is licensed under the <a href="https://github.com/uds-se/fuzzingbook/blob/master/LICENSE.md#mit-license">MIT License</a>.
  <br>
  <a href="https://cispa.de/en/impressum">Imprint</a> &middot; <a href="/html/index.html#how-do-i-cite-your-work">Cite</a>
</div>

</div>
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>