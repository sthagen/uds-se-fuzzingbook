
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Fuzzing: Breaking Things with Random Inputs &#8212; The Fuzzing Book</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css?v=6644e6bb" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="_static/custom.css?v=42e1b1a5" />
    <link rel="stylesheet" type="text/css" href="_static/mastodon-timeline.css?v=f82c2b23" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'Fuzzer';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Code Coverage" href="Coverage.html" />
    <link rel="prev" title="Introduction to Software Testing" href="Intro_Testing.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>
<aside class="bd-header-announcement" aria-label="Announcement">
  <div class="bd-header-announcement__content"><p>This is a beta version of fuzzingbook.org, currently in development. See the <a href="https://fuzzingbook.org/classic/"  style="color:white!important;">classic site</a> for the 2024 version.</p></div>
</aside>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/fuzzingbook.png" class="logo__image only-light" alt="The Fuzzing Book - Home"/>
    <script>document.write(`<img src="_static/fuzzingbook.png" class="logo__image only-dark" alt="The Fuzzing Book - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="index.html">
                    The Fuzzing Book
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Introduction</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="Tours.html">Sitemap</a></li>
<li class="toctree-l1"><a class="reference internal" href="Intro_Testing.html">Introduction to Software Testing</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Lexical Fuzzing</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Fuzzing: Breaking Things with Random Inputs</a></li>
<li class="toctree-l1"><a class="reference internal" href="Coverage.html">Code Coverage</a></li>
<li class="toctree-l1"><a class="reference internal" href="MutationFuzzer.html">Mutation-Based Fuzzing</a></li>
<li class="toctree-l1"><a class="reference internal" href="GreyboxFuzzer.html">Greybox Fuzzing</a></li>
<li class="toctree-l1"><a class="reference internal" href="SearchBasedFuzzer.html">Search-Based Fuzzing</a></li>
<li class="toctree-l1"><a class="reference internal" href="MutationAnalysis.html">Mutation Analysis</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Syntactical Fuzzing</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="Grammars.html">Fuzzing with Grammars</a></li>
<li class="toctree-l1"><a class="reference internal" href="GrammarFuzzer.html">Efficient Grammar Fuzzing</a></li>
<li class="toctree-l1"><a class="reference internal" href="GrammarCoverageFuzzer.html">Grammar Coverage</a></li>
<li class="toctree-l1"><a class="reference internal" href="Parser.html">Parsing Inputs</a></li>
<li class="toctree-l1"><a class="reference internal" href="ProbabilisticGrammarFuzzer.html">Probabilistic Grammar Fuzzing</a></li>
<li class="toctree-l1"><a class="reference internal" href="GeneratorGrammarFuzzer.html">Fuzzing with Generators</a></li>

<li class="toctree-l1"><a class="reference internal" href="GreyboxGrammarFuzzer.html">Greybox Fuzzing with Grammars</a></li>
<li class="toctree-l1"><a class="reference internal" href="Reducer.html">Reducing Failure-Inducing Inputs</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Semantical Fuzzing</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="FuzzingWithConstraints.html">Fuzzing with Constraints</a></li>
<li class="toctree-l1"><a class="reference internal" href="GrammarMiner.html">Mining Input Grammars</a></li>
<li class="toctree-l1"><a class="reference internal" href="InformationFlow.html">Tracking Information Flow</a></li>
<li class="toctree-l1"><a class="reference internal" href="ConcolicFuzzer.html">Concolic Fuzzing</a></li>
<li class="toctree-l1"><a class="reference internal" href="SymbolicFuzzer.html">Symbolic Fuzzing</a></li>
<li class="toctree-l1"><a class="reference internal" href="DynamicInvariants.html">Mining Function Specifications</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Domain-Specific Fuzzing</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="ConfigurationFuzzer.html">Testing Configurations</a></li>
<li class="toctree-l1"><a class="reference internal" href="APIFuzzer.html">Fuzzing APIs</a></li>
<li class="toctree-l1"><a class="reference internal" href="Carver.html">Carving Unit Tests</a></li>
<li class="toctree-l1"><a class="reference internal" href="PythonFuzzer.html">Testing Compilers</a></li>
<li class="toctree-l1"><a class="reference internal" href="WebFuzzer.html">Testing Web Applications</a></li>
<li class="toctree-l1"><a class="reference internal" href="GUIFuzzer.html">Testing Graphical User Interfaces</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Managing Fuzzing</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="FuzzingInTheLarge.html">Fuzzing in the Large</a></li>
<li class="toctree-l1"><a class="reference internal" href="WhenToStopFuzzing.html">When To Stop Fuzzing</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Essays</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="AcademicPrototyping.html">Academic Prototyping</a></li>
<li class="toctree-l1"><a class="reference internal" href="PrototypingWithPython.html">Prototyping with Python</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Appendices</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="ExpectError.html">Error Handling</a></li>
<li class="toctree-l1"><a class="reference internal" href="Timer.html">Timer</a></li>
<li class="toctree-l1"><a class="reference internal" href="Timeout.html">Timeout</a></li>
<li class="toctree-l1"><a class="reference internal" href="ClassDiagram.html">Class Diagrams</a></li>
<li class="toctree-l1"><a class="reference internal" href="RailroadDiagrams.html">Railroad Diagrams</a></li>
<li class="toctree-l1"><a class="reference internal" href="ControlFlow.html">Control Flow Graph</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">About This Book</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="ReleaseNotes.html">Fuzzingbook Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="Importing.html">Downloads and Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="Copyright.html">Copyright</a></li>
<li class="toctree-l1"><a class="reference internal" href="Guide_for_Authors.html">Guide for Authors</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://mybinder.org/v2/gh/uds-se/fuzzingbook/master?urlpath=tree/docs/notebooks/Fuzzer.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch on Binder"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img alt="Binder logo" src="_static/images/logo_binder.svg">
  </span>
<span class="btn__text-container">Binder</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/uds-se/fuzzingbook" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/uds-se/fuzzingbook/issues/new?title=Issue%20on%20page%20%2FFuzzer.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
    <li><a href="../code/Fuzzer.py" target="_blank"
       class="btn btn-sm btn-download-source-button dropdown-item"
       title="Download Python code"
       data-bs-placement="left" data-bs-toggle="tooltip"
    >
  

    <span class="btn__icon-container">
      <i class="fas fa-file"></i>
      </span>
    <span class="btn__text-container">.py</span>
    </a>
    </li>
    
      
      
      
      <li><a href="_sources/Fuzzer.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download notebook"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  
    <li><a href="Importing.html" target="_blank"
       class="btn btn-sm btn-download-source-button dropdown-item"
       title="All downloads"
       data-bs-placement="left" data-bs-toggle="tooltip"
    >
  

    <span class="btn__icon-container">
      <i class="fas fa-file"></i>
      </span>
    <span class="btn__text-container">All downloads</span>
    </a>
    </li>
    </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Fuzzing: Breaking Things with Random Inputs</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#synopsis">Synopsis</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#fuzzers">Fuzzers</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#runners">Runners</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#a-testing-assignment">A Testing Assignment</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#a-simple-fuzzer">A Simple Fuzzer</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#fuzzing-external-programs">Fuzzing External Programs</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#creating-input-files">Creating Input Files</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#invoking-external-programs">Invoking External Programs</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#long-running-fuzzing">Long-Running Fuzzing</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#bugs-fuzzers-find">Bugs Fuzzers Find</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#buffer-overflows">Buffer Overflows</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#missing-error-checks">Missing Error Checks</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#rogue-numbers">Rogue Numbers</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#catching-errors">Catching Errors</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#generic-checkers">Generic Checkers</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#checking-memory-accesses">Checking Memory Accesses</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#information-leaks">Information Leaks</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#program-specific-checkers">Program-Specific Checkers</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#static-code-checkers">Static Code Checkers</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#a-fuzzing-architecture">A Fuzzing Architecture</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#runner-classes">Runner Classes</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#fuzzer-classes">Fuzzer Classes</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#lessons-learned">Lessons Learned</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#next-steps">Next Steps</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#background">Background</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercises">Exercises</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-1-simulate-troff">Exercise 1: Simulate Troff</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-2-run-simulated-troff">Exercise 2: Run Simulated Troff</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-3-run-real-troff">Exercise 3: Run Real Troff</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="fuzzing-breaking-things-with-random-inputs">
<h1>Fuzzing: Breaking Things with Random Inputs<a class="headerlink" href="#fuzzing-breaking-things-with-random-inputs" title="Link to this heading">#</a></h1>
<p>In this chapter, we’ll start with one of the simplest test generation techniques.  The key idea of random text generation, also known as <em>fuzzing</em>, is to feed a <em>string of random characters</em> into a program in the hope to uncover failures.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">bookutils</span><span class="w"> </span><span class="kn">import</span> <span class="n">YouTubeVideo</span>
<span class="n">YouTubeVideo</span><span class="p">(</span><span class="s1">&#39;YjO1pIx7wS4&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
        <iframe
            width="640"
            height="360"
            src="https://www.youtube-nocookie.com/embed/YjO1pIx7wS4"
            frameborder="0"
            allowfullscreen
            
        ></iframe>
        </div></div>
</div>
<p><strong>Prerequisites</strong></p>
<ul class="simple">
<li><p>You should know fundamentals of software testing; for instance, from the chapter <a class="reference internal" href="Intro_Testing.html"><span class="std std-doc">“Introduction to Software Testing”</span></a>.</p></li>
<li><p>You should have a decent understanding of Python; for instance, from the <a class="reference external" href="https://docs.python.org/3/tutorial/">Python tutorial</a>.</p></li>
</ul>
<p>We can make these prerequisites explicit.  First, we’ll import a standard package required for working in notebooks.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">bookutils.setup</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">,</span> <span class="n">Union</span><span class="p">,</span> <span class="n">List</span><span class="p">,</span> <span class="n">Any</span>
</pre></div>
</div>
</div>
</div>
<p>Now, we explicitly import (and thus require) the earlier chapter.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">Intro_Testing</span>
</pre></div>
</div>
</div>
</div>
<section id="synopsis">
<h2>Synopsis<a class="headerlink" href="#synopsis" title="Link to this heading">#</a></h2>
<p>To <a class="reference internal" href="Importing.html"><span class="std std-doc">use the code provided in this chapter</span></a>, write</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">fuzzingbook.Fuzzer</span><span class="w"> </span><span class="kn">import</span> <span class="o">&lt;</span><span class="n">identifier</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>and then make use of the following features.</p>
<p><strong>Note</strong>: The examples in this section only work after the rest of the cells have been executed.</p>
<section id="fuzzers">
<h3>Fuzzers<a class="headerlink" href="#fuzzers" title="Link to this heading">#</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">Fuzzer</span></code> is a base class for fuzzers, with <code class="docutils literal notranslate"><span class="pre">RandomFuzzer</span></code> as a simple instantiation.  The <code class="docutils literal notranslate"><span class="pre">fuzz()</span></code> method of <code class="docutils literal notranslate"><span class="pre">Fuzzer</span></code> objects returns a string with a generated input.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">random_fuzzer</span> <span class="o">=</span> <span class="n">RandomFuzzer</span><span class="p">()</span>
<span class="n">random_fuzzer</span><span class="o">.</span><span class="n">fuzz</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;%$&lt;1&amp;&lt;%+=!&quot;83?+)9:++9138 42/ &quot;7;0-,)06 &quot;1(2;6&gt;?99$%7!!*#96=&gt;2&amp;-/(5*)=$;0$$+;&lt;12&quot;?30&amp;&#39;
</pre></div>
</div>
</div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">RandomFuzzer()</span></code> constructor allows a number of keyword arguments:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">RandomFuzzer</span><span class="o">.</span><span class="fm">__init__</span><span class="o">.</span><span class="vm">__doc__</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Produce strings of `min_length` to `max_length` characters
in the range [`char_start`, `char_start` + `char_range`)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">random_fuzzer</span> <span class="o">=</span> <span class="n">RandomFuzzer</span><span class="p">(</span><span class="n">min_length</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">max_length</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">char_start</span><span class="o">=</span><span class="mi">65</span><span class="p">,</span> <span class="n">char_range</span><span class="o">=</span><span class="mi">26</span><span class="p">)</span>
<span class="n">random_fuzzer</span><span class="o">.</span><span class="n">fuzz</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;XGZVDDPZOOW&#39;
</pre></div>
</div>
</div>
</div>
<div class="cell tag_remove-input docutils container">
</div>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<div class="output text_html"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 14.0.2 (20251019.1705)
 -->
<!-- Pages: 1 -->
<svg width="254pt" height="191pt"
 viewBox="0.00 0.00 254.00 191.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 186.5)">
<g id="a_graph0"><a xlink:title="RandomFuzzer class hierarchy">
<polygon fill="white" stroke="none" points="-4,4 -4,-186.5 250.12,-186.5 250.12,4 -4,4"/>
</a>
</g>
<!-- RandomFuzzer -->
<g id="node1" class="node">
<title>RandomFuzzer</title>
<g id="a_node1"><a xlink:href="#" xlink:title="class RandomFuzzer:&#10;Produce random inputs.">
<polygon fill="none" stroke="black" points="0,-0.5 0,-60 109,-60 109,-0.5 0,-0.5"/>
<text xml:space="preserve" text-anchor="start" x="8" y="-43.7" font-family="Patua One, Helvetica, sans-serif" font-weight="bold" font-size="14.00" fill="#b03a2e">RandomFuzzer</text>
<polyline fill="none" stroke="black" points="0,-34 109,-34"/>
<g id="a_node1_0"><a xlink:href="#" xlink:title="RandomFuzzer">
<g id="a_node1_1"><a xlink:href="#" xlink:title="__init__(self, min_length: int = 10, max_length: int = 100, char_start: int = 32, char_range: int = 32) &#45;&gt; None:&#10;Produce strings of `min_length` to `max_length` characters&#10;in the range [`char_start`, `char_start` + `char_range`)">
<text xml:space="preserve" text-anchor="start" x="24.5" y="-21.5" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-weight="bold" font-style="italic" font-size="10.00">__init__()</text>
</a>
</g>
<g id="a_node1_2"><a xlink:href="#" xlink:title="fuzz(self) &#45;&gt; str:&#10;Return fuzz input">
<text xml:space="preserve" text-anchor="start" x="24.5" y="-8.75" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-weight="bold" font-style="italic" font-size="10.00">fuzz()</text>
</a>
</g>
</a>
</g>
</a>
</g>
</g>
<!-- Fuzzer -->
<g id="node2" class="node">
<title>Fuzzer</title>
<g id="a_node2"><a xlink:href="#" xlink:title="class Fuzzer:&#10;Base class for fuzzers.">
<polygon fill="none" stroke="black" points="16.5,-97 16.5,-182 92.5,-182 92.5,-97 16.5,-97"/>
<text xml:space="preserve" text-anchor="start" x="33.88" y="-165.7" font-family="Patua One, Helvetica, sans-serif" font-weight="bold" font-size="14.00" fill="#b03a2e">Fuzzer</text>
<polyline fill="none" stroke="black" points="16.5,-156 92.5,-156"/>
<g id="a_node2_3"><a xlink:href="#" xlink:title="Fuzzer">
<g id="a_node2_4"><a xlink:href="#" xlink:title="__init__(self) &#45;&gt; None:&#10;Constructor">
<text xml:space="preserve" text-anchor="start" x="24.5" y="-143.5" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-weight="bold" font-style="italic" font-size="10.00">__init__()</text>
</a>
</g>
<g id="a_node2_5"><a xlink:href="#" xlink:title="fuzz(self) &#45;&gt; str:&#10;Return fuzz input">
<text xml:space="preserve" text-anchor="start" x="24.5" y="-130.75" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-weight="bold" font-style="italic" font-size="10.00">fuzz()</text>
</a>
</g>
<g id="a_node2_6"><a xlink:href="#" xlink:title="run(self, runner: Runner = &lt;Runner object at 0x10bbf2900&gt;) &#45;&gt; Tuple[subprocess.CompletedProcess, str]:&#10;Run `runner` with fuzz input">
<text xml:space="preserve" text-anchor="start" x="24.5" y="-118" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-weight="bold" font-size="10.00">run()</text>
</a>
</g>
<g id="a_node2_7"><a xlink:href="#" xlink:title="runs(self, runner: Runner = &lt;PrintRunner object at 0x10bc0f250&gt;, trials: int = 10) &#45;&gt; List[Tuple[subprocess.CompletedProcess, str]]:&#10;Run `runner` with fuzz input, `trials` times">
<text xml:space="preserve" text-anchor="start" x="24.5" y="-105.25" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-weight="bold" font-size="10.00">runs()</text>
</a>
</g>
</a>
</g>
</a>
</g>
</g>
<!-- RandomFuzzer&#45;&gt;Fuzzer -->
<g id="edge1" class="edge">
<title>RandomFuzzer&#45;&gt;Fuzzer</title>
<path fill="none" stroke="black" d="M54.5,-60.27C54.5,-68.04 54.5,-76.68 54.5,-85.31"/>
<polygon fill="none" stroke="black" points="51,-85.05 54.5,-95.05 58,-85.05 51,-85.05"/>
</g>
<!-- Legend -->
<g id="node3" class="node">
<title>Legend</title>
<text xml:space="preserve" text-anchor="start" x="126.88" y="-46.25" font-family="Patua One, Helvetica, sans-serif" font-weight="bold" font-size="10.00" fill="#b03a2e">Legend</text>
<text xml:space="preserve" text-anchor="start" x="126.88" y="-36.25" font-family="Patua One, Helvetica, sans-serif" font-size="10.00">• </text>
<text xml:space="preserve" text-anchor="start" x="132.88" y="-36.25" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-weight="bold" font-size="8.00">public_method()</text>
<text xml:space="preserve" text-anchor="start" x="126.88" y="-26.25" font-family="Patua One, Helvetica, sans-serif" font-size="10.00">• </text>
<text xml:space="preserve" text-anchor="start" x="132.88" y="-26.25" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="8.00">private_method()</text>
<text xml:space="preserve" text-anchor="start" x="126.88" y="-16.25" font-family="Patua One, Helvetica, sans-serif" font-size="10.00">• </text>
<text xml:space="preserve" text-anchor="start" x="132.88" y="-16.25" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-style="italic" font-size="8.00">overloaded_method()</text>
<text xml:space="preserve" text-anchor="start" x="126.88" y="-7.2" font-family="Helvetica,sans-Serif" font-size="9.00">Hover over names to see doc</text>
</g>
</g>
</svg>
</div></div>
</div>
</section>
<section id="runners">
<h3>Runners<a class="headerlink" href="#runners" title="Link to this heading">#</a></h3>
<p>A <code class="docutils literal notranslate"><span class="pre">Fuzzer</span></code> can be paired with a <code class="docutils literal notranslate"><span class="pre">Runner</span></code>, which takes the fuzzed strings as input. Its result is a class-specific <em>status</em> and an <em>outcome</em> (<code class="docutils literal notranslate"><span class="pre">PASS</span></code>, <code class="docutils literal notranslate"><span class="pre">FAIL</span></code>, or <code class="docutils literal notranslate"><span class="pre">UNRESOLVED</span></code>). A <code class="docutils literal notranslate"><span class="pre">PrintRunner</span></code> will simply print out the given input and return a <code class="docutils literal notranslate"><span class="pre">PASS</span></code> outcome:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">print_runner</span> <span class="o">=</span> <span class="n">PrintRunner</span><span class="p">()</span>
<span class="n">random_fuzzer</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">print_runner</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>EQYGAXPTVPJGTYHXFJ
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(&#39;EQYGAXPTVPJGTYHXFJ&#39;, &#39;UNRESOLVED&#39;)
</pre></div>
</div>
</div>
</div>
<p>A <code class="docutils literal notranslate"><span class="pre">ProgramRunner</span></code> will feed the generated input into an external program.  Its result is a pair of the program status (a <code class="docutils literal notranslate"><span class="pre">CompletedProcess</span></code> instance) and an <em>outcome</em> (<code class="docutils literal notranslate"><span class="pre">PASS</span></code>, <code class="docutils literal notranslate"><span class="pre">FAIL</span></code>, or <code class="docutils literal notranslate"><span class="pre">UNRESOLVED</span></code>):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cat</span> <span class="o">=</span> <span class="n">ProgramRunner</span><span class="p">(</span><span class="s1">&#39;cat&#39;</span><span class="p">)</span>
<span class="n">random_fuzzer</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">cat</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(CompletedProcess(args=&#39;cat&#39;, returncode=0, stdout=&#39;BZOQTXFBTEOVYX&#39;, stderr=&#39;&#39;),
 &#39;PASS&#39;)
</pre></div>
</div>
</div>
</div>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<div class="output text_html"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 14.0.2 (20251019.1705)
 -->
<!-- Pages: 1 -->
<svg width="371pt" height="224pt"
 viewBox="0.00 0.00 371.00 224.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 220)">
<g id="a_graph0"><a xlink:title="ProgramRunner class hierarchy">
<polygon fill="white" stroke="none" points="-4,4 -4,-220 367.12,-220 367.12,4 -4,4"/>
</a>
</g>
<!-- ProgramRunner -->
<g id="node1" class="node">
<title>ProgramRunner</title>
<g id="a_node1"><a xlink:href="#" xlink:title="class ProgramRunner:&#10;Test a program with inputs.">
<polygon fill="none" stroke="black" points="0,-0.5 0,-72.75 115,-72.75 115,-0.5 0,-0.5"/>
<text xml:space="preserve" text-anchor="start" x="8" y="-56.45" font-family="Patua One, Helvetica, sans-serif" font-weight="bold" font-size="14.00" fill="#b03a2e">ProgramRunner</text>
<polyline fill="none" stroke="black" points="0,-46.75 115,-46.75"/>
<g id="a_node1_0"><a xlink:href="#" xlink:title="ProgramRunner">
<g id="a_node1_1"><a xlink:href="#" xlink:title="__init__(self, program: Union[str, List[str]]) &#45;&gt; None:&#10;Initialize.&#10;`program` is a program spec as passed to `subprocess.run()`">
<text xml:space="preserve" text-anchor="start" x="18.5" y="-34.25" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-weight="bold" font-style="italic" font-size="10.00">__init__()</text>
</a>
</g>
<g id="a_node1_2"><a xlink:href="#" xlink:title="run(self, inp: str = &#39;&#39;) &#45;&gt; Tuple[subprocess.CompletedProcess, str]:&#10;Run the program with `inp` as input.&#10;Return test outcome based on result of `subprocess.run()`.">
<text xml:space="preserve" text-anchor="start" x="18.5" y="-21.5" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-weight="bold" font-style="italic" font-size="10.00">run()</text>
</a>
</g>
<g id="a_node1_3"><a xlink:href="#" xlink:title="run_process(self, inp: str = &#39;&#39;) &#45;&gt; subprocess.CompletedProcess:&#10;Run the program with `inp` as input.&#10;Return result of `subprocess.run()`.">
<text xml:space="preserve" text-anchor="start" x="18.5" y="-7.75" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="10.00">run_process()</text>
</a>
</g>
</a>
</g>
</a>
</g>
</g>
<!-- Runner -->
<g id="node2" class="node">
<title>Runner</title>
<g id="a_node2"><a xlink:href="#" xlink:title="class Runner:&#10;Base class for testing inputs.">
<polygon fill="none" stroke="black" points="80.5,-109.75 80.5,-215.5 156.5,-215.5 156.5,-109.75 80.5,-109.75"/>
<text xml:space="preserve" text-anchor="start" x="95.62" y="-199.2" font-family="Patua One, Helvetica, sans-serif" font-weight="bold" font-size="14.00" fill="#b03a2e">Runner</text>
<polyline fill="none" stroke="black" points="80.5,-189.5 156.5,-189.5"/>
<g id="a_node2_4"><a xlink:href="#" xlink:title="Runner">
<g id="a_node2_5"><a xlink:href="#" xlink:title="FAIL = &#39;FAIL&#39;">
<text xml:space="preserve" text-anchor="start" x="88.5" y="-176" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="10.00">FAIL</text>
</a>
</g>
<g id="a_node2_6"><a xlink:href="#" xlink:title="PASS = &#39;PASS&#39;">
<text xml:space="preserve" text-anchor="start" x="88.5" y="-163.25" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="10.00">PASS</text>
</a>
</g>
<g id="a_node2_7"><a xlink:href="#" xlink:title="UNRESOLVED = &#39;UNRESOLVED&#39;">
<text xml:space="preserve" text-anchor="start" x="88.5" y="-150.5" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="10.00">UNRESOLVED</text>
</a>
</g>
</a>
</g>
<polyline fill="none" stroke="black" points="80.5,-143.25 156.5,-143.25"/>
<g id="a_node2_8"><a xlink:href="#" xlink:title="Runner">
<g id="a_node2_9"><a xlink:href="#" xlink:title="__init__(self) &#45;&gt; None:&#10;Initialize">
<text xml:space="preserve" text-anchor="start" x="88.5" y="-130.75" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-weight="bold" font-style="italic" font-size="10.00">__init__()</text>
</a>
</g>
<g id="a_node2_10"><a xlink:href="#" xlink:title="run(self, inp: str) &#45;&gt; Any:&#10;Run the runner with the given input">
<text xml:space="preserve" text-anchor="start" x="88.5" y="-118" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-weight="bold" font-style="italic" font-size="10.00">run()</text>
</a>
</g>
</a>
</g>
</a>
</g>
</g>
<!-- ProgramRunner&#45;&gt;Runner -->
<g id="edge1" class="edge">
<title>ProgramRunner&#45;&gt;Runner</title>
<path fill="none" stroke="black" d="M74.98,-73.16C79.02,-81.37 83.44,-90.35 87.86,-99.34"/>
<polygon fill="none" stroke="black" points="84.61,-100.66 92.16,-108.09 90.89,-97.57 84.61,-100.66"/>
</g>
<!-- PrintRunner -->
<g id="node3" class="node">
<title>PrintRunner</title>
<g id="a_node3"><a xlink:href="#" xlink:title="class PrintRunner:&#10;Simple runner, printing the input.">
<polygon fill="none" stroke="black" points="133.25,-13.25 133.25,-60 225.75,-60 225.75,-13.25 133.25,-13.25"/>
<text xml:space="preserve" text-anchor="start" x="141.25" y="-43.7" font-family="Patua One, Helvetica, sans-serif" font-weight="bold" font-size="14.00" fill="#b03a2e">PrintRunner</text>
<polyline fill="none" stroke="black" points="133.25,-34 225.75,-34"/>
<g id="a_node3_11"><a xlink:href="#" xlink:title="PrintRunner">
<g id="a_node3_12"><a xlink:href="#" xlink:title="run(self, inp) &#45;&gt; Any:&#10;Print the given input">
<text xml:space="preserve" text-anchor="start" x="164.5" y="-21.5" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-weight="bold" font-style="italic" font-size="10.00">run()</text>
</a>
</g>
</a>
</g>
</a>
</g>
</g>
<!-- PrintRunner&#45;&gt;Runner -->
<g id="edge2" class="edge">
<title>PrintRunner&#45;&gt;Runner</title>
<path fill="none" stroke="black" d="M168.31,-60.37C162.86,-71.45 156.01,-85.38 149.15,-99.33"/>
<polygon fill="none" stroke="black" points="146.11,-97.57 144.84,-108.09 152.39,-100.66 146.11,-97.57"/>
</g>
<!-- Legend -->
<g id="node4" class="node">
<title>Legend</title>
<text xml:space="preserve" text-anchor="start" x="243.88" y="-52.62" font-family="Patua One, Helvetica, sans-serif" font-weight="bold" font-size="10.00" fill="#b03a2e">Legend</text>
<text xml:space="preserve" text-anchor="start" x="243.88" y="-42.62" font-family="Patua One, Helvetica, sans-serif" font-size="10.00">• </text>
<text xml:space="preserve" text-anchor="start" x="249.88" y="-42.62" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-weight="bold" font-size="8.00">public_method()</text>
<text xml:space="preserve" text-anchor="start" x="243.88" y="-32.62" font-family="Patua One, Helvetica, sans-serif" font-size="10.00">• </text>
<text xml:space="preserve" text-anchor="start" x="249.88" y="-32.62" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="8.00">private_method()</text>
<text xml:space="preserve" text-anchor="start" x="243.88" y="-22.62" font-family="Patua One, Helvetica, sans-serif" font-size="10.00">• </text>
<text xml:space="preserve" text-anchor="start" x="249.88" y="-22.62" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-style="italic" font-size="8.00">overloaded_method()</text>
<text xml:space="preserve" text-anchor="start" x="243.88" y="-13.57" font-family="Helvetica,sans-Serif" font-size="9.00">Hover over names to see doc</text>
</g>
</g>
</svg>
</div></div>
</div>
</section>
</section>
<section id="a-testing-assignment">
<h2>A Testing Assignment<a class="headerlink" href="#a-testing-assignment" title="Link to this heading">#</a></h2>
<p>Fuzzing was born in a “dark and stormy night in the Fall of 1988” \cite{Takanen2008}.  Sitting in his apartment in Wisconsin, Madison, professor Barton Miller was connected to his university computer via a 1200 baud telephone line.  The thunderstorm caused noise on the line, and this noise in turn caused the UNIX commands on either end to get bad inputs – and crash.  The frequent crashes surprised him – surely, programs should be more robust than that?  As a scientist, he wanted to investigate the extent of the problem and its causes.  So he crafted a <em>programming exercise</em> for his students at the University of Wisconsin-Madison – an exercise that would have his students create the first fuzzers.</p>
<p>This is how the <a class="reference external" href="http://pages.cs.wisc.edu/~bart/fuzz/CS736-Projects-f1988.pdf">assignment</a> read:</p>
<blockquote>
<div><p>The goal of this project is to evaluate the robustness of various UNIX utility programs, given an unpredictable input stream. […] First, you will build a <em>fuzz generator</em>. This is a program that will output a random character stream. Second, you will take the fuzz generator and use it to attack as many UNIX utilities as possible, with the goal of trying to break them.</p>
</div></blockquote>
<p>This assignment captures the essence of fuzzing: <em>Create random inputs, and see if they break things.</em>  Just let it run long enough, and you’ll see.</p>
</section>
<section id="a-simple-fuzzer">
<h2>A Simple Fuzzer<a class="headerlink" href="#a-simple-fuzzer" title="Link to this heading">#</a></h2>
<p>Let us try to fulfill this assignment and build a fuzz generator.  The idea is to produce random characters, adding them to a buffer string variable (<code class="docutils literal notranslate"><span class="pre">out</span></code>), and finally returning the string.</p>
<p>This implementation uses the following Python features and functions:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">random.randrange(start,</span> <span class="pre">end)</span></code> – return a random number <span class="math notranslate nohighlight">\([\)</span> <code class="docutils literal notranslate"><span class="pre">start</span></code>, <code class="docutils literal notranslate"><span class="pre">end</span></code> <span class="math notranslate nohighlight">\()\)</span></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">range(start,</span> <span class="pre">end)</span></code> – create an iterator (which can be used as a list) with integers in the range <span class="math notranslate nohighlight">\([\)</span> <code class="docutils literal notranslate"><span class="pre">start</span></code>, <code class="docutils literal notranslate"><span class="pre">end</span></code> <span class="math notranslate nohighlight">\()\)</span>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">for</span> <span class="pre">elem</span> <span class="pre">in</span> <span class="pre">list:</span> <span class="pre">body</span></code> – execute <code class="docutils literal notranslate"><span class="pre">body</span></code> in a loop with <code class="docutils literal notranslate"><span class="pre">elem</span></code> taking each value from <code class="docutils literal notranslate"><span class="pre">list</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">for</span> <span class="pre">i</span> <span class="pre">in</span> <span class="pre">range(start,</span> <span class="pre">end):</span> <span class="pre">body</span></code> – execute <code class="docutils literal notranslate"><span class="pre">body</span></code> in a loop with <code class="docutils literal notranslate"><span class="pre">i</span></code> from <code class="docutils literal notranslate"><span class="pre">start</span></code> to <code class="docutils literal notranslate"><span class="pre">end</span></code> <span class="math notranslate nohighlight">\(-\)</span> 1.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">chr(n)</span></code> – return a character with ASCII code <code class="docutils literal notranslate"><span class="pre">n</span></code></p></li>
</ul>
<p>To use random numbers, we have to import the respective module.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">random</span>
</pre></div>
</div>
</div>
</div>
<p>Here comes the actual <code class="docutils literal notranslate"><span class="pre">fuzzer()</span></code> function.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">fuzzer</span><span class="p">(</span><span class="n">max_length</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span> <span class="n">char_start</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">32</span><span class="p">,</span> <span class="n">char_range</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">32</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;A string of up to `max_length` characters</span>
<span class="sd">       in the range [`char_start`, `char_start` + `char_range`)&quot;&quot;&quot;</span>
    <span class="n">string_length</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randrange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">max_length</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">out</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">string_length</span><span class="p">):</span>
        <span class="n">out</span> <span class="o">+=</span> <span class="nb">chr</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">randrange</span><span class="p">(</span><span class="n">char_start</span><span class="p">,</span> <span class="n">char_start</span> <span class="o">+</span> <span class="n">char_range</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">out</span>
</pre></div>
</div>
</div>
</div>
<p>With its default arguments, the <code class="docutils literal notranslate"><span class="pre">fuzzer()</span></code> function returns a string of random characters:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fuzzer</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;!7#%&quot;*#0=)$;%6*;&gt;638:*&gt;80&quot;=&lt;/&gt;(/*:-(2&lt;4 !:5*6856&amp;?&quot;&quot;11&lt;7+%&lt;%7,4.8,*+&amp;,,$,.&quot;&#39;
</pre></div>
</div>
</div>
</div>
<p>Bart Miller coined the term “fuzz” as the name for such random, unstructured data.  Now imagine that this “fuzz” string was the input to a program expecting a specific input format – say, a comma-separated list of values, or an e-mail address.  Would the program be able to process such an input without any problems?</p>
<p>If the above fuzzing input already is intriguing, consider that fuzzing can easily be set up to produce other kinds of input.  For instance, we can also have <code class="docutils literal notranslate"><span class="pre">fuzzer()</span></code> produce a series of lowercase letters.  We use <code class="docutils literal notranslate"><span class="pre">ord(c)</span></code> to return the ASCII code of the character <code class="docutils literal notranslate"><span class="pre">c</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fuzzer</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="nb">ord</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">),</span> <span class="mi">26</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;zskscocrxllosagkvaszlngpysurezehvcqcghygphnhonehczraznkibltfmocxddoxcmrvatcleysksodzlwmzdndoxrjfqigjhqjxkblyrtoaydlwwisrvxtxsejhfbnforvlfisojqaktcxpmjqsfsycisoexjctydzxzzutukdztxvdpqbjuqmsectwjvylvbixzfmqiabdnihqagsvlyxwxxconminadcaqjdzcnzfjlwccyudmdfceiepwvyggepjxoeqaqbjzvmjdlebxqvehkmlevoofjlilegieeihmetjappbisqgrjhglzgffqrdqcwfmmwqecxlqfpvgtvcddvmwkplmwadgiyckrfjddxnegvmxravaunzwhpfpyzuyyavwwtgykwfszasvlbwojetvcygectelwkputfczgsfsbclnkzzcjfywitooygjwqujseflqyvqgyzpvknddzemkegrjjrshbouqxcmixnqhgsgdwgzwzmgzfajymbcfezqxndbmzwnxjeevgtpjtcwgbzptozflrwvuopohbvpmpaifnyyfvbzzdsdlznusarkmmtazptbjbqdkrsnrpgdffemnpehoapiiudokczwrvpsonybfpaeyorrgjdmgvkvupdtkrequicexqkoikygepawmwsdcrhivoegynnhodfhryeqbebtbqnwhogdfrsrksntqjbocvislhgrgchkhpaiugpbdygwkhrtyniufabdnqhtnwreiascfvmuhettfpbowbjadfxnbtzhobnxsnf&#39;
</pre></div>
</div>
</div>
</div>
<p>Assume a program expects an identifier as its input.  Would it expect such a long identifier?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">bookutils</span><span class="w"> </span><span class="kn">import</span> <span class="n">quiz</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<div class="output text_html">
    
    <script>
    var bad_answers = new Map();

    function answer(quiz_id) {
        ans = 0;
        for (i = 1;; i++) {
            checkbox = document.getElementById(quiz_id + "-" + i.toString());
            if (!checkbox)
                break;
            if (checkbox.checked)
                ans |= (1 << i);
        }
        return ans;
    }
    function check_selection(quiz_id, correct_answer, multiple_choice, hint) {
        given_answer = answer(quiz_id);
        if (given_answer == correct_answer)
        {
            document.getElementById(quiz_id + "-submit").value = "Correct!";
            document.getElementById(quiz_id + "-hint").innerHTML = "";

            for (i = 1;; i++) {
                checkbox = document.getElementById(quiz_id + "-" + i.toString());
                label = document.getElementById(quiz_id + "-" + i.toString() + "-label")
                if (!checkbox)
                    break;

                if (checkbox.checked) {
                    label.style.fontWeight = "bold";
                }
                else {
                    label.style.textDecoration = "line-through";
                }
            }
        }
        else 
        {
            document.getElementById(quiz_id + "-submit").value = "Try again";

            if (!bad_answers.has(quiz_id)) {
                bad_answers.set(quiz_id, 1);
            }
            else {
                bad_answers.set(quiz_id, bad_answers.get(quiz_id) + 1);
            }

            if (bad_answers.get(quiz_id) >= 2 && hint.length > 0) {
                document.getElementById(quiz_id + "-hint").innerHTML = 
                    "&nbsp;&nbsp;(Hint: <code>" + hint + "</code>)";
            }

            if (!multiple_choice) {
                for (i = 1;; i++) {
                    checkbox = document.getElementById(quiz_id + "-" + i.toString());
                    label = document.getElementById(quiz_id + "-" + i.toString() + "-label")

                    if (!checkbox)
                        break;
                    if (checkbox.checked) {
                        label.style.textDecoration = "line-through";
                    }
                }
            }
        }
    }
    function clear_selection(quiz_id) {
        document.getElementById(quiz_id + "-submit").value = "Submit";
        document.getElementById(quiz_id + "-hint").innerHTML = "";
    }
    </script>
    
    <div class="quiz">
    <h3 class="quiz_title">Quiz</h3>
    <p>
    <div class="quiz_question">Which of these produces strings with arbitrary long decimal numbers?</div>
    </p>
    <p>
    <div class="quiz_options" title="Pick a choice.">
    
        <input type="radio" name="aaabbc6c-b295-11f0-b18d-6298cf1a5790" id="aaabbc6c-b295-11f0-b18d-6298cf1a5790-1" onclick="clear_selection('aaabbc6c-b295-11f0-b18d-6298cf1a5790')">
        <label id="aaabbc6c-b295-11f0-b18d-6298cf1a5790-1-label" for="aaabbc6c-b295-11f0-b18d-6298cf1a5790-1"><code>fuzzer(100, 1, 100)</code></label><br>
    
        <input type="radio" name="aaabbc6c-b295-11f0-b18d-6298cf1a5790" id="aaabbc6c-b295-11f0-b18d-6298cf1a5790-2" onclick="clear_selection('aaabbc6c-b295-11f0-b18d-6298cf1a5790')">
        <label id="aaabbc6c-b295-11f0-b18d-6298cf1a5790-2-label" for="aaabbc6c-b295-11f0-b18d-6298cf1a5790-2"><code>fuzzer(100, 100, 0)</code></label><br>
    
        <input type="radio" name="aaabbc6c-b295-11f0-b18d-6298cf1a5790" id="aaabbc6c-b295-11f0-b18d-6298cf1a5790-3" onclick="clear_selection('aaabbc6c-b295-11f0-b18d-6298cf1a5790')">
        <label id="aaabbc6c-b295-11f0-b18d-6298cf1a5790-3-label" for="aaabbc6c-b295-11f0-b18d-6298cf1a5790-3"><code>fuzzer(100, 10, ord('0'))</code></label><br>
    
        <input type="radio" name="aaabbc6c-b295-11f0-b18d-6298cf1a5790" id="aaabbc6c-b295-11f0-b18d-6298cf1a5790-4" onclick="clear_selection('aaabbc6c-b295-11f0-b18d-6298cf1a5790')">
        <label id="aaabbc6c-b295-11f0-b18d-6298cf1a5790-4-label" for="aaabbc6c-b295-11f0-b18d-6298cf1a5790-4"><code>fuzzer(100, ord('0'), 10)</code></label><br>
    
    </div>
    </p>
    <input id="aaabbc6c-b295-11f0-b18d-6298cf1a5790-submit" type="submit" value="Submit" onclick="check_selection('aaabbc6c-b295-11f0-b18d-6298cf1a5790', 16, 0, '1 ** (2 % 3) * 4')">
    <span class="quiz_hint" id="aaabbc6c-b295-11f0-b18d-6298cf1a5790-hint"></span>
    </div>
    </div></div>
</div>
<p>Indeed! It is the last one that does the trick:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fuzzer</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="nb">ord</span><span class="p">(</span><span class="s1">&#39;0&#39;</span><span class="p">),</span> <span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;905902398493166953126081485047020401153418590518545517740565959745145909835837&#39;
</pre></div>
</div>
</div>
</div>
</section>
<section id="fuzzing-external-programs">
<h2>Fuzzing External Programs<a class="headerlink" href="#fuzzing-external-programs" title="Link to this heading">#</a></h2>
<p>Let us see what happens if we actually invoke an external program with fuzzed inputs.  To this end, let us proceed in two steps.  First, we create an <em>input file</em> with fuzzed test data; then we feed this input file into a program of choice.</p>
<section id="creating-input-files">
<h3>Creating Input Files<a class="headerlink" href="#creating-input-files" title="Link to this heading">#</a></h3>
<p>Let us obtain a temporary file name such that we do not clutter the file system.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">tempfile</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">basename</span> <span class="o">=</span> <span class="s2">&quot;input.txt&quot;</span>
<span class="n">tempdir</span> <span class="o">=</span> <span class="n">tempfile</span><span class="o">.</span><span class="n">mkdtemp</span><span class="p">()</span>
<span class="n">FILE</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">tempdir</span><span class="p">,</span> <span class="n">basename</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">FILE</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/tmp97hr43ss/input.txt
</pre></div>
</div>
</div>
</div>
<p>We can now open this file for writing.  The Python <code class="docutils literal notranslate"><span class="pre">open()</span></code> function opens a file into which we can then write arbitrary contents.  It is commonly used in conjunction with the <code class="docutils literal notranslate"><span class="pre">with</span></code> statement, which ensures that the file is closed as soon as it is no longer needed.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">fuzzer</span><span class="p">()</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">FILE</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>We can verify that the file was actually created by reading its contents:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">contents</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">FILE</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">contents</span><span class="p">)</span>
<span class="k">assert</span><span class="p">(</span><span class="n">contents</span> <span class="o">==</span> <span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;?6&amp;&quot; !3&#39;7-5&gt;18%55*,5
</pre></div>
</div>
</div>
</div>
</section>
<section id="invoking-external-programs">
<h3>Invoking External Programs<a class="headerlink" href="#invoking-external-programs" title="Link to this heading">#</a></h3>
<p>Now that we have an input file, we can invoke a program on it.  For the fun of it, let us test the <code class="docutils literal notranslate"><span class="pre">bc</span></code> calculator program, which takes an arithmetic expression and evaluates it.</p>
<p>To invoke <code class="docutils literal notranslate"><span class="pre">bc</span></code>, let us use the Python <code class="docutils literal notranslate"><span class="pre">subprocess</span></code> module.  This is how this works:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">subprocess</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">program</span> <span class="o">=</span> <span class="s2">&quot;bc&quot;</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">FILE</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;2 + 2</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">run</span><span class="p">([</span><span class="n">program</span><span class="p">,</span> <span class="n">FILE</span><span class="p">],</span>
                        <span class="n">stdin</span><span class="o">=</span><span class="n">subprocess</span><span class="o">.</span><span class="n">DEVNULL</span><span class="p">,</span>
                        <span class="n">stdout</span><span class="o">=</span><span class="n">subprocess</span><span class="o">.</span><span class="n">PIPE</span><span class="p">,</span>
                        <span class="n">stderr</span><span class="o">=</span><span class="n">subprocess</span><span class="o">.</span><span class="n">PIPE</span><span class="p">,</span>
                        <span class="n">universal_newlines</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># Will be &quot;text&quot; in Python 3.7</span>
</pre></div>
</div>
</div>
</div>
<p>From the <code class="docutils literal notranslate"><span class="pre">result</span></code>, we can check the program output.  In the case of <code class="docutils literal notranslate"><span class="pre">bc</span></code>, this is the result of evaluating the arithmetic expression:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">result</span><span class="o">.</span><span class="n">stdout</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;4\n&#39;
</pre></div>
</div>
</div>
</div>
<p>We can also check the status. A value of 0 indicates that the program terminated correctly.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">result</span><span class="o">.</span><span class="n">returncode</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0
</pre></div>
</div>
</div>
</div>
<p>Any error messages would be available in <code class="docutils literal notranslate"><span class="pre">results.stderr</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">result</span><span class="o">.</span><span class="n">stderr</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;&#39;
</pre></div>
</div>
</div>
</div>
<p>Instead of <code class="docutils literal notranslate"><span class="pre">bc</span></code>, you can actually put in any program you like. Be aware, though, that if your program is able to change or even damage your system, there is quite a risk that the fuzzed input contains data or commands that do precisely this.</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<div class="output text_html">
    
    <script>
    var bad_answers = new Map();

    function answer(quiz_id) {
        ans = 0;
        for (i = 1;; i++) {
            checkbox = document.getElementById(quiz_id + "-" + i.toString());
            if (!checkbox)
                break;
            if (checkbox.checked)
                ans |= (1 << i);
        }
        return ans;
    }
    function check_selection(quiz_id, correct_answer, multiple_choice, hint) {
        given_answer = answer(quiz_id);
        if (given_answer == correct_answer)
        {
            document.getElementById(quiz_id + "-submit").value = "Correct!";
            document.getElementById(quiz_id + "-hint").innerHTML = "";

            for (i = 1;; i++) {
                checkbox = document.getElementById(quiz_id + "-" + i.toString());
                label = document.getElementById(quiz_id + "-" + i.toString() + "-label")
                if (!checkbox)
                    break;

                if (checkbox.checked) {
                    label.style.fontWeight = "bold";
                }
                else {
                    label.style.textDecoration = "line-through";
                }
            }
        }
        else 
        {
            document.getElementById(quiz_id + "-submit").value = "Try again";

            if (!bad_answers.has(quiz_id)) {
                bad_answers.set(quiz_id, 1);
            }
            else {
                bad_answers.set(quiz_id, bad_answers.get(quiz_id) + 1);
            }

            if (bad_answers.get(quiz_id) >= 2 && hint.length > 0) {
                document.getElementById(quiz_id + "-hint").innerHTML = 
                    "&nbsp;&nbsp;(Hint: <code>" + hint + "</code>)";
            }

            if (!multiple_choice) {
                for (i = 1;; i++) {
                    checkbox = document.getElementById(quiz_id + "-" + i.toString());
                    label = document.getElementById(quiz_id + "-" + i.toString() + "-label")

                    if (!checkbox)
                        break;
                    if (checkbox.checked) {
                        label.style.textDecoration = "line-through";
                    }
                }
            }
        }
    }
    function clear_selection(quiz_id) {
        document.getElementById(quiz_id + "-submit").value = "Submit";
        document.getElementById(quiz_id + "-hint").innerHTML = "";
    }
    </script>
    
    <div class="quiz">
    <h3 class="quiz_title">Quiz</h3>
    <p>
    <div class="quiz_question">Just for the fun of it, imagine you would test a file removal program - say <code>rm -fr FILE</code>, where <code>FILE</code> is a string produced by <code>fuzzer()</code>. What is the chance of <code>fuzzer()</code> (with default arguments) producing a <code>FILE</code> argument that results in deleting all your files?</div>
    </p>
    <p>
    <div class="quiz_options" title="Pick a choice.">
    
        <input type="radio" name="aab79406-b295-11f0-b18d-6298cf1a5790" id="aab79406-b295-11f0-b18d-6298cf1a5790-1" onclick="clear_selection('aab79406-b295-11f0-b18d-6298cf1a5790')">
        <label id="aab79406-b295-11f0-b18d-6298cf1a5790-1-label" for="aab79406-b295-11f0-b18d-6298cf1a5790-1">About one in a billion</label><br>
    
        <input type="radio" name="aab79406-b295-11f0-b18d-6298cf1a5790" id="aab79406-b295-11f0-b18d-6298cf1a5790-2" onclick="clear_selection('aab79406-b295-11f0-b18d-6298cf1a5790')">
        <label id="aab79406-b295-11f0-b18d-6298cf1a5790-2-label" for="aab79406-b295-11f0-b18d-6298cf1a5790-2">About one in a million</label><br>
    
        <input type="radio" name="aab79406-b295-11f0-b18d-6298cf1a5790" id="aab79406-b295-11f0-b18d-6298cf1a5790-3" onclick="clear_selection('aab79406-b295-11f0-b18d-6298cf1a5790')">
        <label id="aab79406-b295-11f0-b18d-6298cf1a5790-3-label" for="aab79406-b295-11f0-b18d-6298cf1a5790-3">About one in a thousand</label><br>
    
        <input type="radio" name="aab79406-b295-11f0-b18d-6298cf1a5790" id="aab79406-b295-11f0-b18d-6298cf1a5790-4" onclick="clear_selection('aab79406-b295-11f0-b18d-6298cf1a5790')">
        <label id="aab79406-b295-11f0-b18d-6298cf1a5790-4-label" for="aab79406-b295-11f0-b18d-6298cf1a5790-4">About one in ten</label><br>
    
    </div>
    </p>
    <input id="aab79406-b295-11f0-b18d-6298cf1a5790-submit" type="submit" value="Submit" onclick="check_selection('aab79406-b295-11f0-b18d-6298cf1a5790', 8, 0, '9 ** 0.5')">
    <span class="quiz_hint" id="aab79406-b295-11f0-b18d-6298cf1a5790-hint"></span>
    </div>
    </div></div>
</div>
<p>The chance is actually higher than you may think. If you remove <code class="docutils literal notranslate"><span class="pre">/</span></code> (the root of all files), for instance, your entire file system will be gone. If you remove <code class="docutils literal notranslate"><span class="pre">.</span></code> (the current folder), all the files in the current directory will be gone.</p>
<p>The probability of generating a string that is exactly 1 character long is 1/101, this is because the length of the string is determined by calling random.randrange(0, max_length + 1), where the default value of max_length is 100. Per the description given of random.randrange, that should return a random number in [0, 99 + 1). So, we end up with the inclusive range [0, 100] where there are 101 values in the interval.</p>
<p>For <code class="docutils literal notranslate"><span class="pre">/</span></code> or <code class="docutils literal notranslate"><span class="pre">.</span></code> to be produced, you need a string length of 1 (chance: 1 out of 101) and one of these two characters (chance: 2 out of 32).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="mi">1</span><span class="o">/</span><span class="mi">101</span> <span class="o">*</span> <span class="mi">2</span><span class="o">/</span><span class="mi">32</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.0006188118811881188
</pre></div>
</div>
</div>
</div>
<p>The above code block precludes the possibility of removing <code class="docutils literal notranslate"><span class="pre">~</span></code> (your home directory), this is because the probability of generating the character ‘~’ is not 1/32; it is 0/32. The characters are created by calling chr(random.randrange(char_start, char_start + char_range)), where the default value of char_start is 32 and the default value of char_range is 32. The documentation for chr reads, “[r]eturn the string representing a character whose Unicode code point is the integer i.” The Unicode code point for ‘~’ is 126 and therefore, not in the interval [32, 64).</p>
<p>If the code were to be changed so that char_range = 95 then the probability of obtaining the character ‘~’ would be 1/94 , thus resulting in the probability of the event of deleting all files being equal to 0.000332</p>
<p>And all your files in the home directory will be gone</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="mi">3</span><span class="o">/</span><span class="mi">94</span> <span class="o">*</span> <span class="mi">1</span><span class="o">/</span><span class="mi">94</span> <span class="o">*</span> <span class="mi">99</span><span class="o">/</span><span class="mi">101</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.0003327969736765437
</pre></div>
</div>
</div>
</div>
<p>However, we can actually deal with any string as long as the <em>second</em> character is a space – after all, <code class="docutils literal notranslate"><span class="pre">rm</span> <span class="pre">-fr</span> <span class="pre">/</span> <span class="pre">WHATEVER</span></code> will first deal with <code class="docutils literal notranslate"><span class="pre">/</span></code>, and only then with whatever follows. The chances for the first character are 2 out of 32 as the code block above only allows for the probability of obtaining a <code class="docutils literal notranslate"><span class="pre">/</span></code> or a <code class="docutils literal notranslate"><span class="pre">.</span></code> but not a <code class="docutils literal notranslate"><span class="pre">~</span></code>.</p>
<p>For the space the probability is 1 out of 32.</p>
<p>We have to include the term for the probability of obtaining at least 2 characters which is required for the scenario of obtaining a space as the second character. This probability is 99/101 because it is calculated as (1 - probability of obtaining a single character or no character at all), so it is equal to 1-(2/101).</p>
<p>Therefore, the probability calculation for the event of deleting all files in the case of having a space for the second character is:</p>
<p>[probability of obtaining ‘/’ or ‘. ’ followed by a space] = [the probability of obtaining either the ‘/’ character or the ‘. ’ character] * [the probability of obtaining space] * [Probability of getting at least 2 characters] = 0.001914</p>
<p>Diagram of probability of obtaining at least 2 characters.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="mi">2</span><span class="o">/</span><span class="mi">32</span> <span class="o">*</span> <span class="mi">1</span><span class="o">/</span><span class="mi">32</span> <span class="o">*</span> <span class="mi">99</span><span class="o">/</span><span class="mi">101</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.0019144492574257425
</pre></div>
</div>
</div>
</div>
<p>Given that fuzz tests are typically run millions of times, you really don’t want to take this risk. Run your fuzzers in a safe environment that you can reset at will, such as a Docker container.</p>
</section>
<section id="long-running-fuzzing">
<h3>Long-Running Fuzzing<a class="headerlink" href="#long-running-fuzzing" title="Link to this heading">#</a></h3>
<p>Let us now feed a large number of inputs into our tested program, to see whether it might crash on some.  We store all results in the <code class="docutils literal notranslate"><span class="pre">runs</span></code> variable as pairs of input data and the actual result. (Note: running this may take a while.)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">trials</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">program</span> <span class="o">=</span> <span class="s2">&quot;bc&quot;</span>

<span class="n">runs</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">trials</span><span class="p">):</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">fuzzer</span><span class="p">()</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">FILE</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">run</span><span class="p">([</span><span class="n">program</span><span class="p">,</span> <span class="n">FILE</span><span class="p">],</span>
                            <span class="n">stdin</span><span class="o">=</span><span class="n">subprocess</span><span class="o">.</span><span class="n">DEVNULL</span><span class="p">,</span>
                            <span class="n">stdout</span><span class="o">=</span><span class="n">subprocess</span><span class="o">.</span><span class="n">PIPE</span><span class="p">,</span>
                            <span class="n">stderr</span><span class="o">=</span><span class="n">subprocess</span><span class="o">.</span><span class="n">PIPE</span><span class="p">,</span>
                            <span class="n">universal_newlines</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">runs</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">data</span><span class="p">,</span> <span class="n">result</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<p>We can now query <code class="docutils literal notranslate"><span class="pre">runs</span></code> for some statistics.  For instance, we can query how many runs actually passed – that is, there were no error messages.  We use a <em>list comprehension</em> here: The form <em>expression</em> <code class="docutils literal notranslate"><span class="pre">for</span></code> <em>element</em> <code class="docutils literal notranslate"><span class="pre">in</span></code> <em>list</em> <code class="docutils literal notranslate"><span class="pre">if</span></code> <em>condition</em> returns a list of evaluated <em>expressions</em> in which each <em>element</em> comes from <em>list</em> if the <em>condition</em> was true.  (Actually, a list comprehension returns a <em>list generator</em>, but for our purposes, the generator behaves like a list.)  Here, we have the <em>expression</em> be 1 for all elements where <em>condition</em> holds, and we use <code class="docutils literal notranslate"><span class="pre">sum()</span></code> to sum over all elements in the list.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">sum</span><span class="p">(</span><span class="mi">1</span> <span class="k">for</span> <span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">result</span><span class="p">)</span> <span class="ow">in</span> <span class="n">runs</span> <span class="k">if</span> <span class="n">result</span><span class="o">.</span><span class="n">stderr</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>9
</pre></div>
</div>
</div>
</div>
<p>Most inputs apparently are invalid – not a big surprise, as it is unlikely that a random input contains a valid arithmetic expression.</p>
<p>Let us take a look at the first error message:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">errors</span> <span class="o">=</span> <span class="p">[(</span><span class="n">data</span><span class="p">,</span> <span class="n">result</span><span class="p">)</span> <span class="k">for</span> <span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">result</span><span class="p">)</span> <span class="ow">in</span> <span class="n">runs</span> <span class="k">if</span> <span class="n">result</span><span class="o">.</span><span class="n">stderr</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">]</span>
<span class="p">(</span><span class="n">first_data</span><span class="p">,</span> <span class="n">first_result</span><span class="p">)</span> <span class="o">=</span> <span class="n">errors</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">first_data</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">first_result</span><span class="o">.</span><span class="n">stderr</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;5&amp;8&gt;&quot;86,?&quot;/7!1%5-**&amp;-$&amp;)$91;&quot;21(\&#39;8&quot;(%$4,(&quot;(&amp;!67%89$!.?(*(96(28$=6029:&lt;:$(6 !-+2622(&amp;4&#39;

Parse error: bad character &#39;&amp;&#39;
    /var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/tmp97hr43ss/input.txt:1
</pre></div>
</div>
</div>
</div>
<p>Are there any runs with messages other than <code class="docutils literal notranslate"><span class="pre">illegal</span> <span class="pre">character</span></code>, <code class="docutils literal notranslate"><span class="pre">parse</span> <span class="pre">error</span></code>, or <code class="docutils literal notranslate"><span class="pre">syntax</span> <span class="pre">error</span></code>?  (Say, something like <code class="docutils literal notranslate"><span class="pre">crash</span></code> or <code class="docutils literal notranslate"><span class="pre">you</span> <span class="pre">found</span> <span class="pre">a</span> <span class="pre">fatal</span> <span class="pre">bug</span></code>?)  Not very many:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">result</span><span class="o">.</span><span class="n">stderr</span> <span class="k">for</span> <span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">result</span><span class="p">)</span> <span class="ow">in</span> <span class="n">runs</span> <span class="k">if</span>
 <span class="n">result</span><span class="o">.</span><span class="n">stderr</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span>
 <span class="ow">and</span> <span class="s2">&quot;illegal character&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">result</span><span class="o">.</span><span class="n">stderr</span>
 <span class="ow">and</span> <span class="s2">&quot;parse error&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">result</span><span class="o">.</span><span class="n">stderr</span>
 <span class="ow">and</span> <span class="s2">&quot;syntax error&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">result</span><span class="o">.</span><span class="n">stderr</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&quot;\nParse error: bad character &#39;&amp;&#39;\n    /var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/tmp97hr43ss/input.txt:1\n\n&quot;,
 &#39;\nParse error: bad expression\n    /var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/tmp97hr43ss/input.txt:1\n\n&#39;,
 &#39;\nParse error: bad expression\n    /var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/tmp97hr43ss/input.txt:1\n\n&#39;,
 &#39;\nParse error: bad token\n    /var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/tmp97hr43ss/input.txt:1\n\n&#39;,
 &#39;\nParse error: bad token\n    /var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/tmp97hr43ss/input.txt:1\n\n&#39;,
 &#39;\nParse error: bad token\n    /var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/tmp97hr43ss/input.txt:1\n\n&#39;,
 &#39;\nParse error: bad token\n    /var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/tmp97hr43ss/input.txt:1\n\n&#39;,
 &#39;\nParse error: bad token\n    /var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/tmp97hr43ss/input.txt:1\n\n&#39;,
 &#39;\nParse error: bad expression\n    /var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/tmp97hr43ss/input.txt:1\n\n&#39;,
 &#39;\nParse error: bad token\n    /var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/tmp97hr43ss/input.txt:1\n\n&#39;,
 &#39;\nParse error: bad token\n    /var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/tmp97hr43ss/input.txt:1\n\n&#39;,
 &#39;\nParse error: bad expression\n    /var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/tmp97hr43ss/input.txt:1\n\n&#39;,
 &#39;\nParse error: bad expression\n    /var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/tmp97hr43ss/input.txt:1\n\n&#39;,
 &#39;\nParse error: bad expression\n    /var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/tmp97hr43ss/input.txt:1\n\n&#39;,
 &#39;\nParse error: bad expression\n    /var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/tmp97hr43ss/input.txt:1\n\n&#39;,
 &#39;\nParse error: bad token\n    /var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/tmp97hr43ss/input.txt:1\n\n&#39;,
 &#39;\nParse error: bad expression\n    /var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/tmp97hr43ss/input.txt:1\n\n&#39;,
 &quot;\nParse error: bad character &#39;&amp;&#39;\n    /var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/tmp97hr43ss/input.txt:1\n\n&quot;,
 &#39;\nParse error: bad assignment: left side must be scale, ibase, obase, seed, last, var, or array element\n    /var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/tmp97hr43ss/input.txt:1\n\n&#39;,
 &#39;\nParse error: bad expression\n    /var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/tmp97hr43ss/input.txt:1\n\n&#39;,
 &quot;\nParse error: bad character &#39;?&#39;\n    /var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/tmp97hr43ss/input.txt:1\n\n&quot;,
 &quot;\nParse error: bad character &#39;&#39;&#39;\n    /var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/tmp97hr43ss/input.txt:1\n\n&quot;,
 &#39;\nParse error: bad token\n    /var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/tmp97hr43ss/input.txt:1\n\n&#39;,
 &quot;\nParse error: bad character &#39;?&#39;\n    /var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/tmp97hr43ss/input.txt:1\n\n&quot;,
 &quot;\nParse error: bad character &#39;:&#39;\n    /var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/tmp97hr43ss/input.txt:1\n\n&quot;,
 &quot;\nParse error: bad character &#39;&amp;&#39;\n    /var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/tmp97hr43ss/input.txt:1\n\n&quot;,
 &quot;\nParse error: bad character &#39;:&#39;\n    /var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/tmp97hr43ss/input.txt:1\n\n&quot;,
 &#39;\nParse error: bad token\n    /var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/tmp97hr43ss/input.txt:1\n\n&#39;,
 &#39;\nParse error: bad token\n    /var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/tmp97hr43ss/input.txt:1\n\n&#39;,
 &#39;\nParse error: bad expression\n    /var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/tmp97hr43ss/input.txt:1\n\n&#39;,
 &quot;\nParse error: bad character &#39;?&#39;\n    /var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/tmp97hr43ss/input.txt:1\n\n&quot;,
 &#39;\nParse error: bad assignment: left side must be scale, ibase, obase, seed, last, var, or array element\n    /var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/tmp97hr43ss/input.txt:1\n\n&#39;,
 &#39;\nParse error: bad token\n    /var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/tmp97hr43ss/input.txt:1\n\n&#39;,
 &#39;\nParse error: bad expression\n    /var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/tmp97hr43ss/input.txt:1\n\n&#39;,
 &#39;\nParse error: bad token\n    /var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/tmp97hr43ss/input.txt:1\n\n&#39;,
 &quot;\nParse error: bad character &#39;&amp;&#39;\n    /var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/tmp97hr43ss/input.txt:1\n\n&quot;,
 &quot;\nParse error: bad character &#39;&#39;&#39;\n    /var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/tmp97hr43ss/input.txt:1\n\n&quot;,
 &#39;\nParse error: bad token\n    /var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/tmp97hr43ss/input.txt:1\n\n&#39;,
 &#39;\nParse error: bad expression\n    /var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/tmp97hr43ss/input.txt:1\n\n&#39;,
 &quot;\nParse error: bad character &#39;&#39;&#39;\n    /var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/tmp97hr43ss/input.txt:1\n\n&quot;,
 &quot;\nParse error: bad character &#39;&#39;&#39;\n    /var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/tmp97hr43ss/input.txt:1\n\n&quot;,
 &quot;\nParse error: bad character &#39;&amp;&#39;\n    /var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/tmp97hr43ss/input.txt:1\n\n&quot;,
 &#39;\nParse error: bad token\n    /var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/tmp97hr43ss/input.txt:1\n\n&#39;,
 &#39;\nParse error: bad token\n    /var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/tmp97hr43ss/input.txt:1\n\n&#39;,
 &quot;\nParse error: bad character &#39;:&#39;\n    /var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/tmp97hr43ss/input.txt:1\n\n&quot;,
 &quot;\nParse error: bad character &#39;:&#39;\n    /var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/tmp97hr43ss/input.txt:1\n\n&quot;,
 &#39;\nParse error: bad expression\n    /var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/tmp97hr43ss/input.txt:1\n\n&#39;,
 &#39;\nParse error: bad expression\n    /var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/tmp97hr43ss/input.txt:1\n\n&#39;,
 &#39;\nParse error: bad token\n    /var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/tmp97hr43ss/input.txt:1\n\n&#39;,
 &quot;\nParse error: bad character &#39;&amp;&#39;\n    /var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/tmp97hr43ss/input.txt:1\n\n&quot;,
 &#39;\nParse error: bad token\n    /var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/tmp97hr43ss/input.txt:1\n\n&#39;,
 &#39;\nParse error: bad expression\n    /var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/tmp97hr43ss/input.txt:1\n\n&#39;,
 &#39;\nParse error: bad expression\n    /var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/tmp97hr43ss/input.txt:1\n\n&#39;,
 &#39;\nParse error: bad token\n    /var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/tmp97hr43ss/input.txt:1\n\n&#39;,
 &#39;\nParse error: bad expression\n    /var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/tmp97hr43ss/input.txt:1\n\n&#39;,
 &quot;\nParse error: bad character &#39;:&#39;\n    /var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/tmp97hr43ss/input.txt:1\n\n&quot;,
 &quot;\nParse error: bad character &#39;:&#39;\n    /var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/tmp97hr43ss/input.txt:1\n\n&quot;,
 &#39;\nParse error: bad expression\n    /var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/tmp97hr43ss/input.txt:1\n\n&#39;,
 &#39;\nParse error: bad token\n    /var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/tmp97hr43ss/input.txt:1\n\n&#39;,
 &#39;\nParse error: bad token\n    /var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/tmp97hr43ss/input.txt:1\n\n&#39;,
 &#39;\nParse error: bad token\n    /var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/tmp97hr43ss/input.txt:1\n\n&#39;,
 &#39;\nParse error: bad expression\n    /var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/tmp97hr43ss/input.txt:1\n\n&#39;,
 &#39;\nParse error: bad expression\n    /var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/tmp97hr43ss/input.txt:1\n\n&#39;,
 &quot;\nParse error: bad character &#39;&amp;&#39;\n    /var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/tmp97hr43ss/input.txt:1\n\n&quot;,
 &quot;\nParse error: bad character &#39;&amp;&#39;\n    /var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/tmp97hr43ss/input.txt:1\n\n&quot;,
 &quot;\nParse error: bad character &#39;&#39;&#39;\n    /var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/tmp97hr43ss/input.txt:1\n\n&quot;,
 &#39;\nParse error: bad token\n    /var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/tmp97hr43ss/input.txt:1\n\n&#39;,
 &#39;\nParse error: bad expression\n    /var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/tmp97hr43ss/input.txt:1\n\n&#39;,
 &quot;\nParse error: bad character &#39;:&#39;\n    /var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/tmp97hr43ss/input.txt:1\n\n&quot;,
 &#39;\nParse error: bad expression\n    /var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/tmp97hr43ss/input.txt:1\n\n&#39;,
 &quot;\nParse error: bad character &#39;&#39;&#39;\n    /var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/tmp97hr43ss/input.txt:1\n\n&quot;,
 &#39;\nParse error: bad expression\n    /var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/tmp97hr43ss/input.txt:1\n\n&#39;,
 &quot;\nParse error: bad character &#39;:&#39;\n    /var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/tmp97hr43ss/input.txt:1\n\n&quot;,
 &quot;\nParse error: bad character &#39;&#39;&#39;\n    /var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/tmp97hr43ss/input.txt:1\n\n&quot;,
 &#39;\nParse error: bad token\n    /var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/tmp97hr43ss/input.txt:1\n\n&#39;,
 &#39;\nParse error: bad token\n    /var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/tmp97hr43ss/input.txt:1\n\n&#39;,
 &#39;\nParse error: bad token\n    /var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/tmp97hr43ss/input.txt:1\n\n&#39;,
 &#39;\nParse error: bad expression\n    /var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/tmp97hr43ss/input.txt:1\n\n&#39;,
 &#39;\nParse error: bad token\n    /var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/tmp97hr43ss/input.txt:1\n\n&#39;,
 &quot;\nParse error: bad character &#39;&amp;&#39;\n    /var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/tmp97hr43ss/input.txt:1\n\n&quot;,
 &#39;\nParse error: bad token\n    /var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/tmp97hr43ss/input.txt:1\n\n&#39;,
 &#39;\nParse error: bad token\n    /var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/tmp97hr43ss/input.txt:1\n\n&#39;,
 &quot;\nParse error: bad character &#39;?&#39;\n    /var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/tmp97hr43ss/input.txt:1\n\n&quot;,
 &#39;\nParse error: bad expression\n    /var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/tmp97hr43ss/input.txt:1\n\n&#39;,
 &#39;\nParse error: bad expression\n    /var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/tmp97hr43ss/input.txt:1\n\n&#39;,
 &#39;\nParse error: bad expression\n    /var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/tmp97hr43ss/input.txt:1\n\n&#39;,
 &quot;\nParse error: bad character &#39;:&#39;\n    /var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/tmp97hr43ss/input.txt:1\n\n&quot;,
 &quot;\nParse error: bad character &#39;&#39;&#39;\n    /var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/tmp97hr43ss/input.txt:1\n\n&quot;,
 &#39;\nParse error: bad expression\n    /var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/tmp97hr43ss/input.txt:1\n\n&#39;,
 &#39;\nParse error: bad token\n    /var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/tmp97hr43ss/input.txt:1\n\n&#39;,
 &#39;\nParse error: bad token\n    /var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/tmp97hr43ss/input.txt:1\n\n&#39;]
</pre></div>
</div>
</div>
</div>
<p>Maybe a crash would be indicated by <code class="docutils literal notranslate"><span class="pre">bc</span></code> just crashing.  Unfortunately, the return code is never nonzero:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">sum</span><span class="p">(</span><span class="mi">1</span> <span class="k">for</span> <span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">result</span><span class="p">)</span> <span class="ow">in</span> <span class="n">runs</span> <span class="k">if</span> <span class="n">result</span><span class="o">.</span><span class="n">returncode</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>91
</pre></div>
</div>
</div>
</div>
<p>How about we let the above <code class="docutils literal notranslate"><span class="pre">bc</span></code> test run for some more?  While it is running, let us take a look on how the state of the art was in 1989.</p>
</section>
</section>
<section id="bugs-fuzzers-find">
<h2>Bugs Fuzzers Find<a class="headerlink" href="#bugs-fuzzers-find" title="Link to this heading">#</a></h2>
<p>When Miller and his students ran their first fuzzers in 1989, they found an alarming result: About <strong>a third of the UNIX utilities</strong> they fuzzed had issues – they crashed, hung, or otherwise failed when confronted with fuzzing input \cite{Miller1990}.  This also included the <code class="docutils literal notranslate"><span class="pre">bc</span></code> program, above.  (The <code class="docutils literal notranslate"><span class="pre">bc</span></code> above is a <a class="reference external" href="https://git.gavinhoward.com/gavin/bc">modern reimplementation</a> whose author is a <a class="reference external" href="https://git.gavinhoward.com/gavin/bc/src/branch/master/tests/fuzzing">staunch believer in fuzzing</a>!)</p>
<p>Considering that many of these UNIX utilities were used in scripts that would also process network input, this was an alarming result.  Programmers quickly built and ran their own fuzzers, rushed to fix the reported errors, and learned not to trust external inputs anymore.</p>
<p>What kind of problems did Miller’s fuzzing experiment find?  It turns out that the mistakes programmers made in 1990 are still the same mistakes being made today.</p>
<section id="buffer-overflows">
<h3>Buffer Overflows<a class="headerlink" href="#buffer-overflows" title="Link to this heading">#</a></h3>
<p>Many programs have built-in maximum lengths for inputs and input elements.  In languages like C, it is easy to excess these lengths without the program (or the programmer) even noticing, triggering so-called <strong>buffer overflows</strong>.  The following code, for instance, happily copies the <code class="docutils literal notranslate"><span class="pre">input</span></code> string into a <code class="docutils literal notranslate"><span class="pre">weekday</span></code> string even if <code class="docutils literal notranslate"><span class="pre">input</span></code> has more than eight characters:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">char</span><span class="w"> </span><span class="n">weekday</span><span class="p">[</span><span class="mi">9</span><span class="p">];</span><span class="w"> </span><span class="c1">// 8 characters + trailing &#39;\0&#39; terminator</span>
<span class="n">strcpy</span><span class="w"> </span><span class="p">(</span><span class="n">weekday</span><span class="p">,</span><span class="w"> </span><span class="n">input</span><span class="p">);</span>
</pre></div>
</div>
<p>Ironically, this already fails if <code class="docutils literal notranslate"><span class="pre">input</span></code> is <code class="docutils literal notranslate"><span class="pre">&quot;Wednesday&quot;</span></code> (9 characters); any excess characters (here, <code class="docutils literal notranslate"><span class="pre">'y'</span></code> and the following <code class="docutils literal notranslate"><span class="pre">'\0'</span></code> string terminator) are simply copied to whatever resides in memory after <code class="docutils literal notranslate"><span class="pre">weekday</span></code>, triggering arbitrary behavior; maybe some boolean character variable which would be set from <code class="docutils literal notranslate"><span class="pre">'n'</span></code> to <code class="docutils literal notranslate"><span class="pre">'y'</span></code>.  With fuzzing, it is very easy to produce arbitrary long inputs and input elements.</p>
<p>We can easily simulate this buffer overflow behavior in a Python function:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">crash_if_too_long</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
    <span class="n">buffer</span> <span class="o">=</span> <span class="s2">&quot;Thursday&quot;</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="o">&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">buffer</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span>
</pre></div>
</div>
</div>
</div>
<p>And yes, it quickly crashes.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">ExpectError</span><span class="w"> </span><span class="kn">import</span> <span class="n">ExpectError</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">trials</span> <span class="o">=</span> <span class="mi">100</span>
<span class="k">with</span> <span class="n">ExpectError</span><span class="p">():</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">trials</span><span class="p">):</span>
        <span class="n">s</span> <span class="o">=</span> <span class="n">fuzzer</span><span class="p">()</span>
        <span class="n">crash_if_too_long</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Traceback (most recent call last):
  File &quot;/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_63064/292568387.py&quot;, line 5, in &lt;module&gt;
    crash_if_too_long(s)
    ~~~~~~~~~~~~~~~~~^^^
  File &quot;/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_63064/2784561514.py&quot;, line 4, in crash_if_too_long
    raise ValueError
ValueError (expected)
</pre></div>
</div>
</div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">with</span> <span class="pre">ExpectError()</span></code> line in the above code ensures that the error message is printed, yet execution continues; this is to differentiate this “expected” error from “unexpected” errors in other code examples.</p>
</section>
<section id="missing-error-checks">
<h3>Missing Error Checks<a class="headerlink" href="#missing-error-checks" title="Link to this heading">#</a></h3>
<p>Many programming languages do not have exceptions, but instead have functions return special <strong>error codes</strong> in exceptional circumstances.  The C function <code class="docutils literal notranslate"><span class="pre">getchar()</span></code>, for instance, normally returns a character from the standard input; if no input is available anymore, it returns the special value <code class="docutils literal notranslate"><span class="pre">EOF</span></code> (end of file).  Now assume a programmer is scanning the input for the next character, reading in characters with <code class="docutils literal notranslate"><span class="pre">getchar()</span></code> until a space character is read:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="n">getchar</span><span class="p">()</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="sc">&#39; &#39;</span><span class="p">);</span>
</pre></div>
</div>
<p>What happens if the input ends prematurely, as would perfectly be feasible with fuzzing?  Well, <code class="docutils literal notranslate"><span class="pre">getchar()</span></code> returns <code class="docutils literal notranslate"><span class="pre">EOF</span></code>, and keeps on returning <code class="docutils literal notranslate"><span class="pre">EOF</span></code> when called again; so the code above simply enters an infinite loop.</p>
<p>Again, we can simulate such missing error checks.  Here’s a function that will effectively hang if no space is present in the input:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">hang_if_no_space</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
    <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39; &#39;</span><span class="p">:</span>
                <span class="k">break</span>
        <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
</pre></div>
</div>
</div>
</div>
<p>Using the timeout mechanism from our <a class="reference internal" href="Intro_Testing.html"><span class="std std-doc">Introduction to Testing</span></a>, we can interrupt this function after some time.  And yes, it does hang after a few fuzzing inputs.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">ExpectError</span><span class="w"> </span><span class="kn">import</span> <span class="n">ExpectTimeout</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">trials</span> <span class="o">=</span> <span class="mi">100</span>
<span class="k">with</span> <span class="n">ExpectTimeout</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">trials</span><span class="p">):</span>
        <span class="n">s</span> <span class="o">=</span> <span class="n">fuzzer</span><span class="p">()</span>
        <span class="n">hang_if_no_space</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Traceback (most recent call last):
  File &quot;/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_63064/3194687366.py&quot;, line 5, in &lt;module&gt;
    hang_if_no_space(s)
    ~~~~~~~~~~~~~~~~^^^
  File &quot;/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_63064/3035466707.py&quot;, line 3, in hang_if_no_space
    while True:
          ^^^^
  File &quot;Timeout.ipynb&quot;, line 43, in timeout_handler
    raise TimeoutError()
TimeoutError (expected)
</pre></div>
</div>
</div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">with</span> <span class="pre">ExpectTimeout()</span></code> line in the above code ensures that execution of the enclosed code is interrupted after two seconds, printing the error message.</p>
</section>
<section id="rogue-numbers">
<h3>Rogue Numbers<a class="headerlink" href="#rogue-numbers" title="Link to this heading">#</a></h3>
<p>With fuzzing, it is easy to generate <strong>uncommon values</strong> in the input, causing all kinds of interesting behavior.  Consider the following code, again in the C language, which first reads a buffer size from the input, and then allocates a buffer of the given size:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="nf">read_input</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">read_buffer_size</span><span class="p">();</span>
<span class="w">    </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">buffer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="n">malloc</span><span class="p">(</span><span class="n">size</span><span class="p">);</span>
<span class="w">    </span><span class="c1">// fill buffer</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">(</span><span class="n">buffer</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>What happens if <code class="docutils literal notranslate"><span class="pre">size</span></code> is very large, exceeding program memory?  What happens if <code class="docutils literal notranslate"><span class="pre">size</span></code> is less than the number of characters following?  What happens if <code class="docutils literal notranslate"><span class="pre">size</span></code> is negative?  By providing a random number here, fuzzing can create all kinds of damages.</p>
<p>Again, we can easily simulate such rogue numbers in Python.  The function <code class="docutils literal notranslate"><span class="pre">collapse_if_too_large()</span></code> fails if the passed value (a string) is too large after having been converted to an integer.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">collapse_if_too_large</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
    <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1000</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span>
</pre></div>
</div>
</div>
</div>
<p>We can have <code class="docutils literal notranslate"><span class="pre">fuzzer()</span></code> create a string of digits:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">long_number</span> <span class="o">=</span> <span class="n">fuzzer</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="nb">ord</span><span class="p">(</span><span class="s1">&#39;0&#39;</span><span class="p">),</span> <span class="mi">10</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">long_number</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>7056414967099541967374507745748918952640135045
</pre></div>
</div>
</div>
</div>
<p>If we feed such numbers into <code class="docutils literal notranslate"><span class="pre">collapse_if_too_large()</span></code>, it will very soon fail.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">ExpectError</span><span class="p">():</span>
    <span class="n">collapse_if_too_large</span><span class="p">(</span><span class="n">long_number</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Traceback (most recent call last):
  File &quot;/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_63064/2775103647.py&quot;, line 2, in &lt;module&gt;
    collapse_if_too_large(long_number)
    ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File &quot;/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_63064/1591744602.py&quot;, line 3, in collapse_if_too_large
    raise ValueError
ValueError (expected)
</pre></div>
</div>
</div>
</div>
<p>If we really wanted to allocate that much memory on a system, having it quickly fail as above actually would be the better option.  In reality, running out of memory may dramatically slow systems down, up to the point that they become totally unresponsive – and restarting is the only option.</p>
<p>One might argue that these are all problems of bad programming, or of bad programming languages.  But then, there are thousands of people starting to program every day, and all of them make the same mistakes again and again, even today.</p>
</section>
</section>
<section id="catching-errors">
<h2>Catching Errors<a class="headerlink" href="#catching-errors" title="Link to this heading">#</a></h2>
<p>When Miller and his students built their first fuzzer, they could identify errors simply because the program would crash or hang – two conditions that are easy to identify.  If the failures are more subtle, though, we need to come up with additional checks.</p>
<section id="generic-checkers">
<h3>Generic Checkers<a class="headerlink" href="#generic-checkers" title="Link to this heading">#</a></h3>
<p>Buffer overflows, as <a class="reference internal" href="#Buffer-Overflows"><span class="xref myst">discussed above</span></a>, are a particular instance of a more general problem: In languages like C and C++, a program can access arbitrary parts of its memory – even those parts that are uninitialized, already freed or simply not part of the data structure you are trying to access.  This is necessary if you want to write an operating system, and great if you want a maximum of performance or control, but pretty bad if you want to avoid mistakes.  Fortunately, there are tools that help catching such issues at runtime, and they are great when combined with fuzzing.</p>
<section id="checking-memory-accesses">
<h4>Checking Memory Accesses<a class="headerlink" href="#checking-memory-accesses" title="Link to this heading">#</a></h4>
<p>To catch problematic memory accesses during testing, one can run C programs in special <em>memory-checking</em> environments; at runtime, these check for each and every memory operation whether it accesses valid and initialized memory. A popular example is <a class="reference external" href="https://clang.llvm.org/docs/AddressSanitizer.html">LLVM Address Sanitizer</a> which detects a whole set of potentially dangerous memory safety violations. In the following example we will compile a rather simple C program with this tool and provoke an out-of-bounds read by reading past an allocated portion of memory.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;program.c&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">#include &lt;stdlib.h&gt;</span>
<span class="s2">#include &lt;string.h&gt;</span>

<span class="s2">int main(int argc, char** argv) {</span>
<span class="s2">    /* Create an array with 100 bytes, initialized with 42 */</span>
<span class="s2">    char *buf = malloc(100);</span>
<span class="s2">    memset(buf, 42, 100);</span>

<span class="s2">    /* Read the N-th element, with N being the first command-line argument */</span>
<span class="s2">    int index = atoi(argv[1]);</span>
<span class="s2">    char val = buf[index];</span>

<span class="s2">    /* Clean up memory so we don&#39;t leak */</span>
<span class="s2">    free(buf);</span>
<span class="s2">    return val;</span>
<span class="s2">}</span>
<span class="s2">    &quot;&quot;&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">bookutils</span><span class="w"> </span><span class="kn">import</span> <span class="n">print_file</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">print_file</span><span class="p">(</span><span class="s2">&quot;program.c&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Cyan">#include</span><span class=" -Color -Color-White"> &lt;stdlib.h&gt;</span>
<span class=" -Color -Color-Cyan">#include</span><span class=" -Color -Color-White"> &lt;string.h&gt;</span>

<span class=" -Color -Color-Cyan">int</span><span class=" -Color -Color-White"> </span><span class=" -Color -Color-Green">main</span>(<span class=" -Color -Color-Cyan">int</span><span class=" -Color -Color-White"> </span>argc,<span class=" -Color -Color-White"> </span><span class=" -Color -Color-Cyan">char</span>**<span class=" -Color -Color-White"> </span>argv)<span class=" -Color -Color-White"> </span>{
<span class=" -Color -Color-White">    /* Create an array with 100 bytes, initialized with 42 */</span>
<span class=" -Color -Color-White">    </span><span class=" -Color -Color-Cyan">char</span><span class=" -Color -Color-White"> </span>*buf<span class=" -Color -Color-White"> </span>=<span class=" -Color -Color-White"> </span>malloc(<span class=" -Color -Color-Blue">100</span>);
<span class=" -Color -Color-White">    </span>memset(buf,<span class=" -Color -Color-White"> </span><span class=" -Color -Color-Blue">42</span>,<span class=" -Color -Color-White"> </span><span class=" -Color -Color-Blue">100</span>);

<span class=" -Color -Color-White">    /* Read the N-th element, with N being the first command-line argument */</span>
<span class=" -Color -Color-White">    </span><span class=" -Color -Color-Cyan">int</span><span class=" -Color -Color-White"> </span>index<span class=" -Color -Color-White"> </span>=<span class=" -Color -Color-White"> </span>atoi(argv[<span class=" -Color -Color-Blue">1</span>]);
<span class=" -Color -Color-White">    </span><span class=" -Color -Color-Cyan">char</span><span class=" -Color -Color-White"> </span>val<span class=" -Color -Color-White"> </span>=<span class=" -Color -Color-White"> </span>buf[index];

<span class=" -Color -Color-White">    /* Clean up memory so we don&#39;t leak */</span>
<span class=" -Color -Color-White">    </span>free(buf);
<span class=" -Color -Color-White">    </span><span class=" -Color -Color-Blue">return</span><span class=" -Color -Color-White"> </span>val;
}
<span class=" -Color -Color-White">    </span>
</pre></div>
</div>
</div>
</div>
<p>We compile this C program with address sanitization enabled:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>clang<span class="w"> </span>-fsanitize<span class="o">=</span>address<span class="w"> </span>-g<span class="w"> </span>-o<span class="w"> </span>program<span class="w"> </span>program.c
</pre></div>
</div>
</div>
</div>
<p>If we run the program with an argument of <code class="docutils literal notranslate"><span class="pre">99</span></code>, it returns <code class="docutils literal notranslate"><span class="pre">buf[99]</span></code>, which is 42.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>./program<span class="w"> </span><span class="m">99</span><span class="p">;</span><span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="nv">$?</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>42
</pre></div>
</div>
</div>
</div>
<p>Accessing <code class="docutils literal notranslate"><span class="pre">buf[110]</span></code>, however, results in an out-of-bounds error in AddressSanitizer.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>./program<span class="w"> </span><span class="m">110</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>=================================================================
<span class=" -Color -Color-Bold -Color-Bold-Red">==63288==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x60b0000000ae at pc 0x000104780668 bp 0x00016b67e6e0 sp 0x00016b67e6d8</span>
<span class=" -Color -Color-Bold -Color-Bold-Blue">READ of size 1 at 0x60b0000000ae thread T0</span>
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    #0 0x000104780664 in main program.c:12
    #1 0x0001870c1d50 in start+0x1c0c (dyld:arm64e+0x3d50)

<span class=" -Color -Color-Bold -Color-Bold-Green">0x60b0000000ae is located 10 bytes after 100-byte region [0x60b000000040,0x60b0000000a4)</span>
<span class=" -Color -Color-Bold -Color-Bold-Magenta">allocated by thread T0 here:</span>
    #0 0x000104e8530c in malloc+0x78 (libclang_rt.asan_osx_dynamic.dylib:arm64e+0x3d30c)
    #1 0x0001047805c0 in main program.c:7
    #2 0x0001870c1d50 in start+0x1c0c (dyld:arm64e+0x3d50)

SUMMARY: AddressSanitizer: heap-buffer-overflow program.c:12 in main
Shadow bytes around the buggy address:
  0x60affffffe00: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x60affffffe80: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x60afffffff00: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x60afffffff80: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x60b000000000: <span class=" -Color -Color-Bold -Color-Bold-Red">fa</span> <span class=" -Color -Color-Bold -Color-Bold-Red">fa</span> <span class=" -Color -Color-Bold -Color-Bold-Red">fa</span> <span class=" -Color -Color-Bold -Color-Bold-Red">fa</span> <span class=" -Color -Color-Bold -Color-Bold-Red">fa</span> <span class=" -Color -Color-Bold -Color-Bold-Red">fa</span> <span class=" -Color -Color-Bold -Color-Bold-Red">fa</span> <span class=" -Color -Color-Bold -Color-Bold-Red">fa</span> 00 00 00 00 00 00 00 00
=&gt;0x60b000000080: 00 00 00 00 04[<span class=" -Color -Color-Bold -Color-Bold-Red">fa</span>]<span class=" -Color -Color-Bold -Color-Bold-Red">fa</span> <span class=" -Color -Color-Bold -Color-Bold-Red">fa</span> <span class=" -Color -Color-Bold -Color-Bold-Red">fa</span> <span class=" -Color -Color-Bold -Color-Bold-Red">fa</span> <span class=" -Color -Color-Bold -Color-Bold-Red">fa</span> <span class=" -Color -Color-Bold -Color-Bold-Red">fa</span> <span class=" -Color -Color-Bold -Color-Bold-Red">fa</span> <span class=" -Color -Color-Bold -Color-Bold-Red">fa</span> <span class=" -Color -Color-Bold -Color-Bold-Red">fa</span> <span class=" -Color -Color-Bold -Color-Bold-Red">fa</span>
  0x60b000000100: <span class=" -Color -Color-Bold -Color-Bold-Red">fa</span> <span class=" -Color -Color-Bold -Color-Bold-Red">fa</span> <span class=" -Color -Color-Bold -Color-Bold-Red">fa</span> <span class=" -Color -Color-Bold -Color-Bold-Red">fa</span> <span class=" -Color -Color-Bold -Color-Bold-Red">fa</span> <span class=" -Color -Color-Bold -Color-Bold-Red">fa</span> <span class=" -Color -Color-Bold -Color-Bold-Red">fa</span> <span class=" -Color -Color-Bold -Color-Bold-Red">fa</span> <span class=" -Color -Color-Bold -Color-Bold-Red">fa</span> <span class=" -Color -Color-Bold -Color-Bold-Red">fa</span> <span class=" -Color -Color-Bold -Color-Bold-Red">fa</span> <span class=" -Color -Color-Bold -Color-Bold-Red">fa</span> <span class=" -Color -Color-Bold -Color-Bold-Red">fa</span> <span class=" -Color -Color-Bold -Color-Bold-Red">fa</span> <span class=" -Color -Color-Bold -Color-Bold-Red">fa</span> <span class=" -Color -Color-Bold -Color-Bold-Red">fa</span>
  0x60b000000180: <span class=" -Color -Color-Bold -Color-Bold-Red">fa</span> <span class=" -Color -Color-Bold -Color-Bold-Red">fa</span> <span class=" -Color -Color-Bold -Color-Bold-Red">fa</span> <span class=" -Color -Color-Bold -Color-Bold-Red">fa</span> <span class=" -Color -Color-Bold -Color-Bold-Red">fa</span> <span class=" -Color -Color-Bold -Color-Bold-Red">fa</span> <span class=" -Color -Color-Bold -Color-Bold-Red">fa</span> <span class=" -Color -Color-Bold -Color-Bold-Red">fa</span> <span class=" -Color -Color-Bold -Color-Bold-Red">fa</span> <span class=" -Color -Color-Bold -Color-Bold-Red">fa</span> <span class=" -Color -Color-Bold -Color-Bold-Red">fa</span> <span class=" -Color -Color-Bold -Color-Bold-Red">fa</span> <span class=" -Color -Color-Bold -Color-Bold-Red">fa</span> <span class=" -Color -Color-Bold -Color-Bold-Red">fa</span> <span class=" -Color -Color-Bold -Color-Bold-Red">fa</span> <span class=" -Color -Color-Bold -Color-Bold-Red">fa</span>
  0x60b000000200: <span class=" -Color -Color-Bold -Color-Bold-Red">fa</span> <span class=" -Color -Color-Bold -Color-Bold-Red">fa</span> <span class=" -Color -Color-Bold -Color-Bold-Red">fa</span> <span class=" -Color -Color-Bold -Color-Bold-Red">fa</span> <span class=" -Color -Color-Bold -Color-Bold-Red">fa</span> <span class=" -Color -Color-Bold -Color-Bold-Red">fa</span> <span class=" -Color -Color-Bold -Color-Bold-Red">fa</span> <span class=" -Color -Color-Bold -Color-Bold-Red">fa</span> <span class=" -Color -Color-Bold -Color-Bold-Red">fa</span> <span class=" -Color -Color-Bold -Color-Bold-Red">fa</span> <span class=" -Color -Color-Bold -Color-Bold-Red">fa</span> <span class=" -Color -Color-Bold -Color-Bold-Red">fa</span> <span class=" -Color -Color-Bold -Color-Bold-Red">fa</span> <span class=" -Color -Color-Bold -Color-Bold-Red">fa</span> <span class=" -Color -Color-Bold -Color-Bold-Red">fa</span> <span class=" -Color -Color-Bold -Color-Bold-Red">fa</span>
  0x60b000000280: <span class=" -Color -Color-Bold -Color-Bold-Red">fa</span> <span class=" -Color -Color-Bold -Color-Bold-Red">fa</span> <span class=" -Color -Color-Bold -Color-Bold-Red">fa</span> <span class=" -Color -Color-Bold -Color-Bold-Red">fa</span> <span class=" -Color -Color-Bold -Color-Bold-Red">fa</span> <span class=" -Color -Color-Bold -Color-Bold-Red">fa</span> <span class=" -Color -Color-Bold -Color-Bold-Red">fa</span> <span class=" -Color -Color-Bold -Color-Bold-Red">fa</span> <span class=" -Color -Color-Bold -Color-Bold-Red">fa</span> <span class=" -Color -Color-Bold -Color-Bold-Red">fa</span> <span class=" -Color -Color-Bold -Color-Bold-Red">fa</span> <span class=" -Color -Color-Bold -Color-Bold-Red">fa</span> <span class=" -Color -Color-Bold -Color-Bold-Red">fa</span> <span class=" -Color -Color-Bold -Color-Bold-Red">fa</span> <span class=" -Color -Color-Bold -Color-Bold-Red">fa</span> <span class=" -Color -Color-Bold -Color-Bold-Red">fa</span>
  0x60b000000300: <span class=" -Color -Color-Bold -Color-Bold-Red">fa</span> <span class=" -Color -Color-Bold -Color-Bold-Red">fa</span> <span class=" -Color -Color-Bold -Color-Bold-Red">fa</span> <span class=" -Color -Color-Bold -Color-Bold-Red">fa</span> <span class=" -Color -Color-Bold -Color-Bold-Red">fa</span> <span class=" -Color -Color-Bold -Color-Bold-Red">fa</span> <span class=" -Color -Color-Bold -Color-Bold-Red">fa</span> <span class=" -Color -Color-Bold -Color-Bold-Red">fa</span> <span class=" -Color -Color-Bold -Color-Bold-Red">fa</span> <span class=" -Color -Color-Bold -Color-Bold-Red">fa</span> <span class=" -Color -Color-Bold -Color-Bold-Red">fa</span> <span class=" -Color -Color-Bold -Color-Bold-Red">fa</span> <span class=" -Color -Color-Bold -Color-Bold-Red">fa</span> <span class=" -Color -Color-Bold -Color-Bold-Red">fa</span> <span class=" -Color -Color-Bold -Color-Bold-Red">fa</span> <span class=" -Color -Color-Bold -Color-Bold-Red">fa</span>
Shadow byte legend (one shadow byte represents 8 application bytes):
  Addressable:           00
  Partially addressable: 01 02 03 04 05 06 07 
  Heap left redzone:       <span class=" -Color -Color-Bold -Color-Bold-Red">fa</span>
  Freed heap region:       <span class=" -Color -Color-Bold -Color-Bold-Magenta">fd</span>
  Stack left redzone:      <span class=" -Color -Color-Bold -Color-Bold-Red">f1</span>
  Stack mid redzone:       <span class=" -Color -Color-Bold -Color-Bold-Red">f2</span>
  Stack right redzone:     <span class=" -Color -Color-Bold -Color-Bold-Red">f3</span>
  Stack after return:      <span class=" -Color -Color-Bold -Color-Bold-Magenta">f5</span>
  Stack use after scope:   <span class=" -Color -Color-Bold -Color-Bold-Magenta">f8</span>
  Global redzone:          <span class=" -Color -Color-Bold -Color-Bold-Red">f9</span>
  Global init order:       <span class=" -Color -Color-Bold -Color-Bold-Cyan">f6</span>
  Poisoned by user:        <span class=" -Color -Color-Bold -Color-Bold-Blue">f7</span>
  Container overflow:      <span class=" -Color -Color-Bold -Color-Bold-Blue">fc</span>
  Array cookie:            <span class=" -Color -Color-Bold -Color-Bold-Red">ac</span>
  Intra object redzone:    <span class=" -Color -Color-Bold -Color-Bold-Yellow">bb</span>
  ASan internal:           <span class=" -Color -Color-Bold -Color-Bold-Yellow">fe</span>
  Left alloca redzone:     <span class=" -Color -Color-Bold -Color-Bold-Blue">ca</span>
  Right alloca redzone:    <span class=" -Color -Color-Bold -Color-Bold-Blue">cb</span>
==63288==ABORTING
</pre></div>
</div>
</div>
</div>
<p>If you want to find errors in a C program, turning on such checks for fuzzing is fairly easy.  It will slow down execution by a certain factor depending on the tool (for AddressSanitizer it is typically 2<span class="math notranslate nohighlight">\(\times\)</span>) and also consume more memory, but CPU cycles are dead cheap compared to the human effort it takes to find these bugs.</p>
<p>Out-of-bounds accesses to memory are a great security risk, as they may let attackers access or even modify information that is not meant for them.  As a famous example, the <a class="reference external" href="https://en.wikipedia.org/wiki/Heartbleed">HeartBleed bug</a> was a security bug in the OpenSSL library, implementing cryptographic protocols that provide communications security over a computer network.  (If you read this text in a browser, it is likely encrypted using these protocols.)</p>
<p>The HeartBleed bug was exploited by sending a specially crafted command to the SSL <em>heartbeat</em> service.  A heartbeat service is used to check if the server on the other end is still alive.  A client would send the service a string like</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">BIRD</span> <span class="p">(</span><span class="mi">4</span> <span class="n">letters</span><span class="p">)</span>
</pre></div>
</div>
<p>to which the server would reply with <code class="docutils literal notranslate"><span class="pre">BIRD</span></code>, and the client would know the server is alive.</p>
<p>Unfortunately, this service could be exploited by asking the server to reply with <em>more</em> than the requested set of letters.  This is very well explained in this <a class="reference external" href="https://xkcd.com/1354/">XKCD comic</a>:</p>
<p><img alt="XKCD Comic" src="_images/xkcd_heartbleed_1.png" /></p>
<p><img alt="XKCD Comic" src="_images/xkcd_heartbleed_2.png" /></p>
<p><img alt="XKCD Comic" src="_images/xkcd_heartbleed_3.png" /></p>
<p>In the OpenSSL implementation, these memory contents could involve cryptographic certificates, private keys, and more – and worse, no one would notice that this memory just had been accessed.  When the HeartBleed bug was discovered, it had been around for many years, and none would know whether and which secrets had already leaked; the quickly set up <a class="reference external" href="http://heartbleed.com/">HeartBleed announcement page</a> said it all.</p>
<p>But how was HeartBleed discovered?  Very simple.  Researchers both at the Codenomicon company as well as with Google compiled the OpenSSL library with a memory sanitizer, and then happily flooded it with fuzzed commands.  The memory sanitizer would then notice whether an out-of-bounds memory access had occurred – and actually, it would very quickly discover this.</p>
<p>A memory checker is just one of many checkers one can run to detect runtime errors during fuzzing.  In the <a class="reference internal" href="DynamicInvariants.html"><span class="std std-doc">chapter on mining function specifications</span></a>, we will learn more about how to define generic checkers.</p>
<p>We’re done with <code class="docutils literal notranslate"><span class="pre">program</span></code>, so we clean up:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>rm<span class="w"> </span>-fr<span class="w"> </span>program<span class="w"> </span>program.*
</pre></div>
</div>
</div>
</div>
</section>
<section id="information-leaks">
<h4>Information Leaks<a class="headerlink" href="#information-leaks" title="Link to this heading">#</a></h4>
<p>Information leaks may not only occur through illegal memory accesses; they can also occur within “valid” memory – if this “valid” memory contains sensitive information that should not leak out.  Let us illustrate this issue in a Python program.  To start with, let us create some program memory filled with actual data and random data:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">secrets</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;&lt;space for reply&gt;&quot;</span> <span class="o">+</span> <span class="n">fuzzer</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span> <span class="o">+</span>
           <span class="s2">&quot;&lt;secret-certificate&gt;&quot;</span> <span class="o">+</span> <span class="n">fuzzer</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span> <span class="o">+</span>
           <span class="s2">&quot;&lt;secret-key&gt;&quot;</span> <span class="o">+</span> <span class="n">fuzzer</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;&lt;other-secrets&gt;&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>We add more “memory” characters to <code class="docutils literal notranslate"><span class="pre">secrets</span></code>, filled with <code class="docutils literal notranslate"><span class="pre">&quot;deadbeef&quot;</span></code> as marker for uninitialized memory:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">uninitialized_memory_marker</span> <span class="o">=</span> <span class="s2">&quot;deadbeef&quot;</span>
<span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="n">secrets</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2048</span><span class="p">:</span>
    <span class="n">secrets</span> <span class="o">+=</span> <span class="n">uninitialized_memory_marker</span>
</pre></div>
</div>
</div>
</div>
<p>We define a service (similar to the heartbeat service discussed above) that would take a reply to be sent back, as well as a length.  It would store the reply to be sent in memory, and then send it back with the given length.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">heartbeat</span><span class="p">(</span><span class="n">reply</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">length</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">memory</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
    <span class="c1"># Store reply in memory</span>
    <span class="n">memory</span> <span class="o">=</span> <span class="n">reply</span> <span class="o">+</span> <span class="n">memory</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">reply</span><span class="p">):]</span>

    <span class="c1"># Send back heartbeat</span>
    <span class="n">s</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">length</span><span class="p">):</span>
        <span class="n">s</span> <span class="o">+=</span> <span class="n">memory</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">s</span>
</pre></div>
</div>
</div>
</div>
<p>This perfectly works for standard strings:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">heartbeat</span><span class="p">(</span><span class="s2">&quot;potato&quot;</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="n">memory</span><span class="o">=</span><span class="n">secrets</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;potato&#39;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">heartbeat</span><span class="p">(</span><span class="s2">&quot;bird&quot;</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">memory</span><span class="o">=</span><span class="n">secrets</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;bird&#39;
</pre></div>
</div>
</div>
</div>
<p>However, if the length is greater than the length of the reply string, additional contents of memory spill out.  Note that all of this still occurs within regular array bounds, so an address sanitizer would not be triggered:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">heartbeat</span><span class="p">(</span><span class="s2">&quot;hat&quot;</span><span class="p">,</span> <span class="mi">500</span><span class="p">,</span> <span class="n">memory</span><span class="o">=</span><span class="n">secrets</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;hatace for reply&gt;#,,!3?30&gt;#61)$4--8=&lt;7)4 )03/%,5+! &quot;4)0?.9+?3();&lt;42?=?0&lt;secret-certificate&gt;7(+/+((1)#/0\&#39;4!&gt;/&lt;#=78%6$!!$&lt;-&quot;3&quot;\&#39;-?1?85!05629%/); *)1\&#39;/=9%&lt;secret-key&gt;.(#.4%&lt;other-secrets&gt;deadbeefdeadbeefdeadbeefdeadbeefdeadbeefdeadbeefdeadbeefdeadbeefdeadbeefdeadbeefdeadbeefdeadbeefdeadbeefdeadbeefdeadbeefdeadbeefdeadbeefdeadbeefdeadbeefdeadbeefdeadbeefdeadbeefdeadbeefdeadbeefdeadbeefdeadbeefdeadbeefdeadbeefdeadbeefdeadbeefdeadbeefdeadbeefdeadbeefdeadbeefdeadbeefdeadbeefdeadbeefdeadbeefdeadbeefdeadb&#39;
</pre></div>
</div>
</div>
</div>
<p>How can one detect such issues?  The idea is to identify information that should not leak out, such as the given secrets, but also uninitialized memory.  We can simulate such a check in a small Python example:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">ExpectError</span><span class="w"> </span><span class="kn">import</span> <span class="n">ExpectError</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">ExpectError</span><span class="p">():</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
        <span class="n">s</span> <span class="o">=</span> <span class="n">heartbeat</span><span class="p">(</span><span class="n">fuzzer</span><span class="p">(),</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">500</span><span class="p">),</span> <span class="n">memory</span><span class="o">=</span><span class="n">secrets</span><span class="p">)</span>
        <span class="k">assert</span> <span class="ow">not</span> <span class="n">s</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">uninitialized_memory_marker</span><span class="p">)</span>
        <span class="k">assert</span> <span class="ow">not</span> <span class="n">s</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;secret&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Traceback (most recent call last):
  File &quot;/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_63064/4040656327.py&quot;, line 4, in &lt;module&gt;
    assert not s.find(uninitialized_memory_marker)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError (expected)
</pre></div>
</div>
</div>
</div>
<p>With such a check, we find that secrets and/or uninitialized memory indeed leak out.  In the <a class="reference internal" href="InformationFlow.html"><span class="std std-doc">chapter on information flow</span></a>, we will discuss how to do this automatically, “tainting” sensitive information and values derived from them, and ensuring that “tainted” values do not leak out.</p>
<p>As a rule of thumb, you should always <em>enable as many automatic checkers as possible</em> during fuzzing.  CPU cycles are cheap, and errors are expensive.  If you only execute the program without an option to actually detect errors, you will be missing several opportunities.</p>
</section>
</section>
<section id="program-specific-checkers">
<h3>Program-Specific Checkers<a class="headerlink" href="#program-specific-checkers" title="Link to this heading">#</a></h3>
<p>Besides generic checkers that apply to <em>all</em> programs on a given platform or in a given language, you can also devise <em>specific</em> checkers that apply to your program, or a subsystem.  In the <a class="reference internal" href="Intro_Testing.html"><span class="std std-doc">chapter on testing</span></a>, we already have hinted at techniques of <a class="reference internal" href="Intro_Testing.html#Runtime-Verification"><span class="std std-ref">runtime verification</span></a> that check function results at runtime for correctness.</p>
<p>One key idea for detecting errors early is the concept of <em>assertion</em> – a predicate that checks the input (precondition) and the result (postcondition) of important functions.  The more assertions you have in your program, the higher your chances to detect errors during execution that would go undetected by generic checkers – notably during fuzzing.  If you worry about the impact of assertions on performance, keep in mind that assertions can be turned off in production code (although it can be helpful to leave the most critical checks active).</p>
<p>One of the most important uses of assertions for finding errors is <em>checking the integrity of complex data structures.</em>  Let us illustrate the concept using a simple example.  Suppose we have a mapping of airport codes to airports, as in</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">airport_codes</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;YVR&quot;</span><span class="p">:</span> <span class="s2">&quot;Vancouver&quot;</span><span class="p">,</span>
    <span class="s2">&quot;JFK&quot;</span><span class="p">:</span> <span class="s2">&quot;New York-JFK&quot;</span><span class="p">,</span>
    <span class="s2">&quot;CDG&quot;</span><span class="p">:</span> <span class="s2">&quot;Paris-Charles de Gaulle&quot;</span><span class="p">,</span>
    <span class="s2">&quot;CAI&quot;</span><span class="p">:</span> <span class="s2">&quot;Cairo&quot;</span><span class="p">,</span>
    <span class="s2">&quot;LED&quot;</span><span class="p">:</span> <span class="s2">&quot;St. Petersburg&quot;</span><span class="p">,</span>
    <span class="s2">&quot;PEK&quot;</span><span class="p">:</span> <span class="s2">&quot;Beijing&quot;</span><span class="p">,</span>
    <span class="s2">&quot;HND&quot;</span><span class="p">:</span> <span class="s2">&quot;Tokyo-Haneda&quot;</span><span class="p">,</span>
    <span class="s2">&quot;AKL&quot;</span><span class="p">:</span> <span class="s2">&quot;Auckland&quot;</span>
<span class="p">}</span>  <span class="c1"># plus many more</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">airport_codes</span><span class="p">[</span><span class="s2">&quot;YVR&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;Vancouver&#39;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;AKL&quot;</span> <span class="ow">in</span> <span class="n">airport_codes</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True
</pre></div>
</div>
</div>
</div>
<p>This list of airport codes may be pretty critical: if we have a spelling mistake in any of the airport codes, this may impact whatever application we have.  We therefore introduce a function that checks the list for consistency.  The consistency condition is called a <em>representation invariant</em>, and functions (or methods) that check it are therefore typically named <code class="docutils literal notranslate"><span class="pre">repOK()</span></code> for “the representation is ok”.</p>
<p>First, let’s have a checker for individual airport codes.  The checker fails if the code is inconsistent.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">code_repOK</span><span class="p">(</span><span class="n">code</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
    <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">code</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span><span class="p">,</span> <span class="s2">&quot;Airport code must have three characters: &quot;</span> <span class="o">+</span> <span class="nb">repr</span><span class="p">(</span><span class="n">code</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">code</span><span class="p">:</span>
        <span class="k">assert</span> <span class="n">c</span><span class="o">.</span><span class="n">isalpha</span><span class="p">(),</span> <span class="s2">&quot;Non-letter in airport code: &quot;</span> <span class="o">+</span> <span class="nb">repr</span><span class="p">(</span><span class="n">code</span><span class="p">)</span>
        <span class="k">assert</span> <span class="n">c</span><span class="o">.</span><span class="n">isupper</span><span class="p">(),</span> <span class="s2">&quot;Lowercase letter in airport code: &quot;</span> <span class="o">+</span> <span class="nb">repr</span><span class="p">(</span><span class="n">code</span><span class="p">)</span>
    <span class="k">return</span> <span class="kc">True</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">assert</span> <span class="n">code_repOK</span><span class="p">(</span><span class="s2">&quot;SEA&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>We can now use <code class="docutils literal notranslate"><span class="pre">code_repOK()</span></code> to check all elements in the list:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">airport_codes_repOK</span><span class="p">():</span>
    <span class="k">for</span> <span class="n">code</span> <span class="ow">in</span> <span class="n">airport_codes</span><span class="p">:</span>
        <span class="k">assert</span> <span class="n">code_repOK</span><span class="p">(</span><span class="n">code</span><span class="p">)</span>
    <span class="k">return</span> <span class="kc">True</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">ExpectError</span><span class="p">():</span>
    <span class="k">assert</span> <span class="n">airport_codes_repOK</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>If we add an invalid element to the list, our check would fail:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">airport_codes</span><span class="p">[</span><span class="s2">&quot;YMML&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Melbourne&quot;</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">ExpectError</span><span class="p">():</span>
    <span class="k">assert</span> <span class="n">airport_codes_repOK</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Traceback (most recent call last):
  File &quot;/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_63064/2308942452.py&quot;, line 2, in &lt;module&gt;
    assert airport_codes_repOK()
           ~~~~~~~~~~~~~~~~~~~^^
  File &quot;/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_63064/480627665.py&quot;, line 3, in airport_codes_repOK
    assert code_repOK(code)
           ~~~~~~~~~~^^^^^^
  File &quot;/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_63064/865020192.py&quot;, line 2, in code_repOK
    assert len(code) == 3, &quot;Airport code must have three characters: &quot; + repr(code)
           ^^^^^^^^^^^^^^
AssertionError: Airport code must have three characters: &#39;YMML&#39; (expected)
</pre></div>
</div>
</div>
</div>
<p>Of course, rather than manipulating the list directly, we’d have a special function for adding elements; this could then also check whether the code is valid:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">add_new_airport</span><span class="p">(</span><span class="n">code</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">city</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="k">assert</span> <span class="n">code_repOK</span><span class="p">(</span><span class="n">code</span><span class="p">)</span>
    <span class="n">airport_codes</span><span class="p">[</span><span class="n">code</span><span class="p">]</span> <span class="o">=</span> <span class="n">city</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">ExpectError</span><span class="p">():</span>  <span class="c1"># For BER, ExpectTimeout would be more appropriate</span>
    <span class="n">add_new_airport</span><span class="p">(</span><span class="s2">&quot;BER&quot;</span><span class="p">,</span> <span class="s2">&quot;Berlin&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>This check also allows us to find out errors in argument lists:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">ExpectError</span><span class="p">():</span>
    <span class="n">add_new_airport</span><span class="p">(</span><span class="s2">&quot;London-Heathrow&quot;</span><span class="p">,</span> <span class="s2">&quot;LHR&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Traceback (most recent call last):
  File &quot;/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_63064/1427835309.py&quot;, line 2, in &lt;module&gt;
    add_new_airport(&quot;London-Heathrow&quot;, &quot;LHR&quot;)
    ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File &quot;/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_63064/2655039924.py&quot;, line 2, in add_new_airport
    assert code_repOK(code)
           ~~~~~~~~~~^^^^^^
  File &quot;/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_63064/865020192.py&quot;, line 2, in code_repOK
    assert len(code) == 3, &quot;Airport code must have three characters: &quot; + repr(code)
           ^^^^^^^^^^^^^^
AssertionError: Airport code must have three characters: &#39;London-Heathrow&#39; (expected)
</pre></div>
</div>
</div>
</div>
<p>For maximum checking, though, the <code class="docutils literal notranslate"><span class="pre">add_new_airport()</span></code> function would also ensure the correct representation of the list of airport codes – <em>before</em> and <em>after</em> changing it.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">add_new_airport_2</span><span class="p">(</span><span class="n">code</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">city</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="k">assert</span> <span class="n">code_repOK</span><span class="p">(</span><span class="n">code</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">airport_codes_repOK</span><span class="p">()</span>
    <span class="n">airport_codes</span><span class="p">[</span><span class="n">code</span><span class="p">]</span> <span class="o">=</span> <span class="n">city</span>
    <span class="k">assert</span> <span class="n">airport_codes_repOK</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>This catches the inconsistency introduced earlier:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">ExpectError</span><span class="p">():</span>
    <span class="n">add_new_airport_2</span><span class="p">(</span><span class="s2">&quot;IST&quot;</span><span class="p">,</span> <span class="s2">&quot;Istanbul Yeni Havalimanı&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Traceback (most recent call last):
  File &quot;/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_63064/1096579022.py&quot;, line 2, in &lt;module&gt;
    add_new_airport_2(&quot;IST&quot;, &quot;Istanbul Yeni Havalimanı&quot;)
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File &quot;/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_63064/2099116665.py&quot;, line 3, in add_new_airport_2
    assert airport_codes_repOK()
           ~~~~~~~~~~~~~~~~~~~^^
  File &quot;/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_63064/480627665.py&quot;, line 3, in airport_codes_repOK
    assert code_repOK(code)
           ~~~~~~~~~~^^^^^^
  File &quot;/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_63064/865020192.py&quot;, line 2, in code_repOK
    assert len(code) == 3, &quot;Airport code must have three characters: &quot; + repr(code)
           ^^^^^^^^^^^^^^
AssertionError: Airport code must have three characters: &#39;YMML&#39; (expected)
</pre></div>
</div>
</div>
</div>
<p>The more <code class="docutils literal notranslate"><span class="pre">repOK()</span></code> assertions exist in your code, the more errors you will catch – even those specific to only your domain and problem.  On top, such assertions document the <em>assumptions you made</em> during programming and thus help other programmers to understand your code and prevent errors.</p>
<p>As a final example, let us consider a rather complex data structure – a <a class="reference external" href="https://en.wikipedia.org/wiki/Red-black_tree">red-black tree</a>, a self-balancing binary search tree.  Implementing a red-black tree is not too hard, but getting it correct can be a task of several hours even for experienced programmers.  A <code class="docutils literal notranslate"><span class="pre">repOK()</span></code> method, however, documents all the assumptions and checks them as well:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">RedBlackTree</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">repOK</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">rootHasNoParent</span><span class="p">()</span>
        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">rootIsBlack</span><span class="p">()</span>
        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">rootNodesHaveOnlyBlackChildren</span><span class="p">()</span>
        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">treeIsAcyclic</span><span class="p">()</span>
        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">parentsAreConsistent</span><span class="p">()</span>
        <span class="k">return</span> <span class="kc">True</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">rootIsBlack</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">color</span> <span class="o">==</span> <span class="n">BLACK</span>
        <span class="k">return</span> <span class="kc">True</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">add_element</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">elem</span><span class="p">):</span>
        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">repOK</span><span class="p">()</span>
        <span class="o">...</span>  <span class="c1"># Add the element</span>
        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">repOK</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">delete_element</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">elem</span><span class="p">):</span>
        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">repOK</span><span class="p">()</span>
        <span class="o">...</span>  <span class="c1"># Delete the element</span>
        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">repOK</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>Here, <code class="docutils literal notranslate"><span class="pre">repOK()</span></code> is a method that runs on an object of the <code class="docutils literal notranslate"><span class="pre">RedBlackTree</span></code> class.  It runs five different checks, all of which have their own assertions.  Whenever an element is added or deleted, all these consistency checks are run automatically.  If you have an error in any of these, the checkers will find them – if you run the tree through sufficiently many fuzzed inputs, of course.</p>
</section>
<section id="static-code-checkers">
<h3>Static Code Checkers<a class="headerlink" href="#static-code-checkers" title="Link to this heading">#</a></h3>
<p>Many of the benefits from <code class="docutils literal notranslate"><span class="pre">repOK()</span></code> assertions can also be obtained by using <em>static type checkers</em> on your code.  In Python, for instance, the <a class="reference external" href="http://mypy-lang.org">MyPy</a> static checker can find type errors as soon as types of arguments are properly declared:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">typed_airport_codes</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;YVR&quot;</span><span class="p">:</span> <span class="s2">&quot;Vancouver&quot;</span><span class="p">,</span>  <span class="c1"># etc</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<p>If we now add a key with a non-string type, as in</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">typed_airport_codes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;First&quot;</span>  <span class="c1"># type: ignore</span>
</pre></div>
</div>
</div>
</div>
<p>this would be caught by MyPy immediately:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>mypy<span class="w"> </span>airports.py
airports.py:<span class="w"> </span>error:<span class="w"> </span>Invalid<span class="w"> </span>index<span class="w"> </span><span class="nb">type</span><span class="w"> </span><span class="s2">&quot;int&quot;</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="s2">&quot;Dict[str, str]&quot;</span><span class="p">;</span><span class="w"> </span>expected<span class="w"> </span><span class="nb">type</span><span class="w"> </span><span class="s2">&quot;str&quot;</span>
</pre></div>
</div>
<p>Statically checking more advanced properties such as the airport code consisting of exactly three uppercase characters or a tree being acyclic, however, quickly reach the limits of static checking.  Your <code class="docutils literal notranslate"><span class="pre">repOK()</span></code> assertions will still be needed – best in conjunction with a good test generator.</p>
</section>
</section>
<section id="a-fuzzing-architecture">
<h2>A Fuzzing Architecture<a class="headerlink" href="#a-fuzzing-architecture" title="Link to this heading">#</a></h2>
<p>Since we’d like to reuse some parts of this chapter in the following ones, let us define things in a way that are easier to reuse, and in particular easier to <em>extend</em>.  To this end, we introduce a number of <em>classes</em> that encapsulate the functionality above in a reusable way.</p>
<section id="runner-classes">
<h3>Runner Classes<a class="headerlink" href="#runner-classes" title="Link to this heading">#</a></h3>
<p>The first thing we introduce is the notion of a <code class="docutils literal notranslate"><span class="pre">Runner</span></code> – that is, an object whose job it is to execute some object with a given input.  A runner typically is some program or function under test, but we can also have simpler runners.</p>
<p>Let us start with a base class for runners.  A runner essentially provides a method <code class="docutils literal notranslate"><span class="pre">run(input)</span></code> that is used to pass <code class="docutils literal notranslate"><span class="pre">input</span></code> (a string) to the runner.  <code class="docutils literal notranslate"><span class="pre">run()</span></code> returns a pair (<code class="docutils literal notranslate"><span class="pre">result</span></code>, <code class="docutils literal notranslate"><span class="pre">outcome</span></code>).  Here, <code class="docutils literal notranslate"><span class="pre">result</span></code> is a runner-specific value that gives details on the run; <code class="docutils literal notranslate"><span class="pre">outcome</span></code> is a value that classifies the result in three categories:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">Runner.PASS</span></code> – the test <em>passed</em>.  The run produced correct results.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Runner.FAIL</span></code> – the test <em>failed</em>.  The run produced incorrect results.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Runner.UNRESOLVED</span></code> – the test neither passed nor failed.  This happens if the run could not take place – for instance, because the input was invalid.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Outcome</span> <span class="o">=</span> <span class="nb">str</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">Runner</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Base class for testing inputs.&quot;&quot;&quot;</span>

    <span class="c1"># Test outcomes</span>
    <span class="n">PASS</span> <span class="o">=</span> <span class="s2">&quot;PASS&quot;</span>
    <span class="n">FAIL</span> <span class="o">=</span> <span class="s2">&quot;FAIL&quot;</span>
    <span class="n">UNRESOLVED</span> <span class="o">=</span> <span class="s2">&quot;UNRESOLVED&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize&quot;&quot;&quot;</span>
        <span class="k">pass</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inp</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Run the runner with the given input&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">inp</span><span class="p">,</span> <span class="n">Runner</span><span class="o">.</span><span class="n">UNRESOLVED</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>As a base class, <code class="docutils literal notranslate"><span class="pre">Runner</span></code> merely provides an interface for more complex runners that build on it.  More specifically, we introduce <em>subclasses</em> that <em>inherit</em> the methods from their superclass in order to add additional methods or to override inherited methods.</p>
<p>Here is one example of such a subclass: <code class="docutils literal notranslate"><span class="pre">PrintRunner</span></code> simply prints out everything that is given to it, overriding the inherited <code class="docutils literal notranslate"><span class="pre">run()</span></code> method.  This is the default runner in many situations.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">PrintRunner</span><span class="p">(</span><span class="n">Runner</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Simple runner, printing the input.&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inp</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Print the given input&quot;&quot;&quot;</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">inp</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">inp</span><span class="p">,</span> <span class="n">Runner</span><span class="o">.</span><span class="n">UNRESOLVED</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p</span> <span class="o">=</span> <span class="n">PrintRunner</span><span class="p">()</span>
<span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">outcome</span><span class="p">)</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="s2">&quot;Some input&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Some input
</pre></div>
</div>
</div>
</div>
<p>The result is just the string we passed as input:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">result</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;Some input&#39;
</pre></div>
</div>
</div>
</div>
<p>Still, at this point, we have no way to classify program behavior:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">outcome</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;UNRESOLVED&#39;
</pre></div>
</div>
</div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">ProgramRunner</span></code> class sends the input to the standard input of a program instead.  The program is specified when creating a <code class="docutils literal notranslate"><span class="pre">ProgramRunner</span></code> object.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">ProgramRunner</span><span class="p">(</span><span class="n">Runner</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Test a program with inputs.&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">program</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize.</span>
<span class="sd">           `program` is a program spec as passed to `subprocess.run()`&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">program</span> <span class="o">=</span> <span class="n">program</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">run_process</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inp</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">CompletedProcess</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Run the program with `inp` as input.</span>
<span class="sd">           Return result of `subprocess.run()`.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">program</span><span class="p">,</span>
                              <span class="nb">input</span><span class="o">=</span><span class="n">inp</span><span class="p">,</span>
                              <span class="n">stdout</span><span class="o">=</span><span class="n">subprocess</span><span class="o">.</span><span class="n">PIPE</span><span class="p">,</span>
                              <span class="n">stderr</span><span class="o">=</span><span class="n">subprocess</span><span class="o">.</span><span class="n">PIPE</span><span class="p">,</span>
                              <span class="n">universal_newlines</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inp</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">subprocess</span><span class="o">.</span><span class="n">CompletedProcess</span><span class="p">,</span> <span class="n">Outcome</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Run the program with `inp` as input.  </span>
<span class="sd">           Return test outcome based on result of `subprocess.run()`.&quot;&quot;&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">run_process</span><span class="p">(</span><span class="n">inp</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">result</span><span class="o">.</span><span class="n">returncode</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">outcome</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">PASS</span>
        <span class="k">elif</span> <span class="n">result</span><span class="o">.</span><span class="n">returncode</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">outcome</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">FAIL</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">outcome</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">UNRESOLVED</span>

        <span class="k">return</span> <span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">outcome</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Here’s a variant for binary (i.e., non-textual) input and output.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">BinaryProgramRunner</span><span class="p">(</span><span class="n">ProgramRunner</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">run_process</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inp</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">CompletedProcess</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Run the program with `inp` as input.  </span>
<span class="sd">           Return result of `subprocess.run()`.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">program</span><span class="p">,</span>
                              <span class="nb">input</span><span class="o">=</span><span class="n">inp</span><span class="o">.</span><span class="n">encode</span><span class="p">(),</span>
                              <span class="n">stdout</span><span class="o">=</span><span class="n">subprocess</span><span class="o">.</span><span class="n">PIPE</span><span class="p">,</span>
                              <span class="n">stderr</span><span class="o">=</span><span class="n">subprocess</span><span class="o">.</span><span class="n">PIPE</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Let us demonstrate a <code class="docutils literal notranslate"><span class="pre">ProgramRunner</span></code> using the <code class="docutils literal notranslate"><span class="pre">cat</span></code> program – a program that copies its input to its output.  We see that a standard invocation of <code class="docutils literal notranslate"><span class="pre">cat</span></code> simply does the job, with the output of <code class="docutils literal notranslate"><span class="pre">cat</span></code> being the same as its input:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cat</span> <span class="o">=</span> <span class="n">ProgramRunner</span><span class="p">(</span><span class="n">program</span><span class="o">=</span><span class="s2">&quot;cat&quot;</span><span class="p">)</span>
<span class="n">cat</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="s2">&quot;hello&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(CompletedProcess(args=&#39;cat&#39;, returncode=0, stdout=&#39;hello&#39;, stderr=&#39;&#39;), &#39;PASS&#39;)
</pre></div>
</div>
</div>
</div>
</section>
<section id="fuzzer-classes">
<h3>Fuzzer Classes<a class="headerlink" href="#fuzzer-classes" title="Link to this heading">#</a></h3>
<p>Let us now define a <em>fuzzer</em> that actually feed data into a consumer.  The base class for fuzzers provides one central method <code class="docutils literal notranslate"><span class="pre">fuzz()</span></code> that creates some input.  The <code class="docutils literal notranslate"><span class="pre">run()</span></code> function then sends the fuzz() input to a runner, returning the outcome; <code class="docutils literal notranslate"><span class="pre">runs()</span></code> does this for a given number (<code class="docutils literal notranslate"><span class="pre">trials</span></code>) of times.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">Fuzzer</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Base class for fuzzers.&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Constructor&quot;&quot;&quot;</span>
        <span class="k">pass</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">fuzz</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return fuzz input&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="s2">&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">runner</span><span class="p">:</span> <span class="n">Runner</span> <span class="o">=</span> <span class="n">Runner</span><span class="p">())</span> \
            <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">subprocess</span><span class="o">.</span><span class="n">CompletedProcess</span><span class="p">,</span> <span class="n">Outcome</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Run `runner` with fuzz input&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">runner</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fuzz</span><span class="p">())</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">runs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">runner</span><span class="p">:</span> <span class="n">Runner</span> <span class="o">=</span> <span class="n">PrintRunner</span><span class="p">(),</span> <span class="n">trials</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span><span class="p">)</span> \
            <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="n">subprocess</span><span class="o">.</span><span class="n">CompletedProcess</span><span class="p">,</span> <span class="n">Outcome</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Run `runner` with fuzz input, `trials` times&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">runner</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">trials</span><span class="p">)]</span>
</pre></div>
</div>
</div>
</div>
<p>By default, <code class="docutils literal notranslate"><span class="pre">Fuzzer</span></code> objects do not do much, as their <code class="docutils literal notranslate"><span class="pre">fuzz()</span></code> function is merely an abstract placeholder.  The subclass <code class="docutils literal notranslate"><span class="pre">RandomFuzzer</span></code>, however, implements the functionality of the <code class="docutils literal notranslate"><span class="pre">fuzzer()</span></code> function, above, adding a parameter <code class="docutils literal notranslate"><span class="pre">min_length</span></code> to specify a minimum length.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">RandomFuzzer</span><span class="p">(</span><span class="n">Fuzzer</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Produce random inputs.&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">min_length</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> <span class="n">max_length</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span>
                 <span class="n">char_start</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">32</span><span class="p">,</span> <span class="n">char_range</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">32</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Produce strings of `min_length` to `max_length` characters</span>
<span class="sd">           in the range [`char_start`, `char_start` + `char_range`)&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">min_length</span> <span class="o">=</span> <span class="n">min_length</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">max_length</span> <span class="o">=</span> <span class="n">max_length</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">char_start</span> <span class="o">=</span> <span class="n">char_start</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">char_range</span> <span class="o">=</span> <span class="n">char_range</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">fuzz</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="n">string_length</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randrange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">min_length</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_length</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">out</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">string_length</span><span class="p">):</span>
            <span class="n">out</span> <span class="o">+=</span> <span class="nb">chr</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">randrange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">char_start</span><span class="p">,</span>
                                        <span class="bp">self</span><span class="o">.</span><span class="n">char_start</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">char_range</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">out</span>
</pre></div>
</div>
</div>
</div>
<p>With <code class="docutils literal notranslate"><span class="pre">RandomFuzzer</span></code>, we can now create a fuzzer whose configuration needs to be specified only once when creating the fuzzer.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">random_fuzzer</span> <span class="o">=</span> <span class="n">RandomFuzzer</span><span class="p">(</span><span class="n">min_length</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">max_length</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">random_fuzzer</span><span class="o">.</span><span class="n">fuzz</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;&gt;23&gt;33)(&amp;&quot;09.377.*3
*+:5 ? (?1$4&lt;&gt;!?3&gt;.&#39;
4+3/(3 (0%!&gt;!(+9%,#$
/51$2964&gt;;)2417&lt;9&quot;2&amp;
907.. !7:&amp;--&quot;=$7&#39;,7*
(5=5&#39;.!*+&amp;&gt;&quot;)6%9)=,/
?:&amp;5) &quot;;.0!=6&gt;3+&gt;)=,
6&amp;,?:!#2))- ?:)=63&#39;-
,)9#839%)?&amp;(0&lt;6(&quot;*;)
4?!(49+8=-&#39;&amp;499%?&lt; &#39;
</pre></div>
</div>
</div>
</div>
<p>We can now send such generated inputs to our previously defined <code class="docutils literal notranslate"><span class="pre">cat</span></code> runner, verifying that <code class="docutils literal notranslate"><span class="pre">cat</span></code> actually does copy its (fuzzed) input to its output.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
    <span class="n">inp</span> <span class="o">=</span> <span class="n">random_fuzzer</span><span class="o">.</span><span class="n">fuzz</span><span class="p">()</span>
    <span class="n">result</span><span class="p">,</span> <span class="n">outcome</span> <span class="o">=</span> <span class="n">cat</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">inp</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">result</span><span class="o">.</span><span class="n">stdout</span> <span class="o">==</span> <span class="n">inp</span>
    <span class="k">assert</span> <span class="n">outcome</span> <span class="o">==</span> <span class="n">Runner</span><span class="o">.</span><span class="n">PASS</span>
</pre></div>
</div>
</div>
</div>
<p>Combining a <code class="docutils literal notranslate"><span class="pre">Fuzzer</span></code> with a <code class="docutils literal notranslate"><span class="pre">Runner</span></code>, however, is so common that we can use the <code class="docutils literal notranslate"><span class="pre">run()</span></code> method supplied by the <code class="docutils literal notranslate"><span class="pre">Fuzzer</span></code> class for this purpose:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">random_fuzzer</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">cat</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(CompletedProcess(args=&#39;cat&#39;, returncode=0, stdout=&#39;?:+= % &lt;1&lt;6$:(&gt;=:9)5&#39;, stderr=&#39;&#39;),
 &#39;PASS&#39;)
</pre></div>
</div>
</div>
</div>
<p>With <code class="docutils literal notranslate"><span class="pre">runs()</span></code>, we can repeat a fuzzing run a number of times, obtaining a list of results.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">random_fuzzer</span><span class="o">.</span><span class="n">runs</span><span class="p">(</span><span class="n">cat</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[(CompletedProcess(args=&#39;cat&#39;, returncode=0, stdout=&#39;3976%%&amp;+%6=(1)3&amp;3:&lt;9&#39;, stderr=&#39;&#39;),
  &#39;PASS&#39;),
 (CompletedProcess(args=&#39;cat&#39;, returncode=0, stdout=&#39;33$#42$ 11=*%$20=&lt;.-&#39;, stderr=&#39;&#39;),
  &#39;PASS&#39;),
 (CompletedProcess(args=&#39;cat&#39;, returncode=0, stdout=&#39;&quot;?&lt;\&#39;#8 &lt;/:*%9.--\&#39;97!&#39;, stderr=&#39;&#39;),
  &#39;PASS&#39;),
 (CompletedProcess(args=&#39;cat&#39;, returncode=0, stdout=&quot;/0-#(03/!#60&#39;+6&gt;&amp;&amp;72&quot;, stderr=&#39;&#39;),
  &#39;PASS&#39;),
 (CompletedProcess(args=&#39;cat&#39;, returncode=0, stdout=&quot;=,+:,6&#39;5:950+&gt;&lt;3(*()&quot;, stderr=&#39;&#39;),
  &#39;PASS&#39;),
 (CompletedProcess(args=&#39;cat&#39;, returncode=0, stdout=&quot; 379+0?&#39;%3137=2:4605&quot;, stderr=&#39;&#39;),
  &#39;PASS&#39;),
 (CompletedProcess(args=&#39;cat&#39;, returncode=0, stdout=&quot;02&gt;!$&lt;/&#39;*81.#&lt;/22&gt;+:&quot;, stderr=&#39;&#39;),
  &#39;PASS&#39;),
 (CompletedProcess(args=&#39;cat&#39;, returncode=0, stdout=&quot;=-&lt;&#39;3-#88*%&amp;*9&lt; +1&amp;&amp;&quot;, stderr=&#39;&#39;),
  &#39;PASS&#39;),
 (CompletedProcess(args=&#39;cat&#39;, returncode=0, stdout=&#39;2;;0=3&amp;6=8&amp;30&amp;&lt;-;?*;&#39;, stderr=&#39;&#39;),
  &#39;PASS&#39;),
 (CompletedProcess(args=&#39;cat&#39;, returncode=0, stdout=&#39;/#05=*3($&gt;::#7!0=12+&#39;, stderr=&#39;&#39;),
  &#39;PASS&#39;)]
</pre></div>
</div>
</div>
</div>
<p>With this, we have all in place to create fuzzers – starting with the simple random fuzzers introduced in this chapter, but even far more advanced ones.  Stay tuned!</p>
</section>
</section>
<section id="lessons-learned">
<h2>Lessons Learned<a class="headerlink" href="#lessons-learned" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Randomly generating inputs (“fuzzing”) is a simple, cost-effective way to quickly test arbitrary programs for their robustness.</p></li>
<li><p>Bugs fuzzers find are mainly due to errors and deficiencies in <em>input processing</em>.</p></li>
<li><p>To catch errors, have as many <em>consistency checkers</em> as possible.</p></li>
</ul>
<p>We’re done, so don’t forget to clean up:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">FILE</span><span class="p">)</span>
<span class="n">os</span><span class="o">.</span><span class="n">removedirs</span><span class="p">(</span><span class="n">tempdir</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="next-steps">
<h2>Next Steps<a class="headerlink" href="#next-steps" title="Link to this heading">#</a></h2>
<p>From here, you can explore how to</p>
<ul class="simple">
<li><p><a class="reference internal" href="MutationFuzzer.html"><span class="std std-doc">use <em>mutations</em> on existing inputs to get more valid inputs</span></a></p></li>
<li><p><a class="reference internal" href="Grammars.html"><span class="std std-doc">use <em>grammars</em> to specify the input format and thus get many more valid inputs</span></a></p></li>
<li><p><a class="reference internal" href="Reducer.html"><span class="std std-doc">reduce <em>failing inputs</em> for efficient debugging</span></a></p></li>
</ul>
<p>Enjoy the read!</p>
</section>
<section id="background">
<h2>Background<a class="headerlink" href="#background" title="Link to this heading">#</a></h2>
<p>Books on generating software tests in general are scarce (which is why we wrote this book).  There are a few notable books on <em>fuzzing,</em> though, also based on the basic fuzzing techniques introduced in this chapter:</p>
<ul class="simple">
<li><p>The book “Fuzzing – Brute Force Vulnerability Discovery”  covers a wide range of fuzzing domains, including files, Web pages, environment variables, and network protocols.  The authors bring in lots of experience from fuzzing at Microsoft, and include a number of ready-made tools for Windows and UNIX programs.  The tools have aged somewhat, but the principles remain.</p></li>
<li><p>The book “Fuzzing for Software Security Testing and Quality Assurance” \cite{Takanen2008}, now in its second edition 2018, covers a wide range of fuzzing tools and detection techniques; its authors bring in plenty of experience from security testing and vulnerability discovery.  This is arguably one of the most comprehensive and up-to-date books on the field.</p></li>
</ul>
<p>Specifically for this chapter, the seminal work on fuzzing, introducing both the term and the approach, is “An Empirical Study of the Reliability of UNIX Utilities” \cite{Miller1990}.  As the foundation for the field, this is a must-read for anyone interested in fuzzing and robustness testing, with observations as valid today as they were 30 years ago.</p>
</section>
<section id="exercises">
<h2>Exercises<a class="headerlink" href="#exercises" title="Link to this heading">#</a></h2>
<p>One of the errors found by Miller et al. \cite{Miller1990} involves the <em>troff</em> typesetting system.  <em>Troff</em> takes as input a text consisting of lines; a line beginning with a dot (<code class="docutils literal notranslate"><span class="pre">.</span></code>) includes typesetting commands, as in</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">.</span><span class="n">NH</span>
<span class="n">Some</span> <span class="n">Heading</span>
<span class="o">.</span><span class="n">LP</span>
<span class="n">Some</span> <span class="n">paragraph</span>
</pre></div>
</div>
<p>which would produce (using <code class="docutils literal notranslate"><span class="pre">nroff</span> <span class="pre">-ms</span></code>) the text</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mf">1.</span>  <span class="n">Some</span> <span class="n">Heading</span>

<span class="n">Some</span> <span class="n">paragraph</span>
</pre></div>
</div>
<p>At the time of Miller et al., <em>troff</em> would fail if its input included</p>
<ol class="arabic simple">
<li><p>The input sequence <code class="docutils literal notranslate"><span class="pre">\D</span></code> (backslash + D) followed by a non-printable character</p></li>
<li><p>A character in the ASCII range 128–255 (i.e., the 8th bit is set) followed by a newline character</p></li>
<li><p>A single dot (<code class="docutils literal notranslate"><span class="pre">.</span></code>) followed by a newline character.</p></li>
</ol>
<section id="exercise-1-simulate-troff">
<h3>Exercise 1: Simulate Troff<a class="headerlink" href="#exercise-1-simulate-troff" title="Link to this heading">#</a></h3>
<p>For each of the above, write a Python function <code class="docutils literal notranslate"><span class="pre">f(s)</span></code> that fails if <code class="docutils literal notranslate"><span class="pre">s</span></code> fulfills the failure criterion.</p>
<p><strong>Solution</strong>.  Here are three functions that check their input for <code class="docutils literal notranslate"><span class="pre">troff</span></code> bugs:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">string</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">no_backslash_d</span><span class="p">(</span><span class="n">inp</span><span class="p">):</span>
    <span class="n">pattern</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\\</span><span class="s2">D&quot;</span>
    <span class="n">index</span> <span class="o">=</span> <span class="n">inp</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">pattern</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">index</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">index</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">pattern</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="n">inp</span><span class="p">):</span>
        <span class="k">return</span> <span class="kc">True</span>
    <span class="n">c</span> <span class="o">=</span> <span class="n">inp</span><span class="p">[</span><span class="n">index</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">pattern</span><span class="p">)]</span>
    <span class="k">assert</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">string</span><span class="o">.</span><span class="n">printable</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">ExpectError</span><span class="p">():</span>
    <span class="n">no_backslash_d</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">D</span><span class="se">\0</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Traceback (most recent call last):
  File &quot;/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_63064/1873852117.py&quot;, line 2, in &lt;module&gt;
    no_backslash_d(&quot;\\D\0&quot;)
    ~~~~~~~~~~~~~~^^^^^^^^^
  File &quot;/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_63064/2739137185.py&quot;, line 7, in no_backslash_d
    assert c in string.printable
           ^^^^^^^^^^^^^^^^^^^^^
AssertionError (expected)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">no_8bit</span><span class="p">(</span><span class="n">inp</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">inp</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
        <span class="k">assert</span> <span class="nb">ord</span><span class="p">(</span><span class="n">inp</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">&lt;=</span> <span class="mi">127</span> <span class="ow">or</span> <span class="n">inp</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
    <span class="k">return</span> <span class="kc">True</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">ExpectError</span><span class="p">():</span>
    <span class="n">no_8bit</span><span class="p">(</span><span class="s2">&quot;ä</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Traceback (most recent call last):
  File &quot;/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_63064/3098727221.py&quot;, line 2, in &lt;module&gt;
    no_8bit(&quot;ä\n&quot;)
    ~~~~~~~^^^^^^^
  File &quot;/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_63064/986149540.py&quot;, line 3, in no_8bit
    assert ord(inp[i]) &lt;= 127 or inp[i + 1] != &#39;\n&#39;
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError (expected)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">no_dot</span><span class="p">(</span><span class="n">inp</span><span class="p">):</span>
    <span class="k">assert</span> <span class="n">inp</span> <span class="o">!=</span> <span class="s2">&quot;.</span><span class="se">\n</span><span class="s2">&quot;</span>
    <span class="k">return</span> <span class="kc">True</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="exercise-2-run-simulated-troff">
<h3>Exercise 2: Run Simulated Troff<a class="headerlink" href="#exercise-2-run-simulated-troff" title="Link to this heading">#</a></h3>
<p>Create a class <code class="docutils literal notranslate"><span class="pre">TroffRunner</span></code> as subclass of <code class="docutils literal notranslate"><span class="pre">Runner</span></code> that checks for the above predicates.  Run it with <code class="docutils literal notranslate"><span class="pre">Fuzzer</span></code>.  Be sure to have the <code class="docutils literal notranslate"><span class="pre">Fuzzer</span></code> object produce the entire range of characters.  Count how frequently the individual predicates fail.</p>
<p><strong>Solution.</strong> Here’s a simple example:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">TroffRunner</span><span class="p">(</span><span class="n">Runner</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">no_backslash_d_failures</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">no_8bit_failures</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">no_dot_failures</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inp</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">no_backslash_d</span><span class="p">(</span><span class="n">inp</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">AssertionError</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">no_backslash_d_failures</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">no_8bit</span><span class="p">(</span><span class="n">inp</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">AssertionError</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">no_8bit_failures</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">no_dot</span><span class="p">(</span><span class="n">inp</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">no_dot_failures</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="k">return</span> <span class="n">inp</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">random_fuzzer</span> <span class="o">=</span> <span class="n">RandomFuzzer</span><span class="p">(</span><span class="n">char_start</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">char_range</span><span class="o">=</span><span class="mi">256</span><span class="p">,</span> <span class="n">max_length</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">troff_runner</span> <span class="o">=</span> <span class="n">TroffRunner</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">trials</span> <span class="o">=</span> <span class="mi">100000</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">trials</span><span class="p">):</span>
    <span class="n">random_fuzzer</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">troff_runner</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">troff_runner</span><span class="o">.</span><span class="n">no_backslash_d_failures</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>5
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">troff_runner</span><span class="o">.</span><span class="n">no_8bit_failures</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1717
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">troff_runner</span><span class="o">.</span><span class="n">no_dot_failures</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline

<span class="n">ys</span> <span class="o">=</span> <span class="p">[</span><span class="n">troff_runner</span><span class="o">.</span><span class="n">no_backslash_d_failures</span><span class="p">,</span>
      <span class="n">troff_runner</span><span class="o">.</span><span class="n">no_8bit_failures</span><span class="p">,</span>
      <span class="n">troff_runner</span><span class="o">.</span><span class="n">no_dot_failures</span><span class="p">]</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">([</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">D&quot;</span><span class="p">,</span> <span class="s2">&quot;8bit&quot;</span><span class="p">,</span> <span class="s2">&quot;dot&quot;</span><span class="p">],</span> <span class="n">ys</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Occurrences of error classes&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/91e8f4a60357873abfebb4f1c597acfdc3bf8c64de443ba58da9feb45d0bd219.png" src="_images/91e8f4a60357873abfebb4f1c597acfdc3bf8c64de443ba58da9feb45d0bd219.png" />
</div>
</div>
<p>Again, we can see that some inputs (such as the single dot) are very improbable.</p>
</section>
<section id="exercise-3-run-real-troff">
<h3>Exercise 3: Run Real Troff<a class="headerlink" href="#exercise-3-run-real-troff" title="Link to this heading">#</a></h3>
<p>Using <code class="docutils literal notranslate"><span class="pre">BinaryProgramRunner</span></code>, apply the fuzzer you configured on the real <code class="docutils literal notranslate"><span class="pre">troff</span></code> program.  Check if you can produce any run whose output code is non-zero, indicating a failure or a crash.</p>
<p><strong>Solution.</strong> This is just a matter of putting pieces together.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">real_troff_runner</span> <span class="o">=</span> <span class="n">BinaryProgramRunner</span><span class="p">(</span><span class="s2">&quot;troff&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">):</span>
    <span class="n">result</span><span class="p">,</span> <span class="n">outcome</span> <span class="o">=</span> <span class="n">random_fuzzer</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">real_troff_runner</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">outcome</span> <span class="o">==</span> <span class="n">Runner</span><span class="o">.</span><span class="n">FAIL</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Unfortunately, it is very unlikely that you’ll find a bug in <code class="docutils literal notranslate"><span class="pre">troff</span></code> at this point.  Like most other open source code, it has been fuzzed this way before – and all errors found are already fixed.</p>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="Intro_Testing.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Introduction to Software Testing</p>
      </div>
    </a>
    <a class="right-next"
       href="Coverage.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Code Coverage</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#synopsis">Synopsis</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#fuzzers">Fuzzers</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#runners">Runners</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#a-testing-assignment">A Testing Assignment</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#a-simple-fuzzer">A Simple Fuzzer</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#fuzzing-external-programs">Fuzzing External Programs</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#creating-input-files">Creating Input Files</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#invoking-external-programs">Invoking External Programs</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#long-running-fuzzing">Long-Running Fuzzing</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#bugs-fuzzers-find">Bugs Fuzzers Find</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#buffer-overflows">Buffer Overflows</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#missing-error-checks">Missing Error Checks</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#rogue-numbers">Rogue Numbers</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#catching-errors">Catching Errors</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#generic-checkers">Generic Checkers</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#checking-memory-accesses">Checking Memory Accesses</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#information-leaks">Information Leaks</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#program-specific-checkers">Program-Specific Checkers</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#static-code-checkers">Static Code Checkers</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#a-fuzzing-architecture">A Fuzzing Architecture</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#runner-classes">Runner Classes</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#fuzzer-classes">Fuzzer Classes</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#lessons-learned">Lessons Learned</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#next-steps">Next Steps</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#background">Background</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercises">Exercises</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-1-simulate-troff">Exercise 1: Simulate Troff</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-2-run-simulated-troff">Exercise 2: Run Simulated Troff</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-3-run-real-troff">Exercise 3: Run Real Troff</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Andreas Zeller, Rahul Gopinath, Marcel Böhme, Gordon Fraser, and Christian Holler
</p>

  </div>
  
  <div class="footer-item">
    

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
<div class="extra_footer">
  <div>
  Copyright &copy; 2021–2025 <a href="https://www.cispa.de/">CISPA Helmholtz Center for Information Security</a>. Copyright &copy; 2018-2020 <a href="https://www.uni-saarland.de/">Saarland University</a>. Copyright &copy; 2018-2025 external contributors.
  The <strong>content</strong> of this project is licensed under the <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/">Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International License</a>.
  The <strong>source code</strong> that is part of the content, as well as the source code used to format and display that content is licensed under the <a href="https://github.com/uds-se/fuzzingbook/blob/master/LICENSE.md#mit-license">MIT License</a>.
  <br>
  <a href="https://cispa.de/en/impressum">Imprint</a> &middot; <a href="/html/index.html#how-do-i-cite-your-work">Cite</a>
</div>

</div>
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>